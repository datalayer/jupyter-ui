{"version":3,"file":"index-cVRT8K4q.js","sources":["../../../react/lib/jupyter/lite/kernel/kernel.js","../../../react/lib/jupyter/lite/pyodide-kernel/_pypi.js","../../../../node_modules/proxy-target/esm/types.js","../../../../node_modules/coincident/esm/channel.js","../../../../node_modules/proxy-target/esm/traps.js","../../../../node_modules/coincident/esm/bridge.js","../../../../node_modules/coincident/esm/index.js","../../../../node_modules/comlink/dist/esm/comlink.mjs","../../../react/lib/jupyter/lite/pyodide-kernel/kernel.js"],"sourcesContent":["/*\n * Copyright (c) 2021-2023 Datalayer, Inc.\n *\n * MIT License\n */\nimport { KernelMessage } from '@jupyterlab/services';\nimport { Signal } from '@lumino/signaling';\n/**\n * A base kernel class handling basic kernel messaging.\n */\nexport class BaseKernel {\n    /**\n     * Construct a new BaseKernel.\n     *\n     * @param options The instantiation options for a BaseKernel.\n     */\n    constructor(options) {\n        const { id, name, location, sendMessage } = options;\n        this._id = id;\n        this._name = name;\n        this._location = location;\n        this._sendMessage = sendMessage;\n    }\n    /**\n     * A promise that is fulfilled when the kernel is ready.\n     */\n    get ready() {\n        return Promise.resolve();\n    }\n    /**\n     * Return whether the kernel is disposed.\n     */\n    get isDisposed() {\n        return this._isDisposed;\n    }\n    /**\n     * A signal emitted when the kernel is disposed.\n     */\n    get disposed() {\n        return this._disposed;\n    }\n    /**\n     * Get the kernel id\n     */\n    get id() {\n        return this._id;\n    }\n    /**\n     * Get the name of the kernel\n     */\n    get name() {\n        return this._name;\n    }\n    /**\n     * The location in the virtual filesystem from which the kernel was started.\n     */\n    get location() {\n        return this._location;\n    }\n    /**\n     * The current execution count\n     */\n    get executionCount() {\n        return this._executionCount;\n    }\n    /**\n     * Get the last parent header\n     */\n    get parentHeader() {\n        return this._parentHeader;\n    }\n    /**\n     * Get the last parent message (mimic ipykernel's get_parent)\n     */\n    get parent() {\n        return this._parent;\n    }\n    /**\n     * Dispose the kernel.\n     */\n    dispose() {\n        if (this.isDisposed) {\n            return;\n        }\n        this._isDisposed = true;\n        this._disposed.emit(void 0);\n    }\n    /**\n     * Handle an incoming message from the client.\n     *\n     * @param msg The message to handle\n     */\n    async handleMessage(msg) {\n        this._busy(msg);\n        this._parent = msg;\n        const msgType = msg.header.msg_type;\n        switch (msgType) {\n            case 'kernel_info_request':\n                await this._kernelInfo(msg);\n                break;\n            case 'execute_request':\n                await this._execute(msg);\n                break;\n            case 'input_reply':\n                this.inputReply(msg.content);\n                break;\n            case 'inspect_request':\n                await this._inspect(msg);\n                break;\n            case 'is_complete_request':\n                await this._isCompleteRequest(msg);\n                break;\n            case 'complete_request':\n                await this._complete(msg);\n                break;\n            case 'history_request':\n                await this._historyRequest(msg);\n                break;\n            case 'comm_open':\n                await this.commOpen(msg);\n                break;\n            case 'comm_msg':\n                await this.commMsg(msg);\n                break;\n            case 'comm_close':\n                await this.commClose(msg);\n                break;\n            default:\n                break;\n        }\n        this._idle(msg);\n    }\n    /**\n     * Stream an event from the kernel\n     *\n     * @param parentHeader The parent header.\n     * @param content The stream content.\n     */\n    stream(content, parentHeader = undefined) {\n        const parentHeaderValue = typeof parentHeader !== 'undefined' ? parentHeader : this._parentHeader;\n        const message = KernelMessage.createMessage({\n            channel: 'iopub',\n            msgType: 'stream',\n            // TODO: better handle this\n            session: parentHeaderValue?.session ?? '',\n            parentHeader: parentHeaderValue,\n            content,\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Send a `display_data` message to the client.\n     *\n     * @param parentHeader The parent header.\n     * @param content The display_data content.\n     */\n    displayData(content, parentHeader = undefined) {\n        // Make sure metadata is always set\n        const parentHeaderValue = typeof parentHeader !== 'undefined' ? parentHeader : this._parentHeader;\n        content.metadata = content.metadata ?? {};\n        const message = KernelMessage.createMessage({\n            channel: 'iopub',\n            msgType: 'display_data',\n            // TODO: better handle this\n            session: parentHeaderValue?.session ?? '',\n            parentHeader: parentHeaderValue,\n            content,\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Send a `input_request` message to the client.\n     *\n     * @param parentHeader The parent header.\n     * @param content The input_request content.\n     */\n    inputRequest(content, parentHeader = undefined) {\n        const parentHeaderValue = typeof parentHeader !== 'undefined' ? parentHeader : this._parentHeader;\n        const message = KernelMessage.createMessage({\n            channel: 'stdin',\n            msgType: 'input_request',\n            // TODO: better handle this\n            session: parentHeaderValue?.session ?? '',\n            parentHeader: parentHeaderValue,\n            content,\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Send an `execute_result` message.\n     *\n     * @param parentHeader The parent header.\n     * @param content The execute result content.\n     */\n    publishExecuteResult(content, parentHeader = undefined) {\n        const parentHeaderValue = typeof parentHeader !== 'undefined' ? parentHeader : this._parentHeader;\n        const message = KernelMessage.createMessage({\n            channel: 'iopub',\n            msgType: 'execute_result',\n            // TODO: better handle this\n            session: parentHeaderValue?.session ?? '',\n            parentHeader: parentHeaderValue,\n            content,\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Send an `error` message to the client.\n     *\n     * @param parentHeader The parent header.\n     * @param content The error content.\n     */\n    publishExecuteError(content, parentHeader = undefined) {\n        const parentHeaderValue = typeof parentHeader !== 'undefined' ? parentHeader : this._parentHeader;\n        const message = KernelMessage.createMessage({\n            channel: 'iopub',\n            msgType: 'error',\n            // TODO: better handle this\n            session: parentHeaderValue?.session ?? '',\n            parentHeader: parentHeaderValue,\n            content,\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Send a `update_display_data` message to the client.\n     *\n     * @param parentHeader The parent header.\n     * @param content The update_display_data content.\n     */\n    updateDisplayData(content, parentHeader = undefined) {\n        const parentHeaderValue = typeof parentHeader !== 'undefined' ? parentHeader : this._parentHeader;\n        const message = KernelMessage.createMessage({\n            channel: 'iopub',\n            msgType: 'update_display_data',\n            // TODO: better handle this\n            session: parentHeaderValue?.session ?? '',\n            parentHeader: parentHeaderValue,\n            content,\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Send a `clear_output` message to the client.\n     *\n     * @param parentHeader The parent header.\n     * @param content The clear_output content.\n     */\n    clearOutput(content, parentHeader = undefined) {\n        const parentHeaderValue = typeof parentHeader !== 'undefined' ? parentHeader : this._parentHeader;\n        const message = KernelMessage.createMessage({\n            channel: 'iopub',\n            msgType: 'clear_output',\n            // TODO: better handle this\n            session: parentHeaderValue?.session ?? '',\n            parentHeader: parentHeaderValue,\n            content,\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Send a `comm` message to the client.\n     *\n     * @param .\n     */\n    handleComm(type, content, metadata, buffers, parentHeader = undefined) {\n        const parentHeaderValue = typeof parentHeader !== 'undefined' ? parentHeader : this._parentHeader;\n        const message = KernelMessage.createMessage({\n            channel: 'iopub',\n            msgType: type,\n            // TODO: better handle this\n            session: parentHeaderValue?.session ?? '',\n            parentHeader: parentHeaderValue,\n            content,\n            metadata,\n            buffers,\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Send an 'idle' status message.\n     *\n     * @param parent The parent message\n     */\n    _idle(parent) {\n        const message = KernelMessage.createMessage({\n            msgType: 'status',\n            session: parent.header.session,\n            parentHeader: parent.header,\n            channel: 'iopub',\n            content: {\n                execution_state: 'idle',\n            },\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Send a 'busy' status message.\n     *\n     * @param parent The parent message.\n     */\n    _busy(parent) {\n        const message = KernelMessage.createMessage({\n            msgType: 'status',\n            session: parent.header.session,\n            parentHeader: parent.header,\n            channel: 'iopub',\n            content: {\n                execution_state: 'busy',\n            },\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Handle a kernel_info_request message\n     *\n     * @param parent The parent message.\n     */\n    async _kernelInfo(parent) {\n        const content = await this.kernelInfoRequest();\n        const message = KernelMessage.createMessage({\n            msgType: 'kernel_info_reply',\n            channel: 'shell',\n            session: parent.header.session,\n            parentHeader: parent.header,\n            content,\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Handle a `history_request` message\n     *\n     * @param msg The parent message.\n     */\n    async _historyRequest(msg) {\n        const historyMsg = msg;\n        const message = KernelMessage.createMessage({\n            msgType: 'history_reply',\n            channel: 'shell',\n            parentHeader: historyMsg.header,\n            session: msg.header.session,\n            content: {\n                status: 'ok',\n                history: this._history,\n            },\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Send an `execute_input` message.\n     *\n     * @param msg The parent message.\n     */\n    _executeInput(msg) {\n        const parent = msg;\n        const code = parent.content.code;\n        const message = KernelMessage.createMessage({\n            msgType: 'execute_input',\n            parentHeader: parent.header,\n            channel: 'iopub',\n            session: msg.header.session,\n            content: {\n                code,\n                execution_count: this._executionCount,\n            },\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Handle an execute_request message.\n     *\n     * @param msg The parent message.\n     */\n    async _execute(msg) {\n        const executeMsg = msg;\n        const content = executeMsg.content;\n        if (content.store_history) {\n            this._executionCount++;\n        }\n        // TODO: handle differently\n        this._parentHeader = executeMsg.header;\n        this._executeInput(executeMsg);\n        if (content.store_history) {\n            this._history.push([0, 0, content.code]);\n        }\n        const reply = await this.executeRequest(executeMsg.content);\n        const message = KernelMessage.createMessage({\n            msgType: 'execute_reply',\n            channel: 'shell',\n            parentHeader: executeMsg.header,\n            session: msg.header.session,\n            content: reply,\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Handle an complete_request message\n     *\n     * @param msg The parent message.\n     */\n    async _complete(msg) {\n        const completeMsg = msg;\n        const content = await this.completeRequest(completeMsg.content);\n        const message = KernelMessage.createMessage({\n            msgType: 'complete_reply',\n            parentHeader: completeMsg.header,\n            channel: 'shell',\n            session: msg.header.session,\n            content,\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Handle an inspect_request message\n     *\n     * @param msg The parent message.\n     */\n    async _inspect(msg) {\n        const inspectMsg = msg;\n        const content = await this.inspectRequest(inspectMsg.content);\n        const message = KernelMessage.createMessage({\n            msgType: 'inspect_reply',\n            parentHeader: inspectMsg.header,\n            channel: 'shell',\n            session: msg.header.session,\n            content,\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Handle an is_complete_request message\n     *\n     * @param msg The parent message.\n     */\n    async _isCompleteRequest(msg) {\n        const isCompleteMsg = msg;\n        const content = await this.isCompleteRequest(isCompleteMsg.content);\n        const message = KernelMessage.createMessage({\n            msgType: 'is_complete_reply',\n            parentHeader: isCompleteMsg.header,\n            channel: 'shell',\n            session: msg.header.session,\n            content,\n        });\n        this._sendMessage(message);\n    }\n    _id;\n    _name;\n    _location;\n    _history = [];\n    _executionCount = 0;\n    _isDisposed = false;\n    _disposed = new Signal(this);\n    _sendMessage;\n    _parentHeader = undefined;\n    _parent = undefined;\n}\n//# sourceMappingURL=kernel.js.map","/*\n * Copyright (c) 2021-2023 Datalayer, Inc.\n *\n * MIT License\n */\n// Wheel URLs extracted from pypi/all.json\n// These are full HTTP URLs that micropip can fetch\n// Inlined to avoid webpack/bundler issues with JSON imports\n// The all.json content inlined as a TypeScript object\n// This should match the content of ./pypi/all.json\nconst allJson = {\n    ipykernel: {\n        releases: {\n            '6.9.2': [\n                {\n                    url: 'https://assets.datalayer.tech/pypi/ipykernel-6.9.2-py3-none-any.whl',\n                },\n            ],\n        },\n    },\n    piplite: {\n        releases: {\n            '0.5.1': [\n                {\n                    url: 'https://assets.datalayer.tech/pypi/piplite-0.5.1-py3-none-any.whl',\n                },\n            ],\n        },\n    },\n    'pyodide-kernel': {\n        releases: {\n            '0.5.1': [\n                {\n                    url: 'https://assets.datalayer.tech/pypi/pyodide_kernel-0.5.1-py3-none-any.whl',\n                },\n            ],\n        },\n    },\n    widgetsnbextension: {\n        releases: {\n            '3.6.999': [\n                {\n                    url: 'https://assets.datalayer.tech/pypi/widgetsnbextension-3.6.999-py3-none-any.whl',\n                },\n            ],\n            '4.0.999': [\n                {\n                    url: 'https://assets.datalayer.tech/pypi/widgetsnbextension-4.0.999-py3-none-any.whl',\n                },\n            ],\n        },\n    },\n};\n// Get the wheel URL for a package and version\nfunction getWheelUrl(packageName, version) {\n    const pkg = allJson[packageName];\n    if (!pkg) {\n        console.error('all.json contents:', allJson);\n        console.error('Looking for package:', packageName);\n        throw new Error(`Package ${packageName} not found in all.json`);\n    }\n    const versions = Object.keys(pkg.releases);\n    const targetVersion = version || versions[versions.length - 1];\n    const releases = pkg.releases[targetVersion];\n    if (!releases || releases.length === 0) {\n        throw new Error(`No releases found for ${packageName}@${targetVersion}`);\n    }\n    return releases[0].url;\n}\n// Export the all.json URL (from CDN for piplite to fetch package index)\nexport const allJSONUrl = {\n    default: allJson['piplite']?.releases['0.5.1']?.[0]?.url?.replace(/piplite-.*\\.whl$/, 'all.json') || 'https://assets.datalayer.tech/pypi/all.json',\n};\n// Export wheel URLs - read directly from imported JSON\nexport const pipliteWheelUrl = {\n    default: getWheelUrl('piplite', '0.5.1'),\n};\nexport const ipykernelWheelUrl = {\n    default: getWheelUrl('ipykernel', '6.9.2'),\n};\nexport const pyodide_kernelWheelUrl = {\n    default: getWheelUrl('pyodide-kernel', '0.5.1'),\n};\nexport const widgetsnbextensionWheelUrl = {\n    default: getWheelUrl('widgetsnbextension', '3.6.999'),\n};\nexport const widgetsnbextensionWheelUrl1 = {\n    default: getWheelUrl('widgetsnbextension', '4.0.999'),\n};\n//# sourceMappingURL=_pypi.js.map","export const ARRAY     = 'array';\nexport const BIGINT    = 'bigint';\nexport const BOOLEAN   = 'boolean';\nexport const FUNCTION  = 'function';\nexport const NULL      = 'null';\nexport const NUMBER    = 'number';\nexport const OBJECT    = 'object';\nexport const STRING    = 'string';\nexport const SYMBOL    = 'symbol';\nexport const UNDEFINED = 'undefined';\n","// âš ï¸ AUTOMATICALLY GENERATED - DO NOT CHANGE\nexport const CHANNEL = '64e10b34-2bf7-4616-9668-f99de5aa046e';\n\nexport const MAIN = 'M' + CHANNEL;\nexport const THREAD = 'T' + CHANNEL;\n","export const APPLY                        = 'apply';\nexport const CONSTRUCT                    = 'construct';\nexport const DEFINE_PROPERTY              = 'defineProperty';\nexport const DELETE_PROPERTY              = 'deleteProperty';\nexport const GET                          = 'get';\nexport const GET_OWN_PROPERTY_DESCRIPTOR  = 'getOwnPropertyDescriptor';\nexport const GET_PROTOTYPE_OF             = 'getPrototypeOf';\nexport const HAS                          = 'has';\nexport const IS_EXTENSIBLE                = 'isExtensible';\nexport const OWN_KEYS                     = 'ownKeys';\nexport const PREVENT_EXTENSION            = 'preventExtensions';\nexport const SET                          = 'set';\nexport const SET_PROTOTYPE_OF             = 'setPrototypeOf';\n","// The goal of this file is to normalize SAB\n// at least in main -> worker() use cases.\n// This still cannot possibly solve the sync\n// worker -> main() use case if SharedArrayBuffer\n// is not available or usable.\n\nimport {CHANNEL} from './channel.js';\n\nconst {isArray} = Array;\n\nlet {SharedArrayBuffer, window} = globalThis;\nlet {notify, wait, waitAsync} = Atomics;\nlet postPatched = null;\n\n// This is needed for some version of Firefox\nif (!waitAsync) {\n  waitAsync = buffer => ({\n    value: new Promise(onmessage => {\n      // encodeURIComponent('onmessage=({data:b})=>(Atomics.wait(b,0),postMessage(0))')\n      let w = new Worker('data:application/javascript,onmessage%3D(%7Bdata%3Ab%7D)%3D%3E(Atomics.wait(b%2C0)%2CpostMessage(0))');\n      w.onmessage = onmessage;\n      w.postMessage(buffer);\n    })\n  });\n}\n\n// Monkey-patch SharedArrayBuffer if needed\ntry {\n  new SharedArrayBuffer(4);\n}\ncatch (_) {\n  SharedArrayBuffer = ArrayBuffer;\n\n  const ids = new WeakMap;\n  // patch only main -> worker():async use case\n  if (window) {\n    const resolvers = new Map;\n    const {prototype: {postMessage}} = Worker;\n\n    const listener = event => {\n      const details = event.data?.[CHANNEL];\n      if (!isArray(details)) {\n        event.stopImmediatePropagation();\n        const { id, sb } = details;\n        resolvers.get(id)(sb);\n      }\n    };\n\n    postPatched = function (data, ...rest) {\n      const details = data?.[CHANNEL];\n      if (isArray(details)) {\n        const [id, sb] = details;\n        ids.set(sb, id);\n        this.addEventListener('message', listener);\n      }\n      return postMessage.call(this, data, ...rest);\n    };\n\n    waitAsync = sb => ({\n      value: new Promise(resolve => {\n        resolvers.set(ids.get(sb), resolve);\n      }).then(buff => {\n        resolvers.delete(ids.get(sb));\n        ids.delete(sb);\n        for (let i = 0; i < buff.length; i++) sb[i] = buff[i];\n        return 'ok';\n      })\n    });\n  }\n  else {\n    const as = (id, sb) => ({[CHANNEL]: { id, sb }});\n\n    notify = sb => {\n      postMessage(as(ids.get(sb), sb));\n    };\n\n    addEventListener('message', event => {\n      const details = event.data?.[CHANNEL];\n      if (isArray(details)) {\n        const [id, sb] = details;\n        ids.set(sb, id);\n      }\n    });\n  }\n}\n\nexport {SharedArrayBuffer, isArray, notify, postPatched, wait, waitAsync};\n","/*! (c) Andrea Giammarchi - ISC */\n\nimport {FUNCTION} from 'proxy-target/types';\n\nimport {CHANNEL} from './channel.js';\nimport {GET, HAS, SET} from './shared/traps.js';\n\nimport {SharedArrayBuffer, isArray, notify, postPatched, wait, waitAsync} from './bridge.js';\n\n// just minifier friendly for Blob Workers' cases\nconst {Int32Array, Map, Uint16Array} = globalThis;\n\n// common constants / utilities for repeated operations\nconst {BYTES_PER_ELEMENT: I32_BYTES} = Int32Array;\nconst {BYTES_PER_ELEMENT: UI16_BYTES} = Uint16Array;\n\nconst waitInterrupt = (sb, delay, handler) => {\n  while (wait(sb, 0, 0, delay) === 'timed-out')\n    handler();\n};\n\n// retain buffers to transfer\nconst buffers = new WeakSet;\n\n// retain either main threads or workers global context\nconst context = new WeakMap;\n\nconst syncResult = {value: {then: fn => fn()}};\n\n// used to generate a unique `id` per each worker `postMessage` \"transaction\"\nlet uid = 0;\n\n/**\n * @typedef {Object} Interrupt used to sanity-check interrupts while waiting synchronously.\n * @prop {function} [handler] a callback invoked every `delay` milliseconds.\n * @prop {number} [delay=42] define `handler` invokes in terms of milliseconds.\n */\n\n/**\n * Create once a `Proxy` able to orchestrate synchronous `postMessage` out of the box.\n * @param {globalThis | Worker} self the context in which code should run\n * @param {{parse: (serialized: string) => any, stringify: (serializable: any) => string, transform?: (value:any) => any, interrupt?: () => void | Interrupt}} [JSON] an optional `JSON` like interface to `parse` or `stringify` content with extra `transform` ability.\n * @returns {ProxyHandler<globalThis> | ProxyHandler<Worker>}\n */\nconst coincident = (self, {parse = JSON.parse, stringify = JSON.stringify, transform, interrupt} = JSON) => {\n  // create a Proxy once for the given context (globalThis or Worker instance)\n  if (!context.has(self)) {\n    // ensure no SAB gets a chance to pass through this call\n    const sendMessage = postPatched || self.postMessage;\n    // ensure the CHANNEL and data are posted correctly\n    const post = (transfer, ...args) => sendMessage.call(self, {[CHANNEL]: args}, {transfer});\n\n    const handler = typeof interrupt === FUNCTION ? interrupt : interrupt?.handler;\n    const delay = interrupt?.delay || 42;\n    const decoder = new TextDecoder('utf-16');\n\n    // automatically uses sync wait (worker -> main)\n    // or fallback to async wait (main -> worker)\n    const waitFor = (isAsync, sb) => isAsync ?\n      waitAsync(sb, 0) :\n      ((handler ? waitInterrupt(sb, delay, handler) : wait(sb, 0)), syncResult);\n\n    // prevent Harakiri https://github.com/WebReflection/coincident/issues/18\n    let seppuku = false;\n\n    context.set(self, new Proxy(new Map, {\n      // there is very little point in checking prop in proxy for this very specific case\n      // and I don't want to orchestrate a whole roundtrip neither, as stuff would fail\n      // regardless if from Worker we access non existent Main callback, and vice-versa.\n      // This is here mostly to guarantee that if such check is performed, at least the\n      // get trap goes through and then it's up to developers guarantee they are accessing\n      // stuff that actually exists elsewhere.\n      [HAS]: (_, action) => typeof action === 'string' && !action.startsWith('_'),\n\n      // worker related: get any utility that should be available on the main thread\n      [GET]: (_, action) => action === 'then' ? null : ((...args) => {\n        // transaction id\n        const id = uid++;\n\n        // first contact: just ask for how big the buffer should be\n        // the value would be stored at index [1] while [0] is just control\n        let sb = new Int32Array(new SharedArrayBuffer(I32_BYTES * 2));\n\n        // if a transfer list has been passed, drop it from args\n        let transfer = [];\n        if (buffers.has(args.at(-1) || transfer))\n          buffers.delete(transfer = args.pop());\n\n        // ask for invoke with arguments and wait for it\n        post(transfer, id, sb, action, transform ? args.map(transform) : args);\n\n        // helps deciding how to wait for results\n        const isAsync = self !== globalThis;\n\n        // warn users about possible deadlock still allowing them\n        // to explicitly `proxy.invoke().then(...)` without blocking\n        let deadlock = 0;\n        if (seppuku && isAsync)\n          deadlock = setTimeout(console.warn, 1000, `ðŸ’€ðŸ”’ - Possible deadlock if proxy.${action}(...args) is awaited`);\n\n        return waitFor(isAsync, sb).value.then(() => {\n          clearTimeout(deadlock);\n\n          // commit transaction using the returned / needed buffer length\n          const length = sb[1];\n\n          // filter undefined results\n          if (!length) return;\n\n          // calculate the needed ui16 bytes length to store the result string\n          const bytes = UI16_BYTES * length;\n\n          // round up to the next amount of bytes divided by 4 to allow i32 operations\n          sb = new Int32Array(new SharedArrayBuffer(bytes + (bytes % I32_BYTES)));\n\n          // ask for results and wait for it\n          post([], id, sb);\n          return waitFor(isAsync, sb).value.then(() => parse(\n            decoder.decode(new Uint16Array(sb.buffer).slice(0, length)))\n          );\n        });\n      }),\n\n      // main thread related: react to any utility a worker is asking for\n      [SET](actions, action, callback) {\n        const type = typeof callback;\n        if (type !== FUNCTION)\n          throw new Error(`Unable to assign ${action} as ${type}`);\n        // lazy event listener and logic handling, triggered once by setters actions\n        if (!actions.size) {\n          // maps results by `id` as they are asked for\n          const results = new Map;\n          // add the event listener once (first defined setter, all others work the same)\n          self.addEventListener('message', async (event) => {\n            // grub the very same library CHANNEL; ignore otherwise\n            const details = event.data?.[CHANNEL];\n            if (isArray(details)) {\n              // if early enough, avoid leaking data to other listeners\n              event.stopImmediatePropagation();\n              const [id, sb, ...rest] = details;\n              let error;\n              // action available: it must be defined/known on the main thread\n              if (rest.length) {\n                const [action, args] = rest;\n                if (actions.has(action)) {\n                  seppuku = true;\n                  try {\n                    // await for result either sync or async and serialize it\n                    const result = await actions.get(action)(...args);\n                    if (result !== void 0) {\n                      const serialized = stringify(transform ? transform(result) : result);\n                      // store the result for \"the very next\" event listener call\n                      results.set(id, serialized);\n                      // communicate the required SharedArrayBuffer length out of the\n                      // resulting serialized string\n                      sb[1] = serialized.length;\n                    }\n                  }\n                  catch (_) {\n                    error = _;\n                  }\n                  finally {\n                    seppuku = false;\n                  }\n                }\n                // unknown action should be notified as missing on the main thread\n                else {\n                  error = new Error(`Unsupported action: ${action}`);\n                }\n                // unlock the wait lock later on\n                sb[0] = 1;\n              }\n              // no action means: get results out of the well known `id`\n              // wait lock automatically unlocked here as no `0` value would\n              // possibly ever land at index `0`\n              else {\n                const result = results.get(id);\n                results.delete(id);\n                // populate the SharedArrayBuffer with utf-16 chars code\n                for (let ui16a = new Uint16Array(sb.buffer), i = 0; i < result.length; i++)\n                  ui16a[i] = result.charCodeAt(i);\n              }\n              // release te worker waiting either the length or the result\n              notify(sb, 0);\n              if (error) throw error;\n            }\n          });\n        }\n        // store this action callback allowing the setter in the process\n        return !!actions.set(action, callback);\n      }\n    }));\n  }\n  return context.get(self);\n};\n\ncoincident.transfer = (...args) => (buffers.add(args), args);\n\nexport default coincident;\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\nconst proxyMarker = Symbol(\"Comlink.proxy\");\nconst createEndpoint = Symbol(\"Comlink.endpoint\");\nconst releaseProxy = Symbol(\"Comlink.releaseProxy\");\nconst finalizer = Symbol(\"Comlink.finalizer\");\nconst throwMarker = Symbol(\"Comlink.thrown\");\nconst isObject = (val) => (typeof val === \"object\" && val !== null) || typeof val === \"function\";\n/**\n * Internal transfer handle to handle objects marked to proxy.\n */\nconst proxyTransferHandler = {\n    canHandle: (val) => isObject(val) && val[proxyMarker],\n    serialize(obj) {\n        const { port1, port2 } = new MessageChannel();\n        expose(obj, port1);\n        return [port2, [port2]];\n    },\n    deserialize(port) {\n        port.start();\n        return wrap(port);\n    },\n};\n/**\n * Internal transfer handler to handle thrown exceptions.\n */\nconst throwTransferHandler = {\n    canHandle: (value) => isObject(value) && throwMarker in value,\n    serialize({ value }) {\n        let serialized;\n        if (value instanceof Error) {\n            serialized = {\n                isError: true,\n                value: {\n                    message: value.message,\n                    name: value.name,\n                    stack: value.stack,\n                },\n            };\n        }\n        else {\n            serialized = { isError: false, value };\n        }\n        return [serialized, []];\n    },\n    deserialize(serialized) {\n        if (serialized.isError) {\n            throw Object.assign(new Error(serialized.value.message), serialized.value);\n        }\n        throw serialized.value;\n    },\n};\n/**\n * Allows customizing the serialization of certain values.\n */\nconst transferHandlers = new Map([\n    [\"proxy\", proxyTransferHandler],\n    [\"throw\", throwTransferHandler],\n]);\nfunction isAllowedOrigin(allowedOrigins, origin) {\n    for (const allowedOrigin of allowedOrigins) {\n        if (origin === allowedOrigin || allowedOrigin === \"*\") {\n            return true;\n        }\n        if (allowedOrigin instanceof RegExp && allowedOrigin.test(origin)) {\n            return true;\n        }\n    }\n    return false;\n}\nfunction expose(obj, ep = globalThis, allowedOrigins = [\"*\"]) {\n    ep.addEventListener(\"message\", function callback(ev) {\n        if (!ev || !ev.data) {\n            return;\n        }\n        if (!isAllowedOrigin(allowedOrigins, ev.origin)) {\n            console.warn(`Invalid origin '${ev.origin}' for comlink proxy`);\n            return;\n        }\n        const { id, type, path } = Object.assign({ path: [] }, ev.data);\n        const argumentList = (ev.data.argumentList || []).map(fromWireValue);\n        let returnValue;\n        try {\n            const parent = path.slice(0, -1).reduce((obj, prop) => obj[prop], obj);\n            const rawValue = path.reduce((obj, prop) => obj[prop], obj);\n            switch (type) {\n                case \"GET\" /* MessageType.GET */:\n                    {\n                        returnValue = rawValue;\n                    }\n                    break;\n                case \"SET\" /* MessageType.SET */:\n                    {\n                        parent[path.slice(-1)[0]] = fromWireValue(ev.data.value);\n                        returnValue = true;\n                    }\n                    break;\n                case \"APPLY\" /* MessageType.APPLY */:\n                    {\n                        returnValue = rawValue.apply(parent, argumentList);\n                    }\n                    break;\n                case \"CONSTRUCT\" /* MessageType.CONSTRUCT */:\n                    {\n                        const value = new rawValue(...argumentList);\n                        returnValue = proxy(value);\n                    }\n                    break;\n                case \"ENDPOINT\" /* MessageType.ENDPOINT */:\n                    {\n                        const { port1, port2 } = new MessageChannel();\n                        expose(obj, port2);\n                        returnValue = transfer(port1, [port1]);\n                    }\n                    break;\n                case \"RELEASE\" /* MessageType.RELEASE */:\n                    {\n                        returnValue = undefined;\n                    }\n                    break;\n                default:\n                    return;\n            }\n        }\n        catch (value) {\n            returnValue = { value, [throwMarker]: 0 };\n        }\n        Promise.resolve(returnValue)\n            .catch((value) => {\n            return { value, [throwMarker]: 0 };\n        })\n            .then((returnValue) => {\n            const [wireValue, transferables] = toWireValue(returnValue);\n            ep.postMessage(Object.assign(Object.assign({}, wireValue), { id }), transferables);\n            if (type === \"RELEASE\" /* MessageType.RELEASE */) {\n                // detach and deactive after sending release response above.\n                ep.removeEventListener(\"message\", callback);\n                closeEndPoint(ep);\n                if (finalizer in obj && typeof obj[finalizer] === \"function\") {\n                    obj[finalizer]();\n                }\n            }\n        })\n            .catch((error) => {\n            // Send Serialization Error To Caller\n            const [wireValue, transferables] = toWireValue({\n                value: new TypeError(\"Unserializable return value\"),\n                [throwMarker]: 0,\n            });\n            ep.postMessage(Object.assign(Object.assign({}, wireValue), { id }), transferables);\n        });\n    });\n    if (ep.start) {\n        ep.start();\n    }\n}\nfunction isMessagePort(endpoint) {\n    return endpoint.constructor.name === \"MessagePort\";\n}\nfunction closeEndPoint(endpoint) {\n    if (isMessagePort(endpoint))\n        endpoint.close();\n}\nfunction wrap(ep, target) {\n    const pendingListeners = new Map();\n    ep.addEventListener(\"message\", function handleMessage(ev) {\n        const { data } = ev;\n        if (!data || !data.id) {\n            return;\n        }\n        const resolver = pendingListeners.get(data.id);\n        if (!resolver) {\n            return;\n        }\n        try {\n            resolver(data);\n        }\n        finally {\n            pendingListeners.delete(data.id);\n        }\n    });\n    return createProxy(ep, pendingListeners, [], target);\n}\nfunction throwIfProxyReleased(isReleased) {\n    if (isReleased) {\n        throw new Error(\"Proxy has been released and is not useable\");\n    }\n}\nfunction releaseEndpoint(ep) {\n    return requestResponseMessage(ep, new Map(), {\n        type: \"RELEASE\" /* MessageType.RELEASE */,\n    }).then(() => {\n        closeEndPoint(ep);\n    });\n}\nconst proxyCounter = new WeakMap();\nconst proxyFinalizers = \"FinalizationRegistry\" in globalThis &&\n    new FinalizationRegistry((ep) => {\n        const newCount = (proxyCounter.get(ep) || 0) - 1;\n        proxyCounter.set(ep, newCount);\n        if (newCount === 0) {\n            releaseEndpoint(ep);\n        }\n    });\nfunction registerProxy(proxy, ep) {\n    const newCount = (proxyCounter.get(ep) || 0) + 1;\n    proxyCounter.set(ep, newCount);\n    if (proxyFinalizers) {\n        proxyFinalizers.register(proxy, ep, proxy);\n    }\n}\nfunction unregisterProxy(proxy) {\n    if (proxyFinalizers) {\n        proxyFinalizers.unregister(proxy);\n    }\n}\nfunction createProxy(ep, pendingListeners, path = [], target = function () { }) {\n    let isProxyReleased = false;\n    const proxy = new Proxy(target, {\n        get(_target, prop) {\n            throwIfProxyReleased(isProxyReleased);\n            if (prop === releaseProxy) {\n                return () => {\n                    unregisterProxy(proxy);\n                    releaseEndpoint(ep);\n                    pendingListeners.clear();\n                    isProxyReleased = true;\n                };\n            }\n            if (prop === \"then\") {\n                if (path.length === 0) {\n                    return { then: () => proxy };\n                }\n                const r = requestResponseMessage(ep, pendingListeners, {\n                    type: \"GET\" /* MessageType.GET */,\n                    path: path.map((p) => p.toString()),\n                }).then(fromWireValue);\n                return r.then.bind(r);\n            }\n            return createProxy(ep, pendingListeners, [...path, prop]);\n        },\n        set(_target, prop, rawValue) {\n            throwIfProxyReleased(isProxyReleased);\n            // FIXME: ES6 Proxy Handler `set` methods are supposed to return a\n            // boolean. To show good will, we return true asynchronously Â¯\\_(ãƒ„)_/Â¯\n            const [value, transferables] = toWireValue(rawValue);\n            return requestResponseMessage(ep, pendingListeners, {\n                type: \"SET\" /* MessageType.SET */,\n                path: [...path, prop].map((p) => p.toString()),\n                value,\n            }, transferables).then(fromWireValue);\n        },\n        apply(_target, _thisArg, rawArgumentList) {\n            throwIfProxyReleased(isProxyReleased);\n            const last = path[path.length - 1];\n            if (last === createEndpoint) {\n                return requestResponseMessage(ep, pendingListeners, {\n                    type: \"ENDPOINT\" /* MessageType.ENDPOINT */,\n                }).then(fromWireValue);\n            }\n            // We just pretend that `bind()` didnâ€™t happen.\n            if (last === \"bind\") {\n                return createProxy(ep, pendingListeners, path.slice(0, -1));\n            }\n            const [argumentList, transferables] = processArguments(rawArgumentList);\n            return requestResponseMessage(ep, pendingListeners, {\n                type: \"APPLY\" /* MessageType.APPLY */,\n                path: path.map((p) => p.toString()),\n                argumentList,\n            }, transferables).then(fromWireValue);\n        },\n        construct(_target, rawArgumentList) {\n            throwIfProxyReleased(isProxyReleased);\n            const [argumentList, transferables] = processArguments(rawArgumentList);\n            return requestResponseMessage(ep, pendingListeners, {\n                type: \"CONSTRUCT\" /* MessageType.CONSTRUCT */,\n                path: path.map((p) => p.toString()),\n                argumentList,\n            }, transferables).then(fromWireValue);\n        },\n    });\n    registerProxy(proxy, ep);\n    return proxy;\n}\nfunction myFlat(arr) {\n    return Array.prototype.concat.apply([], arr);\n}\nfunction processArguments(argumentList) {\n    const processed = argumentList.map(toWireValue);\n    return [processed.map((v) => v[0]), myFlat(processed.map((v) => v[1]))];\n}\nconst transferCache = new WeakMap();\nfunction transfer(obj, transfers) {\n    transferCache.set(obj, transfers);\n    return obj;\n}\nfunction proxy(obj) {\n    return Object.assign(obj, { [proxyMarker]: true });\n}\nfunction windowEndpoint(w, context = globalThis, targetOrigin = \"*\") {\n    return {\n        postMessage: (msg, transferables) => w.postMessage(msg, targetOrigin, transferables),\n        addEventListener: context.addEventListener.bind(context),\n        removeEventListener: context.removeEventListener.bind(context),\n    };\n}\nfunction toWireValue(value) {\n    for (const [name, handler] of transferHandlers) {\n        if (handler.canHandle(value)) {\n            const [serializedValue, transferables] = handler.serialize(value);\n            return [\n                {\n                    type: \"HANDLER\" /* WireValueType.HANDLER */,\n                    name,\n                    value: serializedValue,\n                },\n                transferables,\n            ];\n        }\n    }\n    return [\n        {\n            type: \"RAW\" /* WireValueType.RAW */,\n            value,\n        },\n        transferCache.get(value) || [],\n    ];\n}\nfunction fromWireValue(value) {\n    switch (value.type) {\n        case \"HANDLER\" /* WireValueType.HANDLER */:\n            return transferHandlers.get(value.name).deserialize(value.value);\n        case \"RAW\" /* WireValueType.RAW */:\n            return value.value;\n    }\n}\nfunction requestResponseMessage(ep, pendingListeners, msg, transfers) {\n    return new Promise((resolve) => {\n        const id = generateUUID();\n        pendingListeners.set(id, resolve);\n        if (ep.start) {\n            ep.start();\n        }\n        ep.postMessage(Object.assign({ id }, msg), transfers);\n    });\n}\nfunction generateUUID() {\n    return new Array(4)\n        .fill(0)\n        .map(() => Math.floor(Math.random() * Number.MAX_SAFE_INTEGER).toString(16))\n        .join(\"-\");\n}\n\nexport { createEndpoint, expose, finalizer, proxy, proxyMarker, releaseProxy, transfer, transferHandlers, windowEndpoint, wrap };\n//# sourceMappingURL=comlink.mjs.map\n","/*\n * Copyright (c) 2021-2023 Datalayer, Inc.\n *\n * MIT License\n */\nimport coincident from 'coincident';\nimport { wrap } from 'comlink';\nimport { PromiseDelegate } from '@lumino/coreutils';\nimport { PageConfig } from '@jupyterlab/coreutils';\nimport { BaseKernel } from '../kernel';\nimport { allJSONUrl, pipliteWheelUrl } from './_pypi';\nimport { DriveContentsProcessor, } from '../contents';\n/**\n * A kernel that executes Python code with Pyodide.\n */\nexport class PyodideKernel extends BaseKernel {\n    /**\n     * Instantiate a new PyodideKernel\n     *\n     * @param options The instantiation options for a new PyodideKernel\n     */\n    constructor(options) {\n        super(options);\n        this._worker = this.initWorker(options);\n        this._remoteKernel = this.initRemote(options);\n        this._contentsManager = options.contentsManager;\n    }\n    /**\n     * Load the worker.\n     *\n     * ### Note\n     *\n     * Subclasses must implement this typographically almost _exactly_ for\n     * webpack to find it.\n     */\n    initWorker(options) {\n        if (crossOriginIsolated) {\n            return new Worker(new URL('./coincident.worker.js', import.meta.url), {\n                type: 'module',\n            });\n        }\n        else {\n            return new Worker(new URL('./comlink.worker.js', import.meta.url), {\n                type: 'module',\n            });\n        }\n    }\n    /**\n     * Initialize the remote kernel.\n     * Use coincident if crossOriginIsolated, comlink otherwise\n     * See the two following issues for more context:\n     *  - https://github.com/jupyterlite/jupyterlite/issues/1424\n     *  - https://github.com/jupyterlite/pyodide-kernel/pull/126\n     */\n    initRemote(options) {\n        let remote;\n        if (crossOriginIsolated) {\n            remote = coincident(this._worker);\n            remote.processWorkerMessage = this._processWorkerMessage.bind(this);\n            // The coincident worker uses its own filesystem API:\n            remote.processDriveRequest = async (data) => {\n                if (!DriveContentsProcessor) {\n                    throw new Error('File system calls over Atomics.wait is only supported with jupyterlite>=0.4.0a3');\n                }\n                if (this._contentsProcessor === undefined) {\n                    this._contentsProcessor = new DriveContentsProcessor({\n                        contentsManager: this._contentsManager,\n                    });\n                }\n                return await this._contentsProcessor.processDriveRequest(data);\n            };\n        }\n        else {\n            remote = wrap(this._worker);\n            // we use the normal postMessage mechanism\n            this._worker.addEventListener('message', ev => {\n                if (typeof ev?.data?._kernelMessage !== 'undefined') {\n                    // only process non comlink messages\n                    this._processWorkerMessage(ev.data._kernelMessage);\n                }\n            });\n        }\n        const remoteOptions = this.initRemoteOptions(options);\n        remote\n            .initialize(remoteOptions)\n            .then(this._ready.resolve.bind(this._ready));\n        return remote;\n    }\n    initRemoteOptions(options) {\n        const { pyodideUrl } = options;\n        const indexUrl = pyodideUrl.slice(0, pyodideUrl.lastIndexOf('/') + 1);\n        const baseUrl = PageConfig.getBaseUrl();\n        const pipliteUrls = [...(options.pipliteUrls || []), allJSONUrl.default];\n        const disablePyPIFallback = !!options.disablePyPIFallback;\n        return {\n            baseUrl,\n            pyodideUrl,\n            indexUrl,\n            pipliteWheelUrl: options.pipliteWheelUrl || pipliteWheelUrl.default,\n            pipliteUrls,\n            disablePyPIFallback,\n            location: this.location,\n            mountDrive: options.mountDrive,\n            loadPyodideOptions: options.loadPyodideOptions || {},\n        };\n    }\n    /**\n     * Dispose the kernel.\n     */\n    dispose() {\n        if (this.isDisposed) {\n            return;\n        }\n        this._worker.terminate();\n        this._worker = null;\n        super.dispose();\n    }\n    /**\n     * A promise that is fulfilled when the kernel is ready.\n     */\n    get ready() {\n        return this._ready.promise;\n    }\n    /**\n     * Process a message coming from the pyodide web worker.\n     *\n     * @param msg The worker message to process.\n     */\n    _processWorkerMessage(msg) {\n        if (!msg.type) {\n            return;\n        }\n        switch (msg.type) {\n            case 'stream': {\n                const bundle = msg.bundle ?? { name: 'stdout', text: '' };\n                this.stream(bundle, msg.parentHeader);\n                break;\n            }\n            case 'input_request': {\n                const bundle = msg.content ?? { prompt: '', password: false };\n                this.inputRequest(bundle, msg.parentHeader);\n                break;\n            }\n            case 'display_data': {\n                const bundle = msg.bundle ?? { data: {}, metadata: {}, transient: {} };\n                this.displayData(bundle, msg.parentHeader);\n                break;\n            }\n            case 'update_display_data': {\n                const bundle = msg.bundle ?? { data: {}, metadata: {}, transient: {} };\n                this.updateDisplayData(bundle, msg.parentHeader);\n                break;\n            }\n            case 'clear_output': {\n                const bundle = msg.bundle ?? { wait: false };\n                this.clearOutput(bundle, msg.parentHeader);\n                break;\n            }\n            case 'execute_result': {\n                const bundle = msg.bundle ?? {\n                    execution_count: 0,\n                    data: {},\n                    metadata: {},\n                };\n                this.publishExecuteResult(bundle, msg.parentHeader);\n                break;\n            }\n            case 'execute_error': {\n                const bundle = msg.bundle ?? { ename: '', evalue: '', traceback: [] };\n                this.publishExecuteError(bundle, msg.parentHeader);\n                break;\n            }\n            case 'comm_msg':\n            case 'comm_open':\n            case 'comm_close': {\n                this.handleComm(msg.type, msg.content, msg.metadata, msg.buffers, msg.parentHeader);\n                break;\n            }\n        }\n    }\n    /**\n     * Handle a kernel_info_request message\n     */\n    async kernelInfoRequest() {\n        const content = {\n            implementation: 'pyodide',\n            implementation_version: '0.1.0',\n            language_info: {\n                codemirror_mode: {\n                    name: 'python',\n                    version: 3,\n                },\n                file_extension: '.py',\n                mimetype: 'text/x-python',\n                name: 'python',\n                nbconvert_exporter: 'python',\n                pygments_lexer: 'ipython3',\n                version: '3.8',\n            },\n            protocol_version: '5.3',\n            status: 'ok',\n            banner: 'A WebAssembly-powered Python kernel backed by Pyodide',\n            help_links: [\n                {\n                    text: 'Python (WASM) Kernel',\n                    url: 'https://pyodide.org',\n                },\n            ],\n        };\n        return content;\n    }\n    /**\n     * Handle an `execute_request` message\n     *\n     * @param msg The parent message.\n     */\n    async executeRequest(content) {\n        await this.ready;\n        const result = await this._remoteKernel.execute(content, this.parent);\n        result.execution_count = this.executionCount;\n        return result;\n    }\n    /**\n     * Handle an complete_request message\n     *\n     * @param msg The parent message.\n     */\n    async completeRequest(content) {\n        return await this._remoteKernel.complete(content, this.parent);\n    }\n    /**\n     * Handle an `inspect_request` message.\n     *\n     * @param content - The content of the request.\n     *\n     * @returns A promise that resolves with the response message.\n     */\n    async inspectRequest(content) {\n        return await this._remoteKernel.inspect(content, this.parent);\n    }\n    /**\n     * Handle an `is_complete_request` message.\n     *\n     * @param content - The content of the request.\n     *\n     * @returns A promise that resolves with the response message.\n     */\n    async isCompleteRequest(content) {\n        return await this._remoteKernel.isComplete(content, this.parent);\n    }\n    /**\n     * Handle a `comm_info_request` message.\n     *\n     * @param content - The content of the request.\n     *\n     * @returns A promise that resolves with the response message.\n     */\n    async commInfoRequest(content) {\n        return await this._remoteKernel.commInfo(content, this.parent);\n    }\n    /**\n     * Send an `comm_open` message.\n     *\n     * @param msg - The comm_open message.\n     */\n    async commOpen(msg) {\n        return await this._remoteKernel.commOpen(msg, this.parent);\n    }\n    /**\n     * Send an `comm_msg` message.\n     *\n     * @param msg - The comm_msg message.\n     */\n    async commMsg(msg) {\n        return await this._remoteKernel.commMsg(msg, this.parent);\n    }\n    /**\n     * Send an `comm_close` message.\n     *\n     * @param close - The comm_close message.\n     */\n    async commClose(msg) {\n        return await this._remoteKernel.commClose(msg, this.parent);\n    }\n    /**\n     * Send an `input_reply` message.\n     *\n     * @param content - The content of the reply.\n     */\n    async inputReply(content) {\n        return await this._remoteKernel.inputReply(content, this.parent);\n    }\n    _contentsManager;\n    _contentsProcessor;\n    _worker;\n    _remoteKernel;\n    _ready = new PromiseDelegate();\n}\n//# sourceMappingURL=kernel.js.map"],"names":["BaseKernel","constructor","options","id","name","location","sendMessage","this","_id","_name","_location","_sendMessage","ready","Promise","resolve","isDisposed","_isDisposed","disposed","_disposed","executionCount","_executionCount","parentHeader","_parentHeader","parent","_parent","dispose","emit","handleMessage","msg","_busy","header","msg_type","_kernelInfo","_execute","inputReply","content","_inspect","_isCompleteRequest","_complete","_historyRequest","commOpen","commMsg","commClose","_idle","stream","parentHeaderValue","message","KernelMessage","createMessage","channel","msgType","session","displayData","metadata","inputRequest","publishExecuteResult","publishExecuteError","updateDisplayData","clearOutput","handleComm","type","buffers","execution_state","kernelInfoRequest","historyMsg","status","history","_history","_executeInput","code","execution_count","executeMsg","store_history","push","reply","executeRequest","completeMsg","completeRequest","inspectMsg","inspectRequest","isCompleteMsg","isCompleteRequest","Signal","allJson","ipykernel","releases","url","piplite","widgetsnbextension","getWheelUrl","packageName","version","pkg","console","error","Error","versions","Object","keys","targetVersion","length","allJSONUrl","default","replace","pipliteWheelUrl","FUNCTION","CHANNEL","GET","HAS","SET","isArray","Array","SharedArrayBuffer","window","globalThis","notify","wait","waitAsync","Atomics","postPatched","buffer","value","onmessage","w","Worker","postMessage","_","ArrayBuffer","ids","WeakMap","resolvers","Map","prototype","listener","event","details","data","stopImmediatePropagation","sb","get","rest","set","addEventListener","call","then","buff","delete","i","as","Int32Array","Uint16Array","BYTES_PER_ELEMENT","I32_BYTES","UI16_BYTES","WeakSet","context","syncResult","fn","uid","coincident","self","parse","JSON","stringify","transform","interrupt","has","post","transfer","args","handler","delay","decoder","TextDecoder","waitFor","isAsync","waitInterrupt","seppuku","Proxy","action","startsWith","at","pop","map","deadlock","setTimeout","warn","clearTimeout","bytes","decode","slice","actions","callback","size","results","async","result","serialized","ui16a","charCodeAt","add","proxyMarker","createEndpoint","releaseProxy","finalizer","throwMarker","isObject","val","transferHandlers","canHandle","serialize","obj","port1","port2","MessageChannel","expose","deserialize","port","start","wrap","isError","stack","assign","ep","allowedOrigins","ev","origin","allowedOrigin","RegExp","test","isAllowedOrigin","path","argumentList","fromWireValue","returnValue","reduce","prop","rawValue","apply","proxy","transfers","transferCache","catch","wireValue","transferables","toWireValue","removeEventListener","closeEndPoint","TypeError","endpoint","isMessagePort","close","target","pendingListeners","resolver","createProxy","throwIfProxyReleased","isReleased","releaseEndpoint","requestResponseMessage","proxyCounter","proxyFinalizers","FinalizationRegistry","newCount","isProxyReleased","_target","unregister","unregisterProxy","clear","r","p","toString","bind","_thisArg","rawArgumentList","last","processArguments","construct","register","registerProxy","processed","v","arr","concat","serializedValue","fill","Math","floor","random","Number","MAX_SAFE_INTEGER","join","PyodideKernel","super","_worker","initWorker","_remoteKernel","initRemote","_contentsManager","contentsManager","crossOriginIsolated","URL","remote","processWorkerMessage","_processWorkerMessage","processDriveRequest","DriveContentsProcessor","_contentsProcessor","_kernelMessage","remoteOptions","initRemoteOptions","initialize","_ready","pyodideUrl","indexUrl","lastIndexOf","baseUrl","PageConfig","getBaseUrl","pipliteUrls","disablePyPIFallback","mountDrive","loadPyodideOptions","terminate","promise","bundle","text","prompt","password","transient","ename","evalue","traceback","implementation","implementation_version","language_info","codemirror_mode","file_extension","mimetype","nbconvert_exporter","pygments_lexer","protocol_version","banner","help_links","execute","complete","inspect","isComplete","commInfoRequest","commInfo","PromiseDelegate"],"mappings":"qHAUO,MAAMA,EAMT,WAAAC,CAAYC,GACR,MAAMC,GAAEA,EAAAC,KAAIA,EAAAC,SAAMA,EAAAC,YAAUA,GAAgBJ,EAC5CK,KAAKC,IAAML,EACXI,KAAKE,MAAQL,EACbG,KAAKG,UAAYL,EACjBE,KAAKI,aAAeL,CACxB,CAIA,SAAIM,GACA,OAAOC,QAAQC,SACnB,CAIA,cAAIC,GACA,OAAOR,KAAKS,WAChB,CAIA,YAAIC,GACA,OAAOV,KAAKW,SAChB,CAIA,MAAIf,GACA,OAAOI,KAAKC,GAChB,CAIA,QAAIJ,GACA,OAAOG,KAAKE,KAChB,CAIA,YAAIJ,GACA,OAAOE,KAAKG,SAChB,CAIA,kBAAIS,GACA,OAAOZ,KAAKa,eAChB,CAIA,gBAAIC,GACA,OAAOd,KAAKe,aAChB,CAIA,UAAIC,GACA,OAAOhB,KAAKiB,OAChB,CAIA,OAAAC,GACQlB,KAAKQ,aAGTR,KAAKS,aAAc,EACnBT,KAAKW,UAAUQ,UAAK,GACxB,CAMA,mBAAMC,CAAcC,GAChBrB,KAAKsB,MAAMD,GACXrB,KAAKiB,QAAUI,EAEf,OADgBA,EAAIE,OAAOC,UAEvB,IAAK,4BACKxB,KAAKyB,YAAYJ,GACvB,MACJ,IAAK,wBACKrB,KAAK0B,SAASL,GACpB,MACJ,IAAK,cACDrB,KAAK2B,WAAWN,EAAIO,SACpB,MACJ,IAAK,wBACK5B,KAAK6B,SAASR,GACpB,MACJ,IAAK,4BACKrB,KAAK8B,mBAAmBT,GAC9B,MACJ,IAAK,yBACKrB,KAAK+B,UAAUV,GACrB,MACJ,IAAK,wBACKrB,KAAKgC,gBAAgBX,GAC3B,MACJ,IAAK,kBACKrB,KAAKiC,SAASZ,GACpB,MACJ,IAAK,iBACKrB,KAAKkC,QAAQb,GACnB,MACJ,IAAK,mBACKrB,KAAKmC,UAAUd,GAK7BrB,KAAKoC,MAAMf,EACf,CAOA,MAAAgB,CAAOT,EAASd,OAAe,GAC3B,MAAMwB,OAA4C,IAAjBxB,EAA+BA,EAAed,KAAKe,cAC9EwB,EAAUC,EAAAA,cAAcC,cAAc,CACxCC,QAAS,QACTC,QAAS,SAETC,QAASN,GAAmBM,SAAW,GACvC9B,aAAcwB,EACdV,YAEJ5B,KAAKI,aAAamC,EACtB,CAOA,WAAAM,CAAYjB,EAASd,OAAe,GAEhC,MAAMwB,OAA4C,IAAjBxB,EAA+BA,EAAed,KAAKe,cACpFa,EAAQkB,SAAWlB,EAAQkB,UAAY,CAAA,EACvC,MAAMP,EAAUC,EAAAA,cAAcC,cAAc,CACxCC,QAAS,QACTC,QAAS,eAETC,QAASN,GAAmBM,SAAW,GACvC9B,aAAcwB,EACdV,YAEJ5B,KAAKI,aAAamC,EACtB,CAOA,YAAAQ,CAAanB,EAASd,OAAe,GACjC,MAAMwB,OAA4C,IAAjBxB,EAA+BA,EAAed,KAAKe,cAC9EwB,EAAUC,EAAAA,cAAcC,cAAc,CACxCC,QAAS,QACTC,QAAS,gBAETC,QAASN,GAAmBM,SAAW,GACvC9B,aAAcwB,EACdV,YAEJ5B,KAAKI,aAAamC,EACtB,CAOA,oBAAAS,CAAqBpB,EAASd,OAAe,GACzC,MAAMwB,OAA4C,IAAjBxB,EAA+BA,EAAed,KAAKe,cAC9EwB,EAAUC,EAAAA,cAAcC,cAAc,CACxCC,QAAS,QACTC,QAAS,iBAETC,QAASN,GAAmBM,SAAW,GACvC9B,aAAcwB,EACdV,YAEJ5B,KAAKI,aAAamC,EACtB,CAOA,mBAAAU,CAAoBrB,EAASd,OAAe,GACxC,MAAMwB,OAA4C,IAAjBxB,EAA+BA,EAAed,KAAKe,cAC9EwB,EAAUC,EAAAA,cAAcC,cAAc,CACxCC,QAAS,QACTC,QAAS,QAETC,QAASN,GAAmBM,SAAW,GACvC9B,aAAcwB,EACdV,YAEJ5B,KAAKI,aAAamC,EACtB,CAOA,iBAAAW,CAAkBtB,EAASd,OAAe,GACtC,MAAMwB,OAA4C,IAAjBxB,EAA+BA,EAAed,KAAKe,cAC9EwB,EAAUC,EAAAA,cAAcC,cAAc,CACxCC,QAAS,QACTC,QAAS,sBAETC,QAASN,GAAmBM,SAAW,GACvC9B,aAAcwB,EACdV,YAEJ5B,KAAKI,aAAamC,EACtB,CAOA,WAAAY,CAAYvB,EAASd,OAAe,GAChC,MAAMwB,OAA4C,IAAjBxB,EAA+BA,EAAed,KAAKe,cAC9EwB,EAAUC,EAAAA,cAAcC,cAAc,CACxCC,QAAS,QACTC,QAAS,eAETC,QAASN,GAAmBM,SAAW,GACvC9B,aAAcwB,EACdV,YAEJ5B,KAAKI,aAAamC,EACtB,CAMA,UAAAa,CAAWC,EAAMzB,EAASkB,EAAUQ,EAASxC,OAAe,GACxD,MAAMwB,OAA4C,IAAjBxB,EAA+BA,EAAed,KAAKe,cAC9EwB,EAAUC,EAAAA,cAAcC,cAAc,CACxCC,QAAS,QACTC,QAASU,EAETT,QAASN,GAAmBM,SAAW,GACvC9B,aAAcwB,EACdV,UACAkB,WACAQ,QAAAA,IAEJtD,KAAKI,aAAamC,EACtB,CAMA,KAAAH,CAAMpB,GACF,MAAMuB,EAAUC,EAAAA,cAAcC,cAAc,CACxCE,QAAS,SACTC,QAAS5B,EAAOO,OAAOqB,QACvB9B,aAAcE,EAAOO,OACrBmB,QAAS,QACTd,QAAS,CACL2B,gBAAiB,UAGzBvD,KAAKI,aAAamC,EACtB,CAMA,KAAAjB,CAAMN,GACF,MAAMuB,EAAUC,EAAAA,cAAcC,cAAc,CACxCE,QAAS,SACTC,QAAS5B,EAAOO,OAAOqB,QACvB9B,aAAcE,EAAOO,OACrBmB,QAAS,QACTd,QAAS,CACL2B,gBAAiB,UAGzBvD,KAAKI,aAAamC,EACtB,CAMA,iBAAMd,CAAYT,GACd,MAAMY,QAAgB5B,KAAKwD,oBACrBjB,EAAUC,EAAAA,cAAcC,cAAc,CACxCE,QAAS,oBACTD,QAAS,QACTE,QAAS5B,EAAOO,OAAOqB,QACvB9B,aAAcE,EAAOO,OACrBK,YAEJ5B,KAAKI,aAAamC,EACtB,CAMA,qBAAMP,CAAgBX,GAClB,MAAMoC,EAAapC,EACbkB,EAAUC,EAAAA,cAAcC,cAAc,CACxCE,QAAS,gBACTD,QAAS,QACT5B,aAAc2C,EAAWlC,OACzBqB,QAASvB,EAAIE,OAAOqB,QACpBhB,QAAS,CACL8B,OAAQ,KACRC,QAAS3D,KAAK4D,YAGtB5D,KAAKI,aAAamC,EACtB,CAMA,aAAAsB,CAAcxC,GACV,MAAML,EAASK,EACTyC,EAAO9C,EAAOY,QAAQkC,KACtBvB,EAAUC,EAAAA,cAAcC,cAAc,CACxCE,QAAS,gBACT7B,aAAcE,EAAOO,OACrBmB,QAAS,QACTE,QAASvB,EAAIE,OAAOqB,QACpBhB,QAAS,CACLkC,OACAC,gBAAiB/D,KAAKa,mBAG9Bb,KAAKI,aAAamC,EACtB,CAMA,cAAMb,CAASL,GACX,MAAM2C,EAAa3C,EACbO,EAAUoC,EAAWpC,QACvBA,EAAQqC,eACRjE,KAAKa,kBAGTb,KAAKe,cAAgBiD,EAAWzC,OAChCvB,KAAK6D,cAAcG,GACfpC,EAAQqC,eACRjE,KAAK4D,SAASM,KAAK,CAAC,EAAG,EAAGtC,EAAQkC,OAEtC,MAAMK,QAAcnE,KAAKoE,eAAeJ,EAAWpC,SAC7CW,EAAUC,EAAAA,cAAcC,cAAc,CACxCE,QAAS,gBACTD,QAAS,QACT5B,aAAckD,EAAWzC,OACzBqB,QAASvB,EAAIE,OAAOqB,QACpBhB,QAASuC,IAEbnE,KAAKI,aAAamC,EACtB,CAMA,eAAMR,CAAUV,GACZ,MAAMgD,EAAchD,EACdO,QAAgB5B,KAAKsE,gBAAgBD,EAAYzC,SACjDW,EAAUC,EAAAA,cAAcC,cAAc,CACxCE,QAAS,iBACT7B,aAAcuD,EAAY9C,OAC1BmB,QAAS,QACTE,QAASvB,EAAIE,OAAOqB,QACpBhB,YAEJ5B,KAAKI,aAAamC,EACtB,CAMA,cAAMV,CAASR,GACX,MAAMkD,EAAalD,EACbO,QAAgB5B,KAAKwE,eAAeD,EAAW3C,SAC/CW,EAAUC,EAAAA,cAAcC,cAAc,CACxCE,QAAS,gBACT7B,aAAcyD,EAAWhD,OACzBmB,QAAS,QACTE,QAASvB,EAAIE,OAAOqB,QACpBhB,YAEJ5B,KAAKI,aAAamC,EACtB,CAMA,wBAAMT,CAAmBT,GACrB,MAAMoD,EAAgBpD,EAChBO,QAAgB5B,KAAK0E,kBAAkBD,EAAc7C,SACrDW,EAAUC,EAAAA,cAAcC,cAAc,CACxCE,QAAS,oBACT7B,aAAc2D,EAAclD,OAC5BmB,QAAS,QACTE,QAASvB,EAAIE,OAAOqB,QACpBhB,YAEJ5B,KAAKI,aAAamC,EACtB,CACAtC,IACAC,MACAC,UACAyD,SAAW,GACX/C,gBAAkB,EAClBJ,aAAc,EACdE,UAAY,IAAIgE,EAAO3E,MACvBI,aACAW,mBAAgB,EAChBE,aAAU,EC7bd,MAAM2D,EAAU,CACZC,UAAW,CACPC,SAAU,CACN,QAAS,CACL,CACIC,IAAK,0EAKrBC,QAAS,CACLF,SAAU,CACN,QAAS,CACL,CACIC,IAAK,wEAKrB,iBAAkB,CACdD,SAAU,CACN,QAAS,CACL,CACIC,IAAK,+EAKrBE,mBAAoB,CAChBH,SAAU,CACN,UAAW,CACP,CACIC,IAAK,mFAGb,UAAW,CACP,CACIA,IAAK,sFAOzB,SAASG,EAAYC,EAAaC,GAC9B,MAAMC,EAAMT,EAAQO,GACpB,IAAKE,EAGD,MAFAC,QAAQC,MAAM,qBAAsBX,GACpCU,QAAQC,MAAM,uBAAwBJ,GAChC,IAAIK,MAAM,WAAWL,2BAE/B,MAAMM,EAAWC,OAAOC,KAAKN,EAAIP,UAC3Bc,EAAgBR,GAAWK,EAASA,EAASI,OAAS,GACtDf,EAAWO,EAAIP,SAASc,GAC9B,IAAKd,GAAgC,IAApBA,EAASe,OACtB,MAAM,IAAIL,MAAM,yBAAyBL,KAAeS,KAE5D,OAAOd,EAAS,GAAGC,GACvB,CAEY,MAACe,EAAa,CACtBC,QAASnB,EAAiB,SAAGE,SAAS,WAAW,IAAIC,KAAKiB,QAAQ,mBAAoB,aAAe,+CAG5FC,EAAkB,CAC3BF,QAASb,EAAY,UAAW,UAGvBA,EAAY,YAAa,SAGzBA,EAAY,iBAAkB,SAG9BA,EAAY,qBAAsB,WAGlCA,EAAY,qBAAsB,WCpFxC,MAAMgB,EAAY,WCFZC,EAAU,uCCGVC,EAA+B,MAG/BC,EAA+B,MAI/BC,EAA+B,OCHtCC,QAACA,GAAWC,MAElB,IAAIC,kBAACA,EAAAC,OAAmBA,GAAUC,YAC9BC,OAACA,EAAAC,KAAQA,EAAAC,UAAMA,GAAaC,QAC5BC,EAAc,KAGbF,IACHA,EAAYG,IAAA,CACVC,MAAO,IAAI5G,QAAQ6G,IAEjB,IAAIC,EAAI,IAAIC,OAAO,wGACnBD,EAAED,UAAYA,EACdC,EAAEE,YAAYL,QAMpB,IACE,IAAIR,EAAkB,EACxB,CAAA,MACOc,GACLd,EAAoBe,YAEpB,MAAMC,qBAAUC,QAEhB,GAAIhB,EAAQ,CACV,MAAMiB,qBAAgBC,KACfC,WAAYP,YAAAA,IAAgBD,OAE7BS,EAAWC,IACf,MAAMC,EAAUD,EAAME,OAAO9B,GAC7B,IAAKI,EAAQyB,GAAU,CACrBD,EAAMG,2BACN,MAAMtI,GAAEA,EAAAuI,GAAIA,GAAOH,EACnBL,EAAUS,IAAIxI,EAAd+H,CAAkBQ,EACpB,GAGFnB,EAAc,SAAUiB,KAASI,GAC/B,MAAML,EAAUC,IAAO9B,GACvB,GAAII,EAAQyB,GAAU,CACpB,MAAOpI,EAAIuI,GAAMH,EACjBP,EAAIa,IAAIH,EAAIvI,GACZI,KAAKuI,iBAAiB,UAAWT,EACnC,CACA,OAAOR,EAAYkB,KAAKxI,KAAMiI,KAASI,EACzC,EAEAvB,EAAYqB,IAAA,CACVjB,MAAO,IAAI5G,QAAQC,IACjBoH,EAAUW,IAAIb,EAAIW,IAAID,GAAK5H,KAC1BkI,KAAKC,IACNf,EAAUgB,OAAOlB,EAAIW,IAAID,IACzBV,EAAIkB,OAAOR,GACX,IAAA,IAASS,EAAI,EAAGA,EAAIF,EAAK7C,OAAQ+C,IAAKT,EAAGS,GAAKF,EAAKE,GACnD,MAAO,QAGb,KACK,CACH,MAAMC,EAAK,CAACjJ,EAAIuI,KAAA,CAAShC,CAACA,GAAU,CAAEvG,KAAIuI,QAE1CvB,EAASuB,IACPb,YAAYuB,EAAGpB,EAAIW,IAAID,GAAKA,KAG9BI,iBAAiB,UAAWR,IAC1B,MAAMC,EAAUD,EAAME,OAAO9B,GAC7B,GAAII,EAAQyB,GAAU,CACpB,MAAOpI,EAAIuI,GAAMH,EACjBP,EAAIa,IAAIH,EAAIvI,EACd,GAEJ,CACF,CC1EA,MAAMkJ,WAACA,EAAAlB,IAAYA,EAAAA,YAAKmB,GAAepC,YAGhCqC,kBAAmBC,GAAaH,GAChCE,kBAAmBE,GAAcH,EAQlCzF,qBAAc6F,QAGdC,qBAAc1B,QAEd2B,EAAa,CAACnC,MAAO,CAACuB,KAAMa,GAAMA,MAGxC,IAAIC,EAAM,EAcV,MAAMC,EAAa,CAACC,GAAOC,QAAQC,KAAKD,MAAOE,YAAYD,KAAKC,UAAWC,YAAWC,aAAaH,QAEjG,IAAKP,EAAQW,IAAIN,GAAO,CAEtB,MAAM1J,EAAciH,GAAeyC,EAAKnC,YAElC0C,EAAO,CAACC,KAAaC,IAASnK,EAAYyI,KAAKiB,EAAM,CAACtD,CAACA,GAAU+D,GAAO,CAACD,SAAAA,IAEzEE,SAAiBL,IAAc5D,EAAW4D,EAAYA,GAAWK,QACjEC,EAAQN,GAAWM,OAAS,GAC5BC,EAAU,IAAIC,YAAY,UAI1BC,EAAU,CAACC,EAASrC,IAAOqC,EAC/B1D,EAAUqB,EAAI,IACZgC,EA5Cc,EAAChC,EAAIiC,EAAOD,KAChC,KAAiC,cAA1BtD,EAAKsB,EAAI,EAAG,EAAGiC,IACpBD,KA0CcM,CAActC,EAAIiC,EAAOD,GAAWtD,EAAKsB,EAAI,GAAKkB,GAGhE,IAAIqB,GAAU,EAEdtB,EAAQd,IAAImB,EAAM,IAAIkB,MAAM,IAAI/C,EAAK,CAOnCvB,CAACA,GAAM,CAACkB,EAAGqD,IAA6B,iBAAXA,IAAwBA,EAAOC,WAAW,KAGvEzE,CAACA,GAAM,CAACmB,EAAGqD,IAAsB,SAAXA,EAAoB,KAAA,IAAYV,KAEpD,MAAMtK,EAAK2J,IAIX,IAAIpB,EAAK,IAAIW,EAAW,IAAIrC,EAA8B,EAAZwC,IAG1CgB,EAAW,GACX3G,EAAQyG,IAAIG,EAAKY,IAAG,IAAOb,IAC7B3G,EAAQqF,OAAOsB,EAAWC,EAAKa,OAGjCf,EAAKC,EAAUrK,EAAIuI,EAAIyC,EAAQf,EAAYK,EAAKc,IAAInB,GAAaK,GAGjE,MAAMM,EAAUf,IAAS9C,WAIzB,IAAIsE,EAAW,EAIf,OAHIP,GAAWF,IACbS,EAAWC,WAAW5F,QAAQ6F,KAAM,IAAM,qCAAqCP,0BAE1EL,EAAQC,EAASrC,GAAIjB,MAAMuB,KAAK,KACrC2C,aAAaH,GAGb,MAAMpF,EAASsC,EAAG,GAGlB,IAAKtC,EAAQ,OAGb,MAAMwF,EAAQnC,EAAarD,EAO3B,OAJAsC,EAAK,IAAIW,EAAW,IAAIrC,EAAkB4E,EAASA,EAAQpC,IAG3De,EAAK,GAAIpK,EAAIuI,GACNoC,EAAQC,EAASrC,GAAIjB,MAAMuB,KAAK,IAAMiB,EAC3CW,EAAQiB,OAAO,IAAIvC,EAAYZ,EAAGlB,QAAQsE,MAAM,EAAG1F,OAGzD,EAGA,CAACS,GAAKkF,EAASZ,EAAQa,GACrB,MAAMpI,SAAcoI,EACpB,GAAIpI,IAAS6C,EACX,MAAM,IAAIV,MAAM,oBAAoBoF,QAAavH,KAEnD,IAAKmI,EAAQE,KAAM,CAEjB,MAAMC,EAAU,IAAI/D,EAEpB6B,EAAKlB,iBAAiB,UAAWqD,MAAO7D,IAEtC,MAAMC,EAAUD,EAAME,OAAO9B,GAC7B,GAAII,EAAQyB,GAAU,CAEpBD,EAAMG,2BACN,MAAOtI,EAAIuI,KAAOE,GAAQL,EAC1B,IAAIzC,EAEJ,GAAI8C,EAAKxC,OAAQ,CACf,MAAO+E,EAAQV,GAAQ7B,EACvB,GAAImD,EAAQzB,IAAIa,GAAS,CACvBF,GAAU,EACV,IAEE,MAAMmB,QAAeL,EAAQpD,IAAIwC,EAAZY,IAAuBtB,GAC5C,QAAe,IAAX2B,EAAmB,CACrB,MAAMC,EAAalC,EAAUC,EAAYA,EAAUgC,GAAUA,GAE7DF,EAAQrD,IAAI1I,EAAIkM,GAGhB3D,EAAG,GAAK2D,EAAWjG,MACrB,CACF,OACO0B,GACLhC,EAAQgC,CACV,CAAA,QAEEmD,GAAU,CACZ,CACF,MAGEnF,EAAQ,IAAIC,MAAM,uBAAuBoF,KAG3CzC,EAAG,GAAK,CACV,KAIK,CACH,MAAM0D,EAASF,EAAQvD,IAAIxI,GAC3B+L,EAAQhD,OAAO/I,GAEf,IAAA,IAASmM,EAAQ,IAAIhD,EAAYZ,EAAGlB,QAAS2B,EAAI,EAAGA,EAAIiD,EAAOhG,OAAQ+C,IACrEmD,EAAMnD,GAAKiD,EAAOG,WAAWpD,EACjC,CAGA,GADAhC,EAAOuB,EAAI,GACP5C,EAAO,MAAMA,CACnB,GAEJ,CAEA,QAASiG,EAAQlD,IAAIsC,EAAQa,EAC/B,IAEJ,CACA,OAAOrC,EAAQhB,IAAIqB,IAGrBD,EAAWS,SAAW,IAAIC,KAAU5G,EAAQ2I,IAAI/B,GAAOA,GC/LvD,MAAMgC,wBAAqB,iBACrBC,wBAAwB,oBACxBC,wBAAsB,wBACtBC,wBAAmB,qBACnBC,wBAAqB,kBACrBC,EAAYC,GAAwB,iBAARA,GAA4B,OAARA,GAAgC,mBAARA,EAgDxEC,qBAAuB7E,IAAI,CAC7B,CAAC,QA7CwB,CACzB8E,UAAYF,GAAQD,EAASC,IAAQA,EAAIN,GACzC,SAAAS,CAAUC,GACN,MAAMC,MAAEA,EAAAC,MAAOA,GAAU,IAAIC,eAE7B,OADAC,EAAOJ,EAAKC,GACL,CAACC,EAAO,CAACA,GACpB,EACAG,YAAYC,IACRA,EAAKC,QACEC,EAAKF,MAqChB,CAAC,QA/BwB,CACzBR,UAAYxF,GAAUqF,EAASrF,IAAUoF,KAAepF,EACxD,SAAAyF,EAAUzF,MAAEA,IACR,IAAI4E,EAcJ,OAZIA,EADA5E,aAAiB1B,MACJ,CACT6H,SAAS,EACTnG,MAAO,CACH3E,QAAS2E,EAAM3E,QACf1C,KAAMqH,EAAMrH,KACZyN,MAAOpG,EAAMoG,QAKR,CAAED,SAAS,EAAOnG,SAE5B,CAAC4E,EAAY,GACxB,EACA,WAAAmB,CAAYnB,GACR,GAAIA,EAAWuB,QACX,MAAM3H,OAAO6H,OAAO,IAAI/H,MAAMsG,EAAW5E,MAAM3E,SAAUuJ,EAAW5E,OAExE,MAAM4E,EAAW5E,KACrB,MAoBJ,SAAS8F,EAAOJ,EAAKY,EAAK7G,WAAY8G,EAAiB,CAAC,MACpDD,EAAGjF,iBAAiB,UAAW,SAASkD,EAASiC,GAC7C,IAAKA,IAAOA,EAAGzF,KACX,OAEJ,IAhBR,SAAyBwF,EAAgBE,GACrC,IAAA,MAAWC,KAAiBH,EAAgB,CACxC,GAAIE,IAAWC,GAAmC,MAAlBA,EAC5B,OAAO,EAEX,GAAIA,aAAyBC,QAAUD,EAAcE,KAAKH,GACtD,OAAO,CAEf,CACA,OAAO,CACX,CAMaI,CAAgBN,EAAgBC,EAAGC,QAEpC,YADArI,QAAQ6F,KAAK,mBAAmBuC,EAAGC,6BAGvC,MAAM/N,GAAEA,EAAAyD,KAAIA,EAAA2K,KAAMA,GAAStI,OAAO6H,OAAO,CAAES,KAAM,IAAMN,EAAGzF,MACpDgG,GAAgBP,EAAGzF,KAAKgG,cAAgB,IAAIjD,IAAIkD,GACtD,IAAIC,EACJ,IACI,MAAMnN,EAASgN,EAAKzC,MAAM,GAAG,GAAI6C,OAAO,CAACxB,EAAKyB,IAASzB,EAAIyB,GAAOzB,GAC5D0B,EAAWN,EAAKI,OAAO,CAACxB,EAAKyB,IAASzB,EAAIyB,GAAOzB,GACvD,OAAQvJ,GACJ,IAAK,MAEG8K,EAAcG,EAElB,MACJ,IAAK,MAEGtN,EAAOgN,EAAKzC,OAAM,GAAI,IAAM2C,EAAcR,EAAGzF,KAAKf,OAClDiH,GAAc,EAElB,MACJ,IAAK,QAEGA,EAAcG,EAASC,MAAMvN,EAAQiN,GAEzC,MACJ,IAAK,YAGGE,EA+LxB,SAAevB,GACX,OAAOlH,OAAO6H,OAAOX,EAAK,CAAEV,CAACA,IAAc,GAC/C,CAjMsCsC,CADA,IAAIF,KAAYL,IAGlC,MACJ,IAAK,WACD,CACI,MAAMpB,MAAEA,EAAAC,MAAOA,GAAU,IAAIC,eAC7BC,EAAOJ,EAAKE,GACZqB,EAoLxB,SAAkBvB,EAAK6B,GAEnB,OADAC,EAAcpG,IAAIsE,EAAK6B,GAChB7B,CACX,CAvLsC3C,CAAS4C,EAAO,CAACA,GACnC,CACA,MACJ,IAAK,UAEGsB,OAAc,EAElB,MACJ,QACI,OAEZ,OACOjH,GACHiH,EAAc,CAAEjH,QAAOoF,CAACA,GAAc,EAC1C,CACAhM,QAAQC,QAAQ4N,GACXQ,MAAOzH,IACD,CAAEA,QAAOoF,CAACA,GAAc,KAE9B7D,KAAM0F,IACP,MAAOS,EAAWC,GAAiBC,EAAYX,GAC/CX,EAAGlG,YAAY5B,OAAO6H,OAAO7H,OAAO6H,OAAO,CAAA,EAAIqB,GAAY,CAAEhP,OAAOiP,GACvD,YAATxL,IAEAmK,EAAGuB,oBAAoB,UAAWtD,GAClCuD,EAAcxB,GACVnB,KAAaO,GAAiC,mBAAnBA,EAAIP,IAC/BO,EAAIP,QAIXsC,MAAOpJ,IAER,MAAOqJ,EAAWC,GAAiBC,EAAY,CAC3C5H,MAAO,IAAI+H,UAAU,+BACrB3C,CAACA,GAAc,IAEnBkB,EAAGlG,YAAY5B,OAAO6H,OAAO7H,OAAO6H,OAAO,CAAA,EAAIqB,GAAY,CAAEhP,OAAOiP,IAE5E,GACIrB,EAAGL,OACHK,EAAGL,OAEX,CAIA,SAAS6B,EAAcE,IAHvB,SAAuBA,GACnB,MAAqC,gBAA9BA,EAASxP,YAAYG,IAChC,EAEQsP,CAAcD,IACdA,EAASE,OACjB,CACA,SAAShC,EAAKI,EAAI6B,GACd,MAAMC,qBAAuB1H,IAiB7B,OAhBA4F,EAAGjF,iBAAiB,UAAW,SAAuBmF,GAClD,MAAMzF,KAAEA,GAASyF,EACjB,IAAKzF,IAASA,EAAKrI,GACf,OAEJ,MAAM2P,EAAWD,EAAiBlH,IAAIH,EAAKrI,IAC3C,GAAK2P,EAGL,IACIA,EAAStH,EACb,CAAA,QAEIqH,EAAiB3G,OAAOV,EAAKrI,GACjC,CACJ,GACO4P,EAAYhC,EAAI8B,EAAkB,GAAID,EACjD,CACA,SAASI,EAAqBC,GAC1B,GAAIA,EACA,MAAM,IAAIlK,MAAM,6CAExB,CACA,SAASmK,EAAgBnC,GACrB,OAAOoC,EAAuBpC,iBAAI,IAAI5F,IAAO,CACzCvE,KAAM,YACPoF,KAAK,KACJuG,EAAcxB,IAEtB,CACA,MAAMqC,qBAAmBnI,QACnBoI,EAAkB,yBAA0BnJ,YAC9C,IAAIoJ,qBAAsBvC,IACtB,MAAMwC,GAAYH,EAAazH,IAAIoF,IAAO,GAAK,EAC/CqC,EAAavH,IAAIkF,EAAIwC,GACJ,IAAbA,GACAL,EAAgBnC,KAe5B,SAASgC,EAAYhC,EAAI8B,EAAkBtB,EAAO,GAAIqB,EAAS,WAAc,GACzE,IAAIY,GAAkB,EACtB,MAAMzB,EAAQ,IAAI7D,MAAM0E,EAAQ,CAC5B,GAAAjH,CAAI8H,EAAS7B,GAET,GADAoB,EAAqBQ,GACjB5B,IAASjC,EACT,MAAO,MAXvB,SAAyBoC,GACjBsB,GACAA,EAAgBK,WAAW3B,EAEnC,CAQoB4B,CAAgB5B,GAChBmB,EAAgBnC,GAChB8B,EAAiBe,QACjBJ,GAAkB,GAG1B,GAAa,SAAT5B,EAAiB,CACjB,GAAoB,IAAhBL,EAAKnI,OACL,MAAO,CAAE4C,KAAM,IAAM+F,GAEzB,MAAM8B,EAAIV,EAAuBpC,EAAI8B,EAAkB,CACnDjM,KAAM,MACN2K,KAAMA,EAAKhD,IAAKuF,GAAMA,EAAEC,cACzB/H,KAAKyF,GACR,OAAOoC,EAAE7H,KAAKgI,KAAKH,EACvB,CACA,OAAOd,EAAYhC,EAAI8B,EAAkB,IAAItB,EAAMK,GACvD,EACA,GAAA/F,CAAI4H,EAAS7B,EAAMC,GACfmB,EAAqBQ,GAGrB,MAAO/I,EAAO2H,GAAiBC,EAAYR,GAC3C,OAAOsB,EAAuBpC,EAAI8B,EAAkB,CAChDjM,KAAM,MACN2K,KAAM,IAAIA,EAAMK,GAAMrD,IAAKuF,GAAMA,EAAEC,YACnCtJ,SACD2H,GAAepG,KAAKyF,EAC3B,EACA,KAAAK,CAAM2B,EAASQ,EAAUC,GACrBlB,EAAqBQ,GACrB,MAAMW,EAAO5C,EAAKA,EAAKnI,OAAS,GAChC,GAAI+K,IAASzE,EACT,OAAOyD,EAAuBpC,EAAI8B,EAAkB,CAChDjM,KAAM,aACPoF,KAAKyF,GAGZ,GAAa,SAAT0C,EACA,OAAOpB,EAAYhC,EAAI8B,EAAkBtB,EAAKzC,MAAM,OAExD,MAAO0C,EAAcY,GAAiBgC,EAAiBF,GACvD,OAAOf,EAAuBpC,EAAI8B,EAAkB,CAChDjM,KAAM,QACN2K,KAAMA,EAAKhD,IAAKuF,GAAMA,EAAEC,YACxBvC,gBACDY,GAAepG,KAAKyF,EAC3B,EACA,SAAA4C,CAAUZ,EAASS,GACflB,EAAqBQ,GACrB,MAAOhC,EAAcY,GAAiBgC,EAAiBF,GACvD,OAAOf,EAAuBpC,EAAI8B,EAAkB,CAChDjM,KAAM,YACN2K,KAAMA,EAAKhD,IAAKuF,GAAMA,EAAEC,YACxBvC,gBACDY,GAAepG,KAAKyF,EAC3B,IAGJ,OA9EJ,SAAuBM,EAAOhB,GAC1B,MAAMwC,GAAYH,EAAazH,IAAIoF,IAAO,GAAK,EAC/CqC,EAAavH,IAAIkF,EAAIwC,GACjBF,GACAA,EAAgBiB,SAASvC,EAAOhB,EAAIgB,EAE5C,CAuEIwC,CAAcxC,EAAOhB,GACdgB,CACX,CAIA,SAASqC,EAAiB5C,GACtB,MAAMgD,EAAYhD,EAAajD,IAAI8D,GACnC,MAAO,CAACmC,EAAUjG,IAAKkG,GAAMA,EAAE,KALnBC,EAK+BF,EAAUjG,IAAKkG,GAAMA,EAAE,IAJ3D1K,MAAMqB,UAAUuJ,OAAO7C,MAAM,GAAI4C,KAD5C,IAAgBA,CAMhB,CACA,MAAMzC,qBAAoBhH,QAe1B,SAASoH,EAAY5H,GACjB,IAAA,MAAYrH,EAAMsK,KAAYsC,EAC1B,GAAItC,EAAQuC,UAAUxF,GAAQ,CAC1B,MAAOmK,EAAiBxC,GAAiB1E,EAAQwC,UAAUzF,GAC3D,MAAO,CACH,CACI7D,KAAM,UACNxD,OACAqH,MAAOmK,GAEXxC,EAER,CAEJ,MAAO,CACH,CACIxL,KAAM,MACN6D,SAEJwH,EAActG,IAAIlB,IAAU,GAEpC,CACA,SAASgH,EAAchH,GACnB,OAAQA,EAAM7D,MACV,IAAK,UACD,OAAOoJ,EAAiBrE,IAAIlB,EAAMrH,MAAMoN,YAAY/F,EAAMA,OAC9D,IAAK,MACD,OAAOA,EAAMA,MAEzB,CACA,SAAS0I,EAAuBpC,EAAI8B,EAAkBjO,EAAKoN,GACvD,OAAO,IAAInO,QAASC,IAChB,MAAMX,EASH,IAAI4G,MAAM,GACZ8K,KAAK,GACLtG,IAAI,IAAMuG,KAAKC,MAAMD,KAAKE,SAAWC,OAAOC,kBAAkBnB,SAAS,KACvEoB,KAAK,KAXNtC,EAAiBhH,IAAI1I,EAAIW,GACrBiN,EAAGL,OACHK,EAAGL,QAEPK,EAAGlG,YAAY5B,OAAO6H,OAAO,CAAE3N,MAAMyB,GAAMoN,IAEnD,CC7UO,MAAMoD,UAAsBpS,EAM/B,WAAAC,CAAYC,GACRmS,MAAMnS,GACNK,KAAK+R,QAAU/R,KAAKgS,WAAWrS,GAC/BK,KAAKiS,cAAgBjS,KAAKkS,WAAWvS,GACrCK,KAAKmS,iBAAmBxS,EAAQyS,eACpC,CASA,UAAAJ,CAAWrS,GACP,OAAI0S,oBACO,IAAIhL,OAAO,IAAAiL,IAAA,oDAAAvN,KAAoD,CAClE1B,KAAM,WAIH,IAAIgE,OAAO,IAAAiL,IAAA,iDAAAvN,KAAiD,CAC/D1B,KAAM,UAGlB,CAQA,UAAA6O,CAAWvS,GACP,IAAI4S,EACAF,qBACAE,EAAS/I,EAAWxJ,KAAK+R,SACzBQ,EAAOC,qBAAuBxS,KAAKyS,sBAAsBhC,KAAKzQ,MAE9DuS,EAAOG,oBAAsB9G,MAAO3D,IAChC,IAAK0K,EACD,MAAM,IAAInN,MAAM,mFAOpB,YALgC,IAA5BxF,KAAK4S,qBACL5S,KAAK4S,mBAAqB,IAAID,EAAuB,CACjDP,gBAAiBpS,KAAKmS,0BAGjBnS,KAAK4S,mBAAmBF,oBAAoBzK,MAI7DsK,EAASnF,EAAKpN,KAAK+R,SAEnB/R,KAAK+R,QAAQxJ,iBAAiB,UAAWmF,SACG,IAA7BA,GAAIzF,MAAM4K,gBAEjB7S,KAAKyS,sBAAsB/E,EAAGzF,KAAK4K,mBAI/C,MAAMC,EAAgB9S,KAAK+S,kBAAkBpT,GAI7C,OAHA4S,EACKS,WAAWF,GACXrK,KAAKzI,KAAKiT,OAAO1S,QAAQkQ,KAAKzQ,KAAKiT,SACjCV,CACX,CACA,iBAAAQ,CAAkBpT,GACd,MAAMuT,WAAEA,GAAevT,EACjBwT,EAAWD,EAAW3H,MAAM,EAAG2H,EAAWE,YAAY,KAAO,GAC7DC,EAAUC,EAAAA,WAAWC,aACrBC,EAAc,IAAK7T,EAAQ6T,aAAe,GAAK1N,EAAWC,SAC1D0N,IAAwB9T,EAAQ8T,oBACtC,MAAO,CACHJ,UACAH,aACAC,WACAlN,gBAAiBtG,EAAQsG,iBAAmBA,EAAgBF,QAC5DyN,cACAC,sBACA3T,SAAUE,KAAKF,SACf4T,WAAY/T,EAAQ+T,WACpBC,mBAAoBhU,EAAQgU,oBAAsB,CAAA,EAE1D,CAIA,OAAAzS,GACQlB,KAAKQ,aAGTR,KAAK+R,QAAQ6B,YACb5T,KAAK+R,QAAU,KACfD,MAAM5Q,UACV,CAIA,SAAIb,GACA,OAAOL,KAAKiT,OAAOY,OACvB,CAMA,qBAAApB,CAAsBpR,GAClB,GAAKA,EAAIgC,KAGT,OAAQhC,EAAIgC,MACR,IAAK,SAAU,CACX,MAAMyQ,EAASzS,EAAIyS,QAAU,CAAEjU,KAAM,SAAUkU,KAAM,IACrD/T,KAAKqC,OAAOyR,EAAQzS,EAAIP,cACxB,KACJ,CACA,IAAK,gBAAiB,CAClB,MAAMgT,EAASzS,EAAIO,SAAW,CAAEoS,OAAQ,GAAIC,UAAU,GACtDjU,KAAK+C,aAAa+Q,EAAQzS,EAAIP,cAC9B,KACJ,CACA,IAAK,eAAgB,CACjB,MAAMgT,EAASzS,EAAIyS,QAAU,CAAE7L,KAAM,CAAA,EAAInF,SAAU,CAAA,EAAIoR,UAAW,IAClElU,KAAK6C,YAAYiR,EAAQzS,EAAIP,cAC7B,KACJ,CACA,IAAK,sBAAuB,CACxB,MAAMgT,EAASzS,EAAIyS,QAAU,CAAE7L,KAAM,CAAA,EAAInF,SAAU,CAAA,EAAIoR,UAAW,IAClElU,KAAKkD,kBAAkB4Q,EAAQzS,EAAIP,cACnC,KACJ,CACA,IAAK,eAAgB,CACjB,MAAMgT,EAASzS,EAAIyS,QAAU,CAAEjN,MAAM,GACrC7G,KAAKmD,YAAY2Q,EAAQzS,EAAIP,cAC7B,KACJ,CACA,IAAK,iBAAkB,CACnB,MAAMgT,EAASzS,EAAIyS,QAAU,CACzB/P,gBAAiB,EACjBkE,KAAM,CAAA,EACNnF,SAAU,CAAA,GAEd9C,KAAKgD,qBAAqB8Q,EAAQzS,EAAIP,cACtC,KACJ,CACA,IAAK,gBAAiB,CAClB,MAAMgT,EAASzS,EAAIyS,QAAU,CAAEK,MAAO,GAAIC,OAAQ,GAAIC,UAAW,IACjErU,KAAKiD,oBAAoB6Q,EAAQzS,EAAIP,cACrC,KACJ,CACA,IAAK,WACL,IAAK,YACL,IAAK,aACDd,KAAKoD,WAAW/B,EAAIgC,KAAMhC,EAAIO,QAASP,EAAIyB,SAAUzB,EAAIiC,QAASjC,EAAIP,cAIlF,CAIA,uBAAM0C,GA0BF,MAzBgB,CACZ8Q,eAAgB,UAChBC,uBAAwB,QACxBC,cAAe,CACXC,gBAAiB,CACb5U,KAAM,SACNuF,QAAS,GAEbsP,eAAgB,MAChBC,SAAU,gBACV9U,KAAM,SACN+U,mBAAoB,SACpBC,eAAgB,WAChBzP,QAAS,OAEb0P,iBAAkB,MAClBpR,OAAQ,KACRqR,OAAQ,wDACRC,WAAY,CACR,CACIjB,KAAM,uBACNhP,IAAK,wBAKrB,CAMA,oBAAMX,CAAexC,SACX5B,KAAKK,MACX,MAAMwL,QAAe7L,KAAKiS,cAAcgD,QAAQrT,EAAS5B,KAAKgB,QAE9D,OADA6K,EAAO9H,gBAAkB/D,KAAKY,eACvBiL,CACX,CAMA,qBAAMvH,CAAgB1C,GAClB,aAAa5B,KAAKiS,cAAciD,SAAStT,EAAS5B,KAAKgB,OAC3D,CAQA,oBAAMwD,CAAe5C,GACjB,aAAa5B,KAAKiS,cAAckD,QAAQvT,EAAS5B,KAAKgB,OAC1D,CAQA,uBAAM0D,CAAkB9C,GACpB,aAAa5B,KAAKiS,cAAcmD,WAAWxT,EAAS5B,KAAKgB,OAC7D,CAQA,qBAAMqU,CAAgBzT,GAClB,aAAa5B,KAAKiS,cAAcqD,SAAS1T,EAAS5B,KAAKgB,OAC3D,CAMA,cAAMiB,CAASZ,GACX,aAAarB,KAAKiS,cAAchQ,SAASZ,EAAKrB,KAAKgB,OACvD,CAMA,aAAMkB,CAAQb,GACV,aAAarB,KAAKiS,cAAc/P,QAAQb,EAAKrB,KAAKgB,OACtD,CAMA,eAAMmB,CAAUd,GACZ,aAAarB,KAAKiS,cAAc9P,UAAUd,EAAKrB,KAAKgB,OACxD,CAMA,gBAAMW,CAAWC,GACb,aAAa5B,KAAKiS,cAActQ,WAAWC,EAAS5B,KAAKgB,OAC7D,CACAmR,iBACAS,mBACAb,QACAE,cACAgB,OAAS,IAAIsC","x_google_ignoreList":[2,3,4,5,6,7]}