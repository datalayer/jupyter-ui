import{j as e,a as t}from"./vendor-react-Bc3S_DuI.js";import{W as n,c as o,d as a,e as s,f as i,g as r,h as l,i as d,j as m,k as h,E as c,s as g,a as p,m as u,y,J as f}from"./JupyterReactTheme-CX3WbnDJ.js";import{C as w}from"./factory-BucVdXsD.js";import"./vendor-codemirror-OzOnFEf0.js";import{M as x}from"./index-49nYpSCp.js";import{g as j}from"./marked-BQg5Jj21.js";import{L as _,R as P}from"./Lumino-D6-gHQxh.js";class F extends n{constructor(e){super(),this.addClass("jp-RenderedPlotly"),this._mimeType=e.mimeType,this._img_el=document.createElement("img"),this._img_el.className="plot-img",this.node.appendChild(this._img_el),this._img_el.addEventListener("mouseenter",e=>{this.createGraph(this._model)})}renderModel(e){if(this.hasGraphElement())return Promise.resolve();this._model=e;const t=e.data["image/png"];return null!=t?(this.updateImage(t),Promise.resolve()):this.createGraph(e)}hasGraphElement(){return null!==this.node.querySelector(".plot-container")}updateImage(e){this.hideGraph(),this._img_el.src="data:image/png;base64,"+e,this.showImage()}hideGraph(){const e=this.node.querySelector(".plot-container");null!=e&&(e.style.display="none")}showGraph(){const e=this.node.querySelector(".plot-container");null!=e&&(e.style.display="block")}hideImage(){const e=this.node.querySelector(".plot-img");null!=e&&(e.style.display="none")}showImage(){const e=this.node.querySelector(".plot-img");null!=e&&(e.style.display="block")}createGraph(e){const{data:t,layout:n,frames:o,config:a}=e.data[this._mimeType];n.height||(n.height=360);return(async()=>(null===F.Plotly&&(F.Plotly=await import("./index-DaX7P5EI.js").then(e=>e.i),F._resolveLoadingPlotly()),F.loadingPlotly))().then(()=>F.Plotly.react(this.node,t,n,a)).then(t=>{this.showGraph(),this.hideImage(),this.update(),o&&F.Plotly.addFrames(this.node,o),this.node.offsetWidth>0&&this.node.offsetHeight>0&&F.Plotly.toImage(t,{format:"png",width:this.node.offsetWidth,height:this.node.offsetHeight}).then(t=>{const n=t.split(",")[1];e.data["image/png"]!==n&&e.setData({data:{...e.data,"image/png":n}})}),this.node.on("plotly_webglcontextlost",()=>{const t=e.data["image/png"];if(null!=t)return this.updateImage(t),Promise.resolve()})})}onAfterShow(e){this.update()}onResize(e){this.update()}onUpdateRequest(e){F.Plotly&&this.isVisible&&this.hasGraphElement()&&F.Plotly.redraw(this.node).then(()=>{F.Plotly.Plots.resize(this.node)})}_mimeType;_img_el;_model;static Plotly=null;static _resolveLoadingPlotly;static loadingPlotly=new Promise(e=>{F._resolveLoadingPlotly=e})}const b={safe:!0,mimeTypes:["application/vnd.plotly.v1+json"],defaultRank:10,createRenderer:e=>new F(e)},v=new u,E=new c;for(const R of c.getDefaultLanguages())E.addLanguage(R);E.addLanguage({name:"ipythongfm",mime:"text/x-ipythongfm",load:async()=>(await import("./vendor-codemirror-OzOnFEf0.js").then(e=>e.ap)).markdown({codeLanguages:e=>E.findBest(e)})});const I=new P({initialFactories:g.concat(b),latexTypesetter:new x,markdownParser:j(E)}),L=new w({extensions:(()=>{const e=new p;for(const t of p.getDefaultExtensions({themes:v}))e.addExtension(t);return e.addExtension({name:"shared-model-binding",factory:e=>{const t=e.model.sharedModel;return p.createImmutableExtension(y({ytext:t.ysource,undoManager:t.undoManager??void 0}))}}),e})(),languages:E}),S=t=>{const{cell:n,languageInfo:c}=t,g=n.id||o();switch(n.cell_type){case"code":{const t=new m({rendermime:I,model:new h({sharedModel:r(n)}),contentFactory:new s.ContentFactory({editorFactory:L.newInlineEditor.bind(L)})}).initializeState();return c&&c.mimetype&&(t.model.mimeType=c.mimetype),e.jsx(e.Fragment,{children:e.jsx(_,{id:g,children:t})})}case"markdown":{const t=new l({rendermime:I,showEditorForReadOnlyMarkdown:!1,model:new d({sharedModel:r(n)}),contentFactory:new s.ContentFactory({editorFactory:L.newInlineEditor.bind(L)})}).initializeState();return e.jsx(e.Fragment,{children:e.jsx(_,{id:g,children:t})})}case"raw":{const t=new a({model:new i({sharedModel:r(n)}),contentFactory:new s.ContentFactory({editorFactory:L.newInlineEditor.bind(L)})});return e.jsx(e.Fragment,{children:e.jsx(_,{id:g,children:t})})}default:return e.jsx(e.Fragment,{})}},G=n=>{const{nbformat:a,nbformatUrl:s}=n,[i,r]=t.useState();return t.useEffect(()=>{a&&r(a),s&&fetch(s).then(e=>e.text()).then(e=>{r(JSON.parse(e))})},[a,s]),e.jsx(e.Fragment,{children:i?.cells.map(t=>(t.metadata.editable=!1,e.jsx("div",{children:e.jsx(S,{cell:t,languageInfo:i.metadata.language_info})},t.id?.toString()||o())))})},k=({options:t})=>{const n="object"==typeof t.content?t.content:void 0;/* @__PURE__ */
return e.jsx("div",{style:{height:t.height||"auto"},children:/* @__PURE__ */e.jsx(G,{nbformat:n,nbformatUrl:t.url,outputs:!1!==t.outputs})})},M=({options:t})=>/* @__PURE__ */e.jsx(f,{children:/* @__PURE__ */e.jsx(k,{options:t})});export{M as ViewerChunk,M as default};
//# sourceMappingURL=ViewerChunk-D5jnxByL.js.map
