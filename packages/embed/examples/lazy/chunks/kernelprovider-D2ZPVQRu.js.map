{"version":3,"file":"kernelprovider-D2ZPVQRu.js","sources":["../../../../node_modules/@jupyterlab/ui-components/lib/hoverbox.js","../../../../node_modules/@jupyterlab/completer/lib/tokens.js","../../../../node_modules/@jupyterlab/completer/lib/handler.js","../../../../node_modules/@jupyterlab/completer/lib/model.js","../../../../node_modules/@jupyterlab/completer/lib/widget.js","../../../../node_modules/@jupyterlab/completer/lib/utils.js","../../../../node_modules/@jupyterlab/completer/lib/reconciliator.js","../../../../node_modules/@jupyterlab/completer/lib/default/kernelprovider.js"],"sourcesContent":["// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n/**\n * The class name added to all hover boxes.\n */\nconst HOVERBOX_CLASS = 'jp-HoverBox';\n/**\n * The z-index used to hide hovering node that is scrolled out of view.\n */\nconst OUTOFVIEW_Z_INDEX = '-1000';\n/**\n * A namespace for `HoverBox` members.\n */\nexport var HoverBox;\n(function (HoverBox) {\n    /**\n     * Set the visible dimensions of a hovering box anchored to an editor cursor.\n     *\n     * @param options - The hover box geometry calculation options.\n     */\n    function setGeometry(options) {\n        const { anchor, host, node, privilege, outOfViewDisplay } = options;\n        const hostRect = host.getBoundingClientRect();\n        // Add hover box class if it does not exist.\n        if (!node.classList.contains(HOVERBOX_CLASS)) {\n            node.classList.add(HOVERBOX_CLASS);\n        }\n        // Start with the node displayed as if it was in view.\n        if (node.style.visibility) {\n            node.style.visibility = '';\n        }\n        if (node.style.zIndex === '') {\n            node.style.zIndex = '';\n        }\n        // Clear any previously set max-height.\n        node.style.maxHeight = '';\n        // Clear any programmatically set margin-top.\n        node.style.marginTop = '';\n        const style = options.style || window.getComputedStyle(node);\n        const spaceAbove = anchor.top - hostRect.top;\n        const spaceBelow = hostRect.bottom - anchor.bottom;\n        const marginTop = parseInt(style.marginTop, 10) || 0;\n        const marginLeft = parseInt(style.marginLeft, 10) || 0;\n        const minHeight = parseInt(style.minHeight, 10) || options.minHeight;\n        let maxHeight = parseInt(style.maxHeight, 10) || options.maxHeight;\n        // Determine whether to render above or below; check privilege.\n        const renderBelow = privilege === 'forceAbove'\n            ? false\n            : privilege === 'forceBelow'\n                ? true\n                : privilege === 'above'\n                    ? spaceAbove < maxHeight && spaceAbove < spaceBelow\n                    : spaceBelow >= maxHeight || spaceBelow >= spaceAbove;\n        if (renderBelow) {\n            maxHeight = Math.min(spaceBelow - marginTop, maxHeight);\n        }\n        else {\n            maxHeight = Math.min(spaceAbove, maxHeight);\n            // If the box renders above the text, its top margin is irrelevant.\n            node.style.marginTop = '0px';\n        }\n        node.style.maxHeight = `${maxHeight}px`;\n        // Make sure the box ought to be visible.\n        const withinBounds = maxHeight >= minHeight &&\n            (spaceBelow >= minHeight || spaceAbove >= minHeight);\n        if (!withinBounds) {\n            node.style.zIndex = OUTOFVIEW_Z_INDEX;\n            node.style.visibility = 'hidden';\n            return;\n        }\n        if (options.size) {\n            node.style.width = `${options.size.width}px`;\n            node.style.height = `${options.size.height}px`;\n            node.style.contain = 'strict';\n        }\n        else {\n            node.style.contain = '';\n            node.style.width = 'auto';\n            node.style.height = '';\n        }\n        // Position the box vertically.\n        const initialHeight = options.size\n            ? options.size.height\n            : node.getBoundingClientRect().height;\n        const offsetAbove = (options.offset &&\n            options.offset.vertical &&\n            options.offset.vertical.above) ||\n            0;\n        const offsetBelow = (options.offset &&\n            options.offset.vertical &&\n            options.offset.vertical.below) ||\n            0;\n        let top = renderBelow\n            ? hostRect.bottom - spaceBelow + offsetBelow\n            : hostRect.top + spaceAbove - initialHeight + offsetAbove;\n        node.style.top = `${Math.floor(top)}px`;\n        // Position the box horizontally.\n        const offsetHorizontal = (options.offset && options.offset.horizontal) || 0;\n        let left = anchor.left + offsetHorizontal;\n        node.style.left = `${Math.ceil(left)}px`;\n        let rect = node.getBoundingClientRect();\n        // Move left to fit in the window.\n        let right = rect.right;\n        if (right > window.innerWidth) {\n            left -= right - window.innerWidth;\n            right = window.innerWidth;\n            node.style.left = `${Math.ceil(left)}px`;\n        }\n        // Move right to fit in the window\n        if (left < offsetHorizontal - marginLeft) {\n            left = offsetHorizontal - marginLeft;\n            node.style.left = `${Math.ceil(left)}px`;\n        }\n        // Hide the hover box before querying the DOM for the anchor coordinates.\n        // Using z-index set directly for performance.\n        node.style.zIndex = '-1000';\n        const bottom = rect.bottom;\n        const includesLeftTop = host.contains(document.elementFromPoint(left, top));\n        const includesRightTop = host.contains(document.elementFromPoint(right, top));\n        const includesRightBottom = host.contains(document.elementFromPoint(right, bottom));\n        const includesLeftBottom = host.contains(document.elementFromPoint(left, bottom));\n        node.style.zIndex = '';\n        const topEdgeInside = includesLeftTop || includesRightTop;\n        const bottomEdgeInside = includesLeftBottom || includesRightBottom;\n        const leftEdgeInside = includesLeftTop || includesLeftBottom;\n        const rightEdgeInside = includesRightBottom || includesRightTop;\n        const height = bottom - top;\n        const width = right - left;\n        const overTheTop = top < hostRect.top;\n        const belowTheBottom = bottom > hostRect.bottom;\n        const beforeTheLeft = left + marginLeft < hostRect.left;\n        const afterTheRight = right > hostRect.right;\n        let hide = false;\n        let leftChanged = false;\n        let topChanged = false;\n        if (overTheTop) {\n            switch ((outOfViewDisplay === null || outOfViewDisplay === void 0 ? void 0 : outOfViewDisplay.top) || 'hidden-inside') {\n                case 'hidden-inside':\n                    if (!topEdgeInside) {\n                        hide = true;\n                    }\n                    break;\n                case 'hidden-outside':\n                    if (!bottomEdgeInside) {\n                        hide = true;\n                    }\n                    break;\n                case 'stick-inside':\n                    if (hostRect.top > top) {\n                        top = hostRect.top;\n                        topChanged = true;\n                    }\n                    break;\n                case 'stick-outside':\n                    if (hostRect.top > bottom) {\n                        top = hostRect.top - height;\n                        topChanged = true;\n                    }\n                    break;\n            }\n        }\n        if (belowTheBottom) {\n            switch ((outOfViewDisplay === null || outOfViewDisplay === void 0 ? void 0 : outOfViewDisplay.bottom) || 'hidden-outside') {\n                case 'hidden-inside':\n                    if (!bottomEdgeInside) {\n                        hide = true;\n                    }\n                    break;\n                case 'hidden-outside':\n                    if (!topEdgeInside) {\n                        hide = true;\n                    }\n                    break;\n                case 'stick-inside':\n                    if (hostRect.bottom < bottom) {\n                        top = hostRect.bottom - height;\n                        topChanged = true;\n                    }\n                    break;\n                case 'stick-outside':\n                    if (hostRect.bottom < top) {\n                        top = hostRect.bottom;\n                        topChanged = true;\n                    }\n                    break;\n            }\n        }\n        if (beforeTheLeft) {\n            switch ((outOfViewDisplay === null || outOfViewDisplay === void 0 ? void 0 : outOfViewDisplay.left) || 'hidden-inside') {\n                case 'hidden-inside':\n                    if (!leftEdgeInside) {\n                        hide = true;\n                    }\n                    break;\n                case 'hidden-outside':\n                    if (!rightEdgeInside) {\n                        hide = true;\n                    }\n                    break;\n                case 'stick-inside':\n                    if (hostRect.left > left + marginLeft) {\n                        left = hostRect.left - marginLeft;\n                        leftChanged = true;\n                    }\n                    break;\n                case 'stick-outside':\n                    if (hostRect.left > right) {\n                        left = hostRect.left - marginLeft - width;\n                        leftChanged = true;\n                    }\n                    break;\n            }\n        }\n        if (afterTheRight) {\n            switch ((outOfViewDisplay === null || outOfViewDisplay === void 0 ? void 0 : outOfViewDisplay.right) || 'hidden-outside') {\n                case 'hidden-inside':\n                    if (!rightEdgeInside) {\n                        hide = true;\n                    }\n                    break;\n                case 'hidden-outside':\n                    if (!leftEdgeInside) {\n                        hide = true;\n                    }\n                    break;\n                case 'stick-inside':\n                    if (hostRect.right < right) {\n                        left = hostRect.right - width;\n                        leftChanged = true;\n                    }\n                    break;\n                case 'stick-outside':\n                    if (hostRect.right < left) {\n                        left = hostRect.right;\n                        leftChanged = true;\n                    }\n                    break;\n            }\n        }\n        if (hide) {\n            node.style.zIndex = OUTOFVIEW_Z_INDEX;\n            node.style.visibility = 'hidden';\n        }\n        if (leftChanged) {\n            node.style.left = `${Math.ceil(left)}px`;\n        }\n        if (topChanged) {\n            node.style.top = `${Math.ceil(top)}px`;\n        }\n    }\n    HoverBox.setGeometry = setGeometry;\n})(HoverBox || (HoverBox = {}));\n//# sourceMappingURL=hoverbox.js.map","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\nimport { Token } from '@lumino/coreutils';\n/**\n * The type of completion request.\n */\nexport var CompletionTriggerKind;\n(function (CompletionTriggerKind) {\n    CompletionTriggerKind[CompletionTriggerKind[\"Invoked\"] = 1] = \"Invoked\";\n    CompletionTriggerKind[CompletionTriggerKind[\"TriggerCharacter\"] = 2] = \"TriggerCharacter\";\n    CompletionTriggerKind[CompletionTriggerKind[\"TriggerForIncompleteCompletions\"] = 3] = \"TriggerForIncompleteCompletions\";\n})(CompletionTriggerKind || (CompletionTriggerKind = {}));\n/**\n * Describes how an inline completion provider was triggered.\n * @alpha\n */\nexport var InlineCompletionTriggerKind;\n(function (InlineCompletionTriggerKind) {\n    /**\n     * Completion was triggered explicitly by a user gesture.\n     * Return multiple completion items to enable cycling through them.\n     */\n    InlineCompletionTriggerKind[InlineCompletionTriggerKind[\"Invoke\"] = 0] = \"Invoke\";\n    /**\n     * Completion was triggered automatically while editing.\n     * It is sufficient to return a single completion item in this case.\n     */\n    InlineCompletionTriggerKind[InlineCompletionTriggerKind[\"Automatic\"] = 1] = \"Automatic\";\n})(InlineCompletionTriggerKind || (InlineCompletionTriggerKind = {}));\n/**\n * Token allowing to override (or disable) inline completer widget factory.\n */\nexport const IInlineCompleterFactory = new Token('@jupyterlab/completer:IInlineCompleterFactory', 'A factory of inline completer widgets.');\n/**\n * The exported token used to register new provider.\n */\nexport const ICompletionProviderManager = new Token('@jupyterlab/completer:ICompletionProviderManager', 'A service for the completion providers management.');\n//# sourceMappingURL=tokens.js.map","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\nimport { COMPLETER_ACTIVE_CLASS, COMPLETER_ENABLED_CLASS, COMPLETER_LINE_BEGINNING_CLASS } from '@jupyterlab/codeeditor';\nimport { Text } from '@jupyterlab/coreutils';\nimport { Message, MessageLoop } from '@lumino/messaging';\nimport { Signal } from '@lumino/signaling';\nimport { CompletionTriggerKind, InlineCompletionTriggerKind } from './tokens';\n/**\n * A completion handler for editors.\n */\nexport class CompletionHandler {\n    /**\n     * Construct a new completion handler for a widget.\n     */\n    constructor(options) {\n        this._fetchingInline = 0;\n        this._editor = null;\n        this._enabled = false;\n        this._isDisposed = false;\n        this._autoCompletion = false;\n        this._continuousInline = true;\n        this._tabCompleterActive = false;\n        this.completer = options.completer;\n        this.inlineCompleter = options.inlineCompleter;\n        this.completer.selected.connect(this.onCompletionSelected, this);\n        this.completer.visibilityChanged.connect(this.onVisibilityChanged, this);\n        this._reconciliator = options.reconciliator;\n    }\n    set reconciliator(reconciliator) {\n        this._reconciliator = reconciliator;\n    }\n    /**\n     * The editor used by the completion handler.\n     */\n    get editor() {\n        return this._editor;\n    }\n    set editor(newValue) {\n        if (newValue === this._editor) {\n            return;\n        }\n        let editor = this._editor;\n        // Clean up and disconnect from old editor.\n        if (editor && !editor.isDisposed) {\n            const model = editor.model;\n            editor.host.classList.remove(COMPLETER_ENABLED_CLASS);\n            editor.host.classList.remove(COMPLETER_ACTIVE_CLASS);\n            model.selections.changed.disconnect(this.onSelectionsChanged, this);\n            model.sharedModel.changed.disconnect(this._onSharedModelChanged, this);\n        }\n        // Reset completer state.\n        this.completer.reset();\n        this.completer.editor = newValue;\n        // Update the editor and signal connections.\n        editor = this._editor = newValue;\n        if (editor) {\n            const model = editor.model;\n            this._enabled = false;\n            model.selections.changed.connect(this.onSelectionsChanged, this);\n            // We expect the model to be an editor, a file editor, or a cell.\n            const sharedModel = model.sharedModel;\n            // For cells and files the `changed` signal is not limited to text,\n            // but also fires on changes to metadata, outputs, execution count,\n            // and state changes, hence we need to filter the change type.\n            sharedModel.changed.connect(this._onSharedModelChanged, this);\n            // On initial load, manually check the cursor position.\n            this.onSelectionsChanged();\n            if (this.inlineCompleter) {\n                this.inlineCompleter.editor = editor;\n            }\n        }\n    }\n    /**\n     * Get whether the completion handler is disposed.\n     */\n    get isDisposed() {\n        return this._isDisposed;\n    }\n    /**\n     * Enable/disable continuous hinting mode.\n     */\n    set autoCompletion(value) {\n        this._autoCompletion = value;\n    }\n    get autoCompletion() {\n        return this._autoCompletion;\n    }\n    /**\n     * Dispose of the resources used by the handler.\n     */\n    dispose() {\n        if (this.isDisposed) {\n            return;\n        }\n        this._isDisposed = true;\n        Signal.clearData(this);\n    }\n    /**\n     * Invoke the inline completer on explicit user request.\n     */\n    invokeInline() {\n        const editor = this._editor;\n        if (editor) {\n            this._makeInlineRequest(editor.getCursorPosition(), InlineCompletionTriggerKind.Invoke).catch(reason => {\n                console.warn('Inline invoke request bailed', reason);\n            });\n        }\n    }\n    /**\n     * Invoke the handler and launch a completer.\n     */\n    invoke() {\n        MessageLoop.sendMessage(this, CompletionHandler.Msg.InvokeRequest);\n    }\n    /**\n     * Process a message sent to the completion handler.\n     */\n    processMessage(msg) {\n        switch (msg.type) {\n            case CompletionHandler.Msg.InvokeRequest.type:\n                this.onInvokeRequest(msg);\n                break;\n            default:\n                break;\n        }\n    }\n    /**\n     * Get the state of the text editor at the given position.\n     */\n    getState(editor, position) {\n        return {\n            text: editor.model.sharedModel.getSource(),\n            line: position.line,\n            column: position.column\n        };\n    }\n    /**\n     * Handle a completion selected signal from the completion widget.\n     */\n    onCompletionSelected(completer, val) {\n        const model = completer.model;\n        const editor = this._editor;\n        if (!editor || !model) {\n            return;\n        }\n        const patch = model.createPatch(val);\n        if (!patch) {\n            return;\n        }\n        const { start, end, value } = patch;\n        const cursorBeforeChange = editor.getOffsetAt(editor.getCursorPosition());\n        // Update the document and the cursor position in the same transaction\n        // to ensure consistency in listeners to document changes.\n        // Note: it also ensures a single change is stored by the undo manager.\n        const transactions = {\n            changes: { from: start, to: end, insert: value }\n        };\n        if (cursorBeforeChange <= end && cursorBeforeChange >= start) {\n            transactions.selection = { anchor: start + value.length };\n        }\n        editor.editor.dispatch(transactions);\n    }\n    /**\n     * Handle `invoke-request` messages.\n     */\n    onInvokeRequest(msg) {\n        // If there is no completer model, bail.\n        if (!this.completer.model) {\n            return;\n        }\n        // If a completer session is already active, bail.\n        if (this.completer.model.original) {\n            return;\n        }\n        const editor = this._editor;\n        if (editor) {\n            this._makeRequest(editor.getCursorPosition(), CompletionTriggerKind.Invoked).catch(reason => {\n                console.warn('Invoke request bailed', reason);\n            });\n        }\n    }\n    /**\n     * Handle selection changed signal from an editor.\n     *\n     * #### Notes\n     * If a sub-class reimplements this method, then that class must either call\n     * its super method or it must take responsibility for adding and removing\n     * the completer completable class to the editor host node.\n     *\n     * Despite the fact that the editor widget adds a class whenever there is a\n     * primary selection, this method checks independently for two reasons:\n     *\n     * 1. The editor widget connects to the same signal to add that class, so\n     *    there is no guarantee that the class will be added before this method\n     *    is invoked so simply checking for the CSS class's existence is not an\n     *    option. Secondarily, checking the editor state should be faster than\n     *    querying the DOM in either case.\n     * 2. Because this method adds a class that indicates whether completer\n     *    functionality ought to be enabled, relying on the behavior of the\n     *    `jp-mod-has-primary-selection` to filter out any editors that have\n     *    a selection means the semantic meaning of `jp-mod-completer-enabled`\n     *    is obscured because there may be cases where the enabled class is added\n     *    even though the completer is not available.\n     */\n    onSelectionsChanged() {\n        var _a;\n        const model = this.completer.model;\n        const editor = this._editor;\n        if (!editor) {\n            return;\n        }\n        const inlineModel = (_a = this.inlineCompleter) === null || _a === void 0 ? void 0 : _a.model;\n        if (inlineModel) {\n            // Dispatch selection change.\n            inlineModel.handleSelectionChange(editor.getSelection());\n        }\n        const host = editor.host;\n        // If there is no model, return.\n        if (!model) {\n            this._enabled = false;\n            host.classList.remove(COMPLETER_ENABLED_CLASS);\n            return;\n        }\n        // If we are currently performing a subset match,\n        // return without resetting the completer.\n        if (model.subsetMatch) {\n            return;\n        }\n        const position = editor.getCursorPosition();\n        const line = editor.getLine(position.line);\n        const { start, end } = editor.getSelection();\n        // If there is a text selection, return.\n        if (start.column !== end.column || start.line !== end.line) {\n            this._enabled = false;\n            model.reset(true);\n            host.classList.remove(COMPLETER_ENABLED_CLASS);\n            return;\n        }\n        // If line is empty or the cursor doesn't have any characters before\n        // it besides whitespace, add line beginning class\n        // so that completer can stay enabled, but tab\n        // in codemirror can still be triggered.\n        if (!line || end.column === 0) {\n            host.classList.add(COMPLETER_LINE_BEGINNING_CLASS);\n        }\n        else if (line && line.slice(0, position.column).match(/^\\s*$/)) {\n            host.classList.add(COMPLETER_LINE_BEGINNING_CLASS);\n        }\n        else {\n            host.classList.remove(COMPLETER_LINE_BEGINNING_CLASS);\n        }\n        // Enable completion.\n        if (!this._enabled) {\n            this._enabled = true;\n            host.classList.add(COMPLETER_ENABLED_CLASS);\n        }\n        // Dispatch the cursor change.\n        model.handleCursorChange(this.getState(editor, editor.getCursorPosition()));\n    }\n    /**\n     * Handle a text changed signal from an editor.\n     */\n    async onTextChanged(str, changed) {\n        var _a;\n        if (!this._enabled) {\n            return;\n        }\n        const model = this.completer.model;\n        const editor = this.editor;\n        if (!editor) {\n            return;\n        }\n        if (model &&\n            this._autoCompletion &&\n            this._reconciliator.shouldShowContinuousHint &&\n            (await this._reconciliator.shouldShowContinuousHint(this.completer.isVisible, changed))) {\n            void this._makeRequest(editor.getCursorPosition(), CompletionTriggerKind.TriggerCharacter);\n        }\n        const inlineModel = (_a = this.inlineCompleter) === null || _a === void 0 ? void 0 : _a.model;\n        if (inlineModel) {\n            // Dispatch the text change to inline completer\n            // (this happens before request is sent)\n            inlineModel.handleTextChange(changed);\n            if (this._continuousInline) {\n                void this._makeInlineRequest(editor.getCursorPosition(), InlineCompletionTriggerKind.Automatic);\n            }\n        }\n        if (model) {\n            // If there is a text selection, no completion is allowed.\n            const { start, end } = editor.getSelection();\n            if (start.column !== end.column || start.line !== end.line) {\n                return;\n            }\n            // Dispatch the text change.\n            model.handleTextChange(this.getState(editor, editor.getCursorPosition()));\n        }\n    }\n    /**\n     * Handle a visibility change signal from a completer widget.\n     */\n    onVisibilityChanged(completer) {\n        var _a;\n        // Completer is not active.\n        if (completer.isDisposed || completer.isHidden) {\n            this._tabCompleterActive = false;\n            if (this._editor) {\n                this._editor.host.classList.remove(COMPLETER_ACTIVE_CLASS);\n                this._editor.focus();\n            }\n            return;\n        }\n        // Completer is active.\n        this._tabCompleterActive = true;\n        (_a = this._editor) === null || _a === void 0 ? void 0 : _a.host.classList.add(COMPLETER_ACTIVE_CLASS);\n    }\n    /**\n     * Handle a text shared model change signal from an editor.\n     */\n    async _onSharedModelChanged(str, changed) {\n        if (changed.sourceChange) {\n            await this.onTextChanged(str, changed);\n        }\n    }\n    /**\n     * Make a completion request.\n     */\n    _makeRequest(position, trigger) {\n        const editor = this.editor;\n        if (!editor) {\n            return Promise.reject(new Error('No active editor'));\n        }\n        const request = this._composeRequest(editor, position);\n        const state = this.getState(editor, position);\n        return this._reconciliator\n            .fetch(request, trigger)\n            .then(reply => {\n            var _a;\n            if (!reply) {\n                return;\n            }\n            const model = this._updateModel(state, reply.start, reply.end);\n            if (!model) {\n                return;\n            }\n            if (this.completer.suppressIfInlineCompleterActive &&\n                ((_a = this.inlineCompleter) === null || _a === void 0 ? void 0 : _a.isActive)) {\n                return;\n            }\n            if (model.setCompletionItems) {\n                model.setCompletionItems(reply.items);\n            }\n        })\n            .catch(p => {\n            /* Fails silently. */\n        });\n    }\n    async _makeInlineRequest(position, trigger) {\n        const editor = this.editor;\n        if (!editor) {\n            return Promise.reject(new Error('No active editor'));\n        }\n        if (!this.inlineCompleter) {\n            return Promise.reject(new Error('No inline completer'));\n        }\n        const line = editor.getLine(position.line);\n        if (trigger === InlineCompletionTriggerKind.Automatic &&\n            (typeof line === 'undefined' ||\n                line.slice(0, position.column).match(/^\\s*$/))) {\n            // In Automatic mode we only auto-trigger on the end of line (and not on the beginning).\n            // Increase the counter to avoid out-of date replies when pressing Backspace quickly.\n            this._fetchingInline += 1;\n            return;\n        }\n        let isMiddleOfLine = false;\n        if (typeof line !== 'undefined' && position.column < line.length) {\n            isMiddleOfLine = true;\n        }\n        const request = this._composeRequest(editor, position);\n        const model = this.inlineCompleter.model;\n        if (!model) {\n            return;\n        }\n        model.cursor = position;\n        const current = ++this._fetchingInline;\n        const promises = this._reconciliator.fetchInline(request, trigger, isMiddleOfLine);\n        let cancelled = false;\n        const completed = new Set();\n        for (const promise of promises) {\n            promise\n                .then(result => {\n                var _a;\n                if (cancelled || !result || !result.items) {\n                    return;\n                }\n                if (current !== this._fetchingInline) {\n                    return;\n                }\n                completed.add(promise);\n                if (completed.size === 1) {\n                    if (((_a = this.inlineCompleter) === null || _a === void 0 ? void 0 : _a.suppressIfTabCompleterActive) &&\n                        this._tabCompleterActive) {\n                        cancelled = true;\n                        return;\n                    }\n                    model.setCompletions(result);\n                }\n                else {\n                    model.appendCompletions(result);\n                }\n            })\n                .catch(e => {\n                // Emit warning for debugging.\n                console.warn(e);\n            })\n                .finally(() => {\n                // Mark the provider promise as completed.\n                completed.add(promise);\n                // Let the model know that we are awaiting for fewer providers now.\n                const remaining = promises.length - completed.size;\n                model.notifyProgress({\n                    pendingProviders: remaining,\n                    totalProviders: promises.length\n                });\n            });\n        }\n    }\n    _composeRequest(editor, position) {\n        const text = editor.model.sharedModel.getSource();\n        const mimeType = editor.model.mimeType;\n        const offset = Text.jsIndexToCharIndex(editor.getOffsetAt(position), text);\n        return { text, offset, mimeType };\n    }\n    /**\n     * Updates model with text state and current cursor position.\n     */\n    _updateModel(state, start, end) {\n        const model = this.completer.model;\n        const text = state.text;\n        if (!model) {\n            return null;\n        }\n        // Update the original request.\n        model.original = state;\n        // Update the cursor.\n        model.cursor = {\n            start: Text.charIndexToJsIndex(start, text),\n            end: Text.charIndexToJsIndex(end, text)\n        };\n        return model;\n    }\n}\n/**\n * A namespace for cell completion handler statics.\n */\n(function (CompletionHandler) {\n    /**\n     * Stream event type.\n     */\n    let StraemEvent;\n    (function (StraemEvent) {\n        StraemEvent[StraemEvent[\"opened\"] = 0] = \"opened\";\n        StraemEvent[StraemEvent[\"update\"] = 1] = \"update\";\n        StraemEvent[StraemEvent[\"closed\"] = 2] = \"closed\";\n    })(StraemEvent = CompletionHandler.StraemEvent || (CompletionHandler.StraemEvent = {}));\n    /**\n     * A namespace for completion handler messages.\n     */\n    let Msg;\n    (function (Msg) {\n        /**\n         * A singleton `'invoke-request'` message.\n         */\n        Msg.InvokeRequest = new Message('invoke-request');\n    })(Msg = CompletionHandler.Msg || (CompletionHandler.Msg = {}));\n})(CompletionHandler || (CompletionHandler = {}));\n//# sourceMappingURL=handler.js.map","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\nimport { StringExt } from '@lumino/algorithm';\nimport { JSONExt } from '@lumino/coreutils';\nimport { Signal } from '@lumino/signaling';\n/**\n * Escape HTML by native means of the browser.\n */\nfunction escapeHTML(text) {\n    const node = document.createElement('span');\n    node.textContent = text;\n    return node.innerHTML;\n}\n/**\n * An implementation of a completer model.\n */\nexport class CompleterModel {\n    constructor() {\n        this.processedItemsCache = null;\n        this._current = null;\n        this._cursor = null;\n        this._isDisposed = false;\n        this._completionItems = [];\n        this._original = null;\n        this._query = '';\n        this._subsetMatch = false;\n        this._typeMap = {};\n        this._orderedTypes = [];\n        this._stateChanged = new Signal(this);\n        this._queryChanged = new Signal(this);\n        /**\n         * The weak map between a processed completion item with the original item.\n         * It's used to keep track of original completion item in case of displaying\n         * the completer with query.\n         */\n        this._processedToOriginalItem = null;\n        /**\n         * A counter to cancel ongoing `resolveItem` call.\n         */\n        this._resolvingItem = 0;\n    }\n    /**\n     * A signal emitted when state of the completer menu changes.\n     */\n    get stateChanged() {\n        return this._stateChanged;\n    }\n    /**\n     * A signal emitted when query string changes (at invocation, or as user types).\n     */\n    get queryChanged() {\n        return this._queryChanged;\n    }\n    /**\n     * The original completion request details.\n     */\n    get original() {\n        return this._original;\n    }\n    set original(newValue) {\n        const unchanged = this._original === newValue ||\n            (this._original &&\n                newValue &&\n                JSONExt.deepEqual(newValue, this._original));\n        if (unchanged) {\n            return;\n        }\n        this._reset();\n        // Set both the current and original to the same value when original is set.\n        this._current = this._original = newValue;\n        this._stateChanged.emit(undefined);\n    }\n    /**\n     * The current text change details.\n     */\n    get current() {\n        return this._current;\n    }\n    set current(newValue) {\n        const unchanged = this._current === newValue ||\n            (this._current && newValue && JSONExt.deepEqual(newValue, this._current));\n        if (unchanged) {\n            return;\n        }\n        const original = this._original;\n        // Original request must always be set before a text change. If it isn't\n        // the model fails silently.\n        if (!original) {\n            return;\n        }\n        const cursor = this._cursor;\n        // Cursor must always be set before a text change. This happens\n        // automatically in the completer handler, but since `current` is a public\n        // attribute, this defensive check is necessary.\n        if (!cursor) {\n            return;\n        }\n        const current = (this._current = newValue);\n        if (!current) {\n            this._stateChanged.emit(undefined);\n            return;\n        }\n        const originalLine = original.text.split('\\n')[original.line];\n        const currentLine = current.text.split('\\n')[current.line];\n        // If the text change means that the original start point has been preceded,\n        // then the completion is no longer valid and should be reset.\n        if (!this._subsetMatch && currentLine.length < originalLine.length) {\n            this.reset(true);\n            return;\n        }\n        const { start, end } = cursor;\n        // Clip the front of the current line.\n        let query = current.text.substring(start);\n        // Clip the back of the current line by calculating the end of the original.\n        const ending = original.text.substring(end);\n        query = query.substring(0, query.lastIndexOf(ending));\n        this._query = query;\n        this.processedItemsCache = null;\n        this._processedToOriginalItem = null;\n        this._queryChanged.emit({ newValue: this._query, origin: 'editorUpdate' });\n        this._stateChanged.emit(undefined);\n    }\n    /**\n     * The cursor details that the API has used to return matching options.\n     */\n    get cursor() {\n        return this._cursor;\n    }\n    set cursor(newValue) {\n        // Original request must always be set before a cursor change. If it isn't\n        // the model fails silently.\n        if (!this.original) {\n            return;\n        }\n        this._cursor = newValue;\n    }\n    /**\n     * The query against which items are filtered.\n     */\n    get query() {\n        return this._query;\n    }\n    set query(newValue) {\n        this._query = newValue;\n        this.processedItemsCache = null;\n        this._processedToOriginalItem = null;\n        this._queryChanged.emit({ newValue: this._query, origin: 'setter' });\n    }\n    /**\n     * A flag that is true when the model value was modified by a subset match.\n     */\n    get subsetMatch() {\n        return this._subsetMatch;\n    }\n    set subsetMatch(newValue) {\n        this._subsetMatch = newValue;\n    }\n    /**\n     * Get whether the model is disposed.\n     */\n    get isDisposed() {\n        return this._isDisposed;\n    }\n    /**\n     * Dispose of the resources held by the model.\n     */\n    dispose() {\n        // Do nothing if already disposed.\n        if (this._isDisposed) {\n            return;\n        }\n        this._isDisposed = true;\n        Signal.clearData(this);\n    }\n    /**\n     * The list of visible items in the completer menu.\n     *\n     * #### Notes\n     * This is a read-only property.\n     * When overriding it is recommended to cache results in `processedItemsCache`\n     * property which will be automatically nullified when needed.\n     */\n    completionItems() {\n        if (!this.processedItemsCache) {\n            let query = this._query;\n            if (query) {\n                const markedItems = this._markup(query);\n                this.processedItemsCache = markedItems.map(it => it.processedItem);\n                this._processedToOriginalItem = new WeakMap(markedItems.map(it => [it.processedItem, it.originalItem]));\n            }\n            else {\n                this.processedItemsCache = this._completionItems.map(item => {\n                    return this._escapeItemLabel(item);\n                });\n                this._processedToOriginalItem = null;\n            }\n        }\n        return this.processedItemsCache;\n    }\n    /**\n     * Set the list of visible items in the completer menu, and append any\n     * new types to KNOWN_TYPES.\n     */\n    setCompletionItems(newValue) {\n        if (JSONExt.deepEqual(newValue, this._completionItems)) {\n            return;\n        }\n        this._completionItems = newValue;\n        this._orderedTypes = Private.findOrderedCompletionItemTypes(this._completionItems);\n        this.processedItemsCache = null;\n        this._processedToOriginalItem = null;\n        this._stateChanged.emit(undefined);\n    }\n    /**\n     * The map from identifiers (a.b) to types (function, module, class, instance,\n     * etc.).\n     *\n     * #### Notes\n     * A type map is currently only provided by the latest IPython kernel using\n     * the completer reply metadata field `_jupyter_types_experimental`. The\n     * values are completely up to the kernel.\n     *\n     */\n    typeMap() {\n        return this._typeMap;\n    }\n    /**\n     * An ordered list of all the known types in the typeMap.\n     *\n     * #### Notes\n     * To visually encode the types of the completer matches, we assemble an\n     * ordered list. This list begins with:\n     * ```\n     * ['function', 'instance', 'class', 'module', 'keyword']\n     * ```\n     * and then has any remaining types listed alphabetically. This will give\n     * reliable visual encoding for these known types, but allow kernels to\n     * provide new types.\n     */\n    orderedTypes() {\n        return this._orderedTypes;\n    }\n    /**\n     * Handle a cursor change.\n     */\n    handleCursorChange(change) {\n        // If there is no active completion, return.\n        if (!this._original) {\n            return;\n        }\n        const { column, line } = change;\n        const { current, original } = this;\n        if (!original) {\n            return;\n        }\n        // If a cursor change results in a the cursor being on a different line\n        // than the original request, cancel.\n        if (line !== original.line) {\n            this.reset(true);\n            return;\n        }\n        // If a cursor change results in the cursor being set to a position that\n        // precedes the original column, cancel.\n        if (column < original.column) {\n            this.reset(true);\n            return;\n        }\n        const { cursor } = this;\n        if (!cursor || !current) {\n            return;\n        }\n        // If a cursor change results in the cursor being set to a position beyond\n        // the end of the area that would be affected by completion, cancel.\n        const cursorDelta = cursor.end - cursor.start;\n        const originalLine = original.text.split('\\n')[original.line];\n        const currentLine = current.text.split('\\n')[current.line];\n        const inputDelta = currentLine.length - originalLine.length;\n        if (column > original.column + cursorDelta + inputDelta) {\n            this.reset(true);\n            return;\n        }\n    }\n    /**\n     * Handle a text change.\n     */\n    handleTextChange(change) {\n        const original = this._original;\n        // If there is no active completion, return.\n        if (!original) {\n            return;\n        }\n        const { text, column, line } = change;\n        const last = text.split('\\n')[line][column - 1];\n        // If last character entered is not whitespace or if the change column is\n        // greater than or equal to the original column, update completion.\n        if ((last && last.match(/\\S/)) || change.column >= original.column) {\n            this.current = change;\n            return;\n        }\n        // If final character is whitespace, reset completion.\n        this.reset(false);\n    }\n    /**\n     * Create a resolved patch between the original state and a patch string.\n     *\n     * @param patch - The patch string to apply to the original value.\n     *\n     * @returns A patched text change or undefined if original value did not exist.\n     */\n    createPatch(patch) {\n        const original = this._original;\n        const cursor = this._cursor;\n        const current = this._current;\n        if (!original || !cursor || !current) {\n            return undefined;\n        }\n        let { start, end } = cursor;\n        // Also include any filtering/additional-typing that has occurred\n        // since the completion request in the patched length.\n        end = end + (current.text.length - original.text.length);\n        return { start, end, value: patch };\n    }\n    /**\n     * Reset the state of the model and emit a state change signal.\n     *\n     * @param hard - Reset even if a subset match is in progress.\n     */\n    reset(hard = false) {\n        // When the completer detects a common subset prefix for all options,\n        // it updates the model and sets the model source to that value, triggering\n        // a reset. Unless explicitly a hard reset, this should be ignored.\n        if (!hard && this._subsetMatch) {\n            return;\n        }\n        this._reset();\n        this._stateChanged.emit(undefined);\n    }\n    /**\n     * Check if CompletionItem matches against query.\n     * Highlight matching prefix by adding <mark> tags.\n     */\n    _markup(query) {\n        var _a;\n        const items = this._completionItems;\n        let results = [];\n        for (const originalItem of items) {\n            // See if label matches query string\n            // With ICompletionItems, the label may include parameters,\n            // so we exclude them from the matcher.\n            // e.g. Given label `foo(b, a, r)` and query `bar`,\n            // don't count parameters, `b`, `a`, and `r` as matches.\n            const index = originalItem.label.indexOf('(');\n            const text = index > -1\n                ? originalItem.label.substring(0, index)\n                : originalItem.label;\n            const match = StringExt.matchSumOfSquares(escapeHTML(text), query);\n            // Filter non-matching items.\n            if (match) {\n                // Highlight label text if there's a match\n                let marked = StringExt.highlight(escapeHTML(originalItem.label), match.indices, Private.mark);\n                // Use `Object.assign` to evaluate getters.\n                const highlightedItem = Object.assign({}, originalItem);\n                highlightedItem.label = marked.join('');\n                highlightedItem.insertText =\n                    (_a = originalItem.insertText) !== null && _a !== void 0 ? _a : originalItem.label;\n                results.push({\n                    item: highlightedItem,\n                    score: match.score,\n                    originalItem\n                });\n            }\n        }\n        results.sort(Private.scoreCmp);\n        // Extract only the item (dropping the extra score attribute to not leak\n        // implementation details to JavaScript callers.\n        return results.map(match => ({\n            processedItem: match.item,\n            originalItem: match.originalItem\n        }));\n    }\n    /**\n     * Lazy load missing data of an item.\n     * @param indexOrValue - the item or its index\n     * @remarks\n     * Resolving item by index will be deprecated in\n     * the JupyterLab 5.0 and removed in JupyterLab 6.0.\n     *\n     * @return Return `undefined` if the completion item with `activeIndex` index can not be found.\n     *  Return a promise of `null` if another `resolveItem` is called. Otherwise return the\n     * promise of resolved completion item.\n     */\n    resolveItem(indexOrValue) {\n        let processedItem;\n        if (typeof indexOrValue === 'number') {\n            const completionItems = this.completionItems();\n            if (!completionItems || !completionItems[indexOrValue]) {\n                return undefined;\n            }\n            processedItem = completionItems[indexOrValue];\n        }\n        else {\n            processedItem = indexOrValue;\n        }\n        if (!processedItem) {\n            return undefined;\n        }\n        let originalItem;\n        if (this._processedToOriginalItem) {\n            originalItem = this._processedToOriginalItem.get(processedItem);\n        }\n        else {\n            originalItem = processedItem;\n        }\n        if (!originalItem) {\n            return undefined;\n        }\n        return this._resolveItemByValue(originalItem);\n    }\n    /**\n     * Lazy load missing data of a completion item.\n     *\n     * @param  completionItem - the item to be resolved\n     * @return See `resolveItem` method\n     */\n    _resolveItemByValue(completionItem) {\n        const current = ++this._resolvingItem;\n        let resolvedItem;\n        if (completionItem.resolve) {\n            let patch;\n            if (completionItem.insertText) {\n                patch = this.createPatch(completionItem.insertText);\n            }\n            resolvedItem = completionItem.resolve(patch);\n        }\n        else {\n            resolvedItem = Promise.resolve(completionItem);\n        }\n        return resolvedItem\n            .then(activeItem => {\n            // Escape the label it in place\n            this._escapeItemLabel(activeItem, true);\n            Object.keys(activeItem).forEach((key) => {\n                completionItem[key] = activeItem[key];\n            });\n            completionItem.resolve = undefined;\n            if (current !== this._resolvingItem) {\n                return Promise.resolve(null);\n            }\n            return activeItem;\n        })\n            .catch(e => {\n            console.error(e);\n            // Failed to resolve missing data, return the original item.\n            return Promise.resolve(completionItem);\n        });\n    }\n    /**\n     * Escape item label, storing the original label and adding `insertText` if needed.\n     * If escaping changes label creates a new item unless `inplace` is true.\n     */\n    _escapeItemLabel(item, inplace = false) {\n        var _a;\n        const escapedLabel = escapeHTML(item.label);\n        // If there was no insert text, use the original (unescaped) label.\n        if (escapedLabel !== item.label) {\n            const newItem = inplace ? item : Object.assign({}, item);\n            newItem.insertText = (_a = item.insertText) !== null && _a !== void 0 ? _a : item.label;\n            newItem.label = escapedLabel;\n            return newItem;\n        }\n        return item;\n    }\n    /**\n     * Reset the state of the model.\n     */\n    _reset() {\n        const hadQuery = this._query;\n        this._current = null;\n        this._cursor = null;\n        this._completionItems = [];\n        this._original = null;\n        this._query = '';\n        this.processedItemsCache = null;\n        this._processedToOriginalItem = null;\n        this._subsetMatch = false;\n        this._typeMap = {};\n        this._orderedTypes = [];\n        if (hadQuery) {\n            this._queryChanged.emit({ newValue: this._query, origin: 'reset' });\n        }\n    }\n}\n/**\n * A namespace for completer model private data.\n */\nvar Private;\n(function (Private) {\n    /**\n     * The list of known type annotations of completer matches.\n     */\n    const KNOWN_TYPES = ['function', 'instance', 'class', 'module', 'keyword'];\n    /**\n     * The map of known type annotations of completer matches.\n     */\n    const KNOWN_MAP = KNOWN_TYPES.reduce((acc, type) => {\n        acc[type] = null;\n        return acc;\n    }, {});\n    /**\n     * Mark a highlighted chunk of text.\n     */\n    function mark(value) {\n        return `<mark>${value}</mark>`;\n    }\n    Private.mark = mark;\n    /**\n     * A sort comparison function for item match scores.\n     *\n     * #### Notes\n     * This orders the items first based on score (lower is better), then\n     * by locale order of the item text.\n     */\n    function scoreCmp(a, b) {\n        var _a, _b, _c;\n        const delta = a.score - b.score;\n        if (delta !== 0) {\n            return delta;\n        }\n        return (_c = (_a = a.item.insertText) === null || _a === void 0 ? void 0 : _a.localeCompare((_b = b.item.insertText) !== null && _b !== void 0 ? _b : '')) !== null && _c !== void 0 ? _c : 0;\n    }\n    Private.scoreCmp = scoreCmp;\n    /**\n     * Compute a reliably ordered list of types for ICompletionItems.\n     *\n     * #### Notes\n     * The resulting list always begins with the known types:\n     * ```\n     * ['function', 'instance', 'class', 'module', 'keyword']\n     * ```\n     * followed by other types in alphabetical order.\n     *\n     */\n    function findOrderedCompletionItemTypes(items) {\n        const newTypeSet = new Set();\n        items.forEach(item => {\n            if (item.type &&\n                !KNOWN_TYPES.includes(item.type) &&\n                !newTypeSet.has(item.type)) {\n                newTypeSet.add(item.type);\n            }\n        });\n        const newTypes = Array.from(newTypeSet);\n        newTypes.sort((a, b) => a.localeCompare(b));\n        return KNOWN_TYPES.concat(newTypes);\n    }\n    Private.findOrderedCompletionItemTypes = findOrderedCompletionItemTypes;\n    /**\n     * Compute a reliably ordered list of types.\n     *\n     * #### Notes\n     * The resulting list always begins with the known types:\n     * ```\n     * ['function', 'instance', 'class', 'module', 'keyword']\n     * ```\n     * followed by other types in alphabetical order.\n     */\n    function findOrderedTypes(typeMap) {\n        const filtered = Object.keys(typeMap)\n            .map(key => typeMap[key])\n            .filter((value) => !!value && !(value in KNOWN_MAP))\n            .sort((a, b) => a.localeCompare(b));\n        return KNOWN_TYPES.concat(filtered);\n    }\n    Private.findOrderedTypes = findOrderedTypes;\n})(Private || (Private = {}));\n//# sourceMappingURL=model.js.map","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\nimport { Sanitizer } from '@jupyterlab/apputils';\nimport { renderText } from '@jupyterlab/rendermime';\nimport { HoverBox } from '@jupyterlab/ui-components';\nimport { ElementExt } from '@lumino/domutils';\nimport { Signal } from '@lumino/signaling';\nimport { Widget } from '@lumino/widgets';\n/**\n * The class name added to completer menu items.\n */\nconst ITEM_CLASS = 'jp-Completer-item';\n/**\n * The class name added to an active completer menu item.\n */\nconst ACTIVE_CLASS = 'jp-mod-active';\n/**\n * The class used by item listing which determines the height of the completer.\n */\nconst LIST_CLASS = 'jp-Completer-list';\n/**\n * Class of the documentation panel.\n */\nconst DOC_PANEL_CLASS = 'jp-Completer-docpanel';\n/**\n * A flag to indicate that event handlers are caught in the capture phase.\n */\nconst USE_CAPTURE = true;\n/**\n * The number of colors defined for the completer type annotations.\n * These are listed in completer/style/index.css#102-152.\n */\nconst N_COLORS = 10;\n/**\n * A widget that enables text completion.\n *\n * #### Notes\n * The completer is intended to be absolutely positioned on the\n * page and hover over any other content, so it should be attached directly\n * to `document.body`, or a node that is the full size of `document.body`.\n * Attaching it to other nodes may incorrectly locate the completer.\n */\nexport class Completer extends Widget {\n    /**\n     * Construct a text completer menu widget.\n     */\n    constructor(options) {\n        var _a, _b, _c, _d;\n        super({ node: document.createElement('div') });\n        this._activeIndex = 0;\n        this._editor = null;\n        this._model = null;\n        this._selected = new Signal(this);\n        this._visibilityChanged = new Signal(this);\n        this._indexChanged = new Signal(this);\n        this._lastSubsetMatch = '';\n        this._geometryLock = false;\n        /**\n         * Increasing this counter invalidates previous request to save geometry cache in animation callback.\n         */\n        this._geometryCounter = 0;\n        this._docPanelExpanded = false;\n        this._renderCounter = 0;\n        this.sanitizer = (_a = options.sanitizer) !== null && _a !== void 0 ? _a : new Sanitizer();\n        this._defaultRenderer = Completer.getDefaultRenderer(this.sanitizer);\n        this._renderer = (_b = options.renderer) !== null && _b !== void 0 ? _b : this._defaultRenderer;\n        this._docPanel = this._createDocPanelNode();\n        this.model = (_c = options.model) !== null && _c !== void 0 ? _c : null;\n        this.editor = (_d = options.editor) !== null && _d !== void 0 ? _d : null;\n        this.addClass('jp-Completer');\n        this.addClass('jp-ThemedContainer');\n        this._updateConstraints();\n    }\n    /**\n     * Cache style constraints from CSS.\n     */\n    _updateConstraints() {\n        const tempNode = document.createElement('div');\n        tempNode.classList.add(LIST_CLASS);\n        tempNode.style.visibility = 'hidden';\n        tempNode.style.overflowY = 'scroll';\n        document.body.appendChild(tempNode);\n        const computedStyle = window.getComputedStyle(tempNode);\n        this._maxHeight = parseInt(computedStyle.maxHeight, 10);\n        this._minHeight = parseInt(computedStyle.minHeight, 10);\n        this._scrollbarWidth = tempNode.offsetWidth - tempNode.clientWidth;\n        document.body.removeChild(tempNode);\n        const tempDocPanel = this._createDocPanelNode();\n        this._docPanelWidth = Private.measureSize(tempDocPanel, 'inline-block').width;\n    }\n    /**\n     * The active index.\n     */\n    get activeIndex() {\n        return this._activeIndex;\n    }\n    /**\n     * The editor used by the completion widget.\n     */\n    get editor() {\n        return this._editor;\n    }\n    set editor(newValue) {\n        this._editor = newValue;\n    }\n    /**\n     * A signal emitted when a selection is made from the completer menu.\n     */\n    get selected() {\n        return this._selected;\n    }\n    /**\n     * A signal emitted when the completer widget's visibility changes.\n     *\n     * #### Notes\n     * This signal is useful when there are multiple floating widgets that may\n     * contend with the same space and ought to be mutually exclusive.\n     */\n    get visibilityChanged() {\n        return this._visibilityChanged;\n    }\n    /**\n     * A signal emitted when the active index changes.\n     */\n    get indexChanged() {\n        return this._indexChanged;\n    }\n    /**\n     * The model used by the completer widget.\n     */\n    get model() {\n        return this._model;\n    }\n    set model(model) {\n        if ((!model && !this._model) || model === this._model) {\n            return;\n        }\n        if (this._model) {\n            this._model.stateChanged.disconnect(this.onModelStateChanged, this);\n            this._model.queryChanged.disconnect(this.onModelQueryChanged, this);\n        }\n        this._model = model;\n        if (this._model) {\n            this._model.stateChanged.connect(this.onModelStateChanged, this);\n            this._model.queryChanged.connect(this.onModelQueryChanged, this);\n        }\n    }\n    /**\n     * The completer used by the completer widget.\n     */\n    get renderer() {\n        return this._renderer;\n    }\n    set renderer(renderer) {\n        this._renderer = renderer;\n    }\n    /**\n     * Enable/disable the document panel.\n     */\n    set showDocsPanel(showDoc) {\n        this._showDoc = showDoc;\n    }\n    get showDocsPanel() {\n        return this._showDoc;\n    }\n    /**\n     * Dispose of the resources held by the completer widget.\n     */\n    dispose() {\n        this._sizeCache = undefined;\n        this._model = null;\n        super.dispose();\n    }\n    /**\n     * Handle the DOM events for the widget.\n     *\n     * @param event - The DOM event sent to the widget.\n     *\n     * #### Notes\n     * This method implements the DOM `EventListener` interface and is\n     * called in response to events on the dock panel's node. It should\n     * not be called directly by user code.\n     */\n    handleEvent(event) {\n        if (this.isHidden || !this._editor) {\n            return;\n        }\n        switch (event.type) {\n            case 'keydown':\n                this._evtKeydown(event);\n                break;\n            case 'pointerdown':\n                this._evtPointerdown(event);\n                break;\n            case 'scroll':\n                this._evtScroll(event);\n                break;\n            default:\n                break;\n        }\n    }\n    /**\n     * Reset the widget.\n     */\n    reset() {\n        this._activeIndex = 0;\n        this._lastSubsetMatch = '';\n        if (this._model) {\n            this._model.reset(true);\n        }\n        this._docPanel.style.display = 'none';\n        // Clear size cache.\n        this._sizeCache = undefined;\n        this.node.scrollTop = 0;\n    }\n    /**\n     * Emit the selected signal for the current active item and reset.\n     */\n    selectActive() {\n        const active = this.node.querySelector(`.${ACTIVE_CLASS}`);\n        if (!active) {\n            this.reset();\n            return;\n        }\n        this._selected.emit(active.getAttribute('data-value'));\n        this.reset();\n    }\n    /**\n     * Handle `after-attach` messages for the widget.\n     */\n    onAfterAttach(msg) {\n        document.addEventListener('keydown', this, USE_CAPTURE);\n        document.addEventListener('pointerdown', this, USE_CAPTURE);\n        document.addEventListener('scroll', this, USE_CAPTURE);\n    }\n    /**\n     * Handle `before-detach` messages for the widget.\n     */\n    onBeforeDetach(msg) {\n        document.removeEventListener('keydown', this, USE_CAPTURE);\n        document.removeEventListener('pointerdown', this, USE_CAPTURE);\n        document.removeEventListener('scroll', this, USE_CAPTURE);\n    }\n    /**\n     * Handle model state changes.\n     */\n    onModelStateChanged() {\n        if (this.isAttached) {\n            this._activeIndex = 0;\n            this._indexChanged.emit(this._activeIndex);\n            this.update();\n        }\n    }\n    /**\n     * Handle model query changes.\n     */\n    onModelQueryChanged(model, queryChange) {\n        // If query was changed by the user typing, the filtered down items\n        // may no longer reach/exceed the maxHeight of the completer widget,\n        // hence size needs to be recalculated.\n        if (this._sizeCache && queryChange.origin === 'editorUpdate') {\n            const newItems = model.completionItems();\n            const oldItems = this._sizeCache.items;\n            // Only reset size if the number of items changed, or the longest item changed.\n            const oldWidest = oldItems[this._findWidestItemIndex(oldItems)];\n            const newWidest = newItems[this._findWidestItemIndex(newItems)];\n            const heuristic = this._getPreferredItemWidthHeuristic();\n            if (newItems.length !== this._sizeCache.items.length ||\n                heuristic(oldWidest) !== heuristic(newWidest)) {\n                this._sizeCache = undefined;\n            }\n        }\n    }\n    /**\n     * Handle `update-request` messages.\n     */\n    onUpdateRequest(msg) {\n        var _a;\n        const model = this._model;\n        if (!model) {\n            return;\n        }\n        // If this is the first time the current completer session has loaded,\n        // populate any initial subset match. This is being done before node\n        // gets rendered to avoid rendering it twice.\n        if (!model.query) {\n            this._populateSubset();\n        }\n        let items = model.completionItems();\n        // If there are no items, reset and bail.\n        if (!items.length) {\n            if (!this.isHidden) {\n                this.reset();\n                this.hide();\n                this._visibilityChanged.emit(undefined);\n            }\n            return;\n        }\n        // Update constraints before any DOM modifications\n        this._updateConstraints();\n        // Do not trigger any geometry updates from async code when in lock.\n        this._geometryLock = true;\n        const node = this._createCompleterNode(model, items);\n        let active = node.querySelectorAll(`.${ITEM_CLASS}`)[this._activeIndex];\n        active.classList.add(ACTIVE_CLASS);\n        const resolvedItem = (_a = this.model) === null || _a === void 0 ? void 0 : _a.resolveItem(items[this._activeIndex]);\n        // Add the documentation panel\n        if (this._showDoc) {\n            this._docPanel.innerText = '';\n            node.appendChild(this._docPanel);\n            this._docPanelExpanded = false;\n            this._docPanel.style.display = 'none';\n            this._updateDocPanel(resolvedItem, active);\n        }\n        if (this.isHidden) {\n            this.show();\n            this._setGeometry();\n            this._visibilityChanged.emit(undefined);\n        }\n        else {\n            this._setGeometry();\n        }\n        this._geometryLock = false;\n    }\n    /**\n     * Get cached dimensions of the completer box.\n     */\n    get sizeCache() {\n        if (!this._sizeCache) {\n            return;\n        }\n        return {\n            width: this._sizeCache.width + this._sizeCache.docPanelWidth,\n            height: Math.max(this._sizeCache.height, this._sizeCache.docPanelHeight)\n        };\n    }\n    _createDocPanelNode() {\n        const docPanel = document.createElement('div');\n        docPanel.className = DOC_PANEL_CLASS;\n        return docPanel;\n    }\n    _createCompleterNode(model, items) {\n        const current = ++this._renderCounter;\n        // Clear the node.\n        let node = this.node;\n        node.textContent = '';\n        // Compute an ordered list of all the types in the typeMap, this is computed\n        // once by the model each time new data arrives for efficiency.\n        let orderedTypes = model.orderedTypes();\n        // Populate the completer items.\n        let ul = document.createElement('ul');\n        ul.className = LIST_CLASS;\n        // Add first N items to fill the first \"page\" assuming that the completer\n        // would reach its maximum allowed height.\n        const first = this._renderer.createCompletionItemNode(items[0], orderedTypes);\n        const renderedItems = [first];\n        const firstItemSize = Private.measureSize(first, 'inline-grid');\n        const pageSize = Math.max(Math.ceil(this._maxHeight / firstItemSize.height), 5);\n        // We add one item in case if height heuristic is inaccurate.\n        const toRenderImmediately = Math.min(pageSize + 1, items.length);\n        const start = performance.now();\n        for (let i = 1; i < toRenderImmediately; i++) {\n            const li = this._renderer.createCompletionItemNode(items[i], orderedTypes);\n            renderedItems.push(li);\n        }\n        for (const li of renderedItems) {\n            ul.appendChild(li);\n        }\n        // Pre-calculate size:\n        //  - height will equal first element height times number of items,\n        //    or maximum allowed height if there are more items than fit on a page,\n        //  - width will be estimated from the widest item.\n        const widestItemIndex = this._findWidestItemIndex(items);\n        const widestItem = widestItemIndex < renderedItems.length\n            ? renderedItems[widestItemIndex]\n            : this._renderer.createCompletionItemNode(items[widestItemIndex], orderedTypes);\n        // The node needs to be cloned to avoid side-effect of detaching it.\n        const widestItemSize = Private.measureSize(widestItem.cloneNode(true), 'inline-grid');\n        this._sizeCache = {\n            height: Math.min(this._maxHeight, firstItemSize.height * items.length),\n            width: widestItemSize.width + this._scrollbarWidth,\n            items: items,\n            docPanelWidth: 0,\n            docPanelHeight: 0\n        };\n        if (toRenderImmediately < items.length) {\n            // Render remaining items on idle in subsequent animation frames,\n            // in chunks of size such that each frame would take about 16ms\n            // allowing for 4ms of overhead, but keep the chunks no smaller\n            // than 5 items at a time.\n            const timePerItem = (performance.now() - start) / toRenderImmediately;\n            const chunkSize = Math.max(5, Math.floor(12 / timePerItem));\n            let alreadyRendered = toRenderImmediately;\n            let previousChunkFinal = renderedItems[renderedItems.length - 1];\n            const renderChunk = () => {\n                if (alreadyRendered >= items.length) {\n                    return;\n                }\n                // Add a filler so that the list with partially rendered items has the total\n                // height equal to the (predicted) final height to avoid scrollbar jitter.\n                const predictedMissingHeight = firstItemSize.height * (items.length - alreadyRendered);\n                previousChunkFinal.style.marginBottom = `${predictedMissingHeight}px`;\n                requestAnimationFrame(() => {\n                    if (current != this._renderCounter) {\n                        // Bail if rendering afresh was requested in the meantime.\n                        return;\n                    }\n                    previousChunkFinal.style.marginBottom = '';\n                    const limit = Math.min(items.length, alreadyRendered + chunkSize);\n                    for (let i = alreadyRendered; i < limit; i++) {\n                        const li = this._renderer.createCompletionItemNode(items[i], orderedTypes);\n                        ul.appendChild(li);\n                        previousChunkFinal = li;\n                    }\n                    alreadyRendered = limit;\n                    renderChunk();\n                });\n            };\n            renderChunk();\n        }\n        node.appendChild(ul);\n        return node;\n    }\n    /**\n     * Use preferred heuristic to find the index of the widest item.\n     */\n    _findWidestItemIndex(items) {\n        const widthHeuristic = this._getPreferredItemWidthHeuristic();\n        const widthHeuristics = items.map(widthHeuristic);\n        return widthHeuristics.indexOf(Math.max(...widthHeuristics));\n    }\n    /**\n     * Get item width heuristic function from renderer if available,\n     * or the default one otherwise.\n     */\n    _getPreferredItemWidthHeuristic() {\n        return this._renderer.itemWidthHeuristic\n            ? this._renderer.itemWidthHeuristic.bind(this._renderer)\n            : this._defaultRenderer.itemWidthHeuristic.bind(this._defaultRenderer);\n    }\n    /**\n     * Cycle through the available completer items.\n     *\n     * #### Notes\n     * When the user cycles all the way `down` to the last index, subsequent\n     * `down` cycles will cycle to the first index. When the user cycles `up` to\n     * the first item, subsequent `up` cycles will cycle to the last index.\n     */\n    _cycle(direction) {\n        var _a, _b;\n        const items = this.node.querySelectorAll(`.${ITEM_CLASS}`);\n        const index = this._activeIndex;\n        const last = items.length - 1;\n        let active = this.node.querySelector(`.${ACTIVE_CLASS}`);\n        active.classList.remove(ACTIVE_CLASS);\n        switch (direction) {\n            case 'up':\n                this._activeIndex = index === 0 ? last : index - 1;\n                break;\n            case 'down':\n                this._activeIndex = index < last ? index + 1 : 0;\n                break;\n            case 'pageUp':\n            case 'pageDown': {\n                // Measure the number of items on a page and clamp to the list length.\n                const container = this.node.getBoundingClientRect();\n                const current = active.getBoundingClientRect();\n                const page = Math.floor(container.height / current.height);\n                const sign = direction === 'pageUp' ? -1 : 1;\n                this._activeIndex = Math.min(Math.max(0, index + sign * page), last);\n                break;\n            }\n        }\n        active = items[this._activeIndex];\n        active.classList.add(ACTIVE_CLASS);\n        let completionList = this.node.querySelector(`.${LIST_CLASS}`);\n        ElementExt.scrollIntoViewIfNeeded(completionList, active);\n        this._indexChanged.emit(this._activeIndex);\n        const visibleCompletionItems = (_a = this.model) === null || _a === void 0 ? void 0 : _a.completionItems();\n        const activeCompletionItem = visibleCompletionItems === null || visibleCompletionItems === void 0 ? void 0 : visibleCompletionItems[this._activeIndex];\n        if (activeCompletionItem) {\n            const resolvedItem = (_b = this.model) === null || _b === void 0 ? void 0 : _b.resolveItem(activeCompletionItem);\n            if (this._showDoc) {\n                this._updateDocPanel(resolvedItem, active);\n            }\n        }\n    }\n    /**\n     * Handle keydown events for the widget.\n     */\n    _evtKeydown(event) {\n        if (this.isHidden || !this._editor) {\n            return;\n        }\n        if (!this._editor.host.contains(event.target)) {\n            this.reset();\n            return;\n        }\n        switch (event.keyCode) {\n            case 9: {\n                // Tab key\n                event.preventDefault();\n                event.stopPropagation();\n                event.stopImmediatePropagation();\n                const model = this._model;\n                if (!model) {\n                    return;\n                }\n                // Autoinsert single completions on manual request (tab)\n                const items = model.completionItems();\n                if (items && items.length === 1) {\n                    this._selected.emit(items[0].insertText || items[0].label);\n                    this.reset();\n                    return;\n                }\n                const populated = this._populateSubset();\n                // If the common subset was found and set on `query`,\n                // or if there is a `query` in the initialization options,\n                // then emit a completion signal with that `query` (=subset match),\n                // but only if the query has actually changed.\n                // See: https://github.com/jupyterlab/jupyterlab/issues/10439#issuecomment-875189540\n                if (model.query && model.query !== this._lastSubsetMatch) {\n                    model.subsetMatch = true;\n                    this._selected.emit(model.query);\n                    model.subsetMatch = false;\n                    this._lastSubsetMatch = model.query;\n                }\n                // If the query changed, update rendering of the options.\n                if (populated) {\n                    this.update();\n                }\n                this._cycle(event.shiftKey ? 'up' : 'down');\n                return;\n            }\n            case 27: // Esc key\n                event.preventDefault();\n                event.stopPropagation();\n                event.stopImmediatePropagation();\n                this.reset();\n                return;\n            case 33: // PageUp\n            case 34: // PageDown\n            case 38: // Up arrow key\n            case 40: {\n                // Down arrow key\n                event.preventDefault();\n                event.stopPropagation();\n                event.stopImmediatePropagation();\n                const cycle = Private.keyCodeMap[event.keyCode];\n                this._cycle(cycle);\n                return;\n            }\n            default:\n                return;\n        }\n    }\n    /**\n     * Handle mousedown events for the widget.\n     */\n    _evtPointerdown(event) {\n        if (this.isHidden || !this._editor) {\n            return;\n        }\n        if (Private.nonstandardClick(event)) {\n            this.reset();\n            return;\n        }\n        let target = event.target;\n        while (target !== document.documentElement) {\n            // If the user has made a selection, emit its value and reset the widget.\n            if (target.classList.contains(ITEM_CLASS)) {\n                event.preventDefault();\n                event.stopPropagation();\n                event.stopImmediatePropagation();\n                this._selected.emit(target.getAttribute('data-value'));\n                this.reset();\n                return;\n            }\n            // If the mouse event happened anywhere else in the widget, bail.\n            if (target === this.node) {\n                event.preventDefault();\n                event.stopPropagation();\n                event.stopImmediatePropagation();\n                return;\n            }\n            target = target.parentElement;\n        }\n        this.reset();\n    }\n    /**\n     * Handle scroll events for the widget\n     */\n    _evtScroll(event) {\n        if (this.isHidden || !this._editor) {\n            return;\n        }\n        const { node } = this;\n        // All scrolls except scrolls in the actual hover box node may cause the\n        // referent editor that anchors the node to move, so the only scroll events\n        // that can safely be ignored are ones that happen inside the hovering node.\n        if (node.contains(event.target)) {\n            return;\n        }\n        // Set the geometry of the node asynchronously.\n        requestAnimationFrame(() => {\n            this._setGeometry();\n        });\n    }\n    /**\n     * Populate the completer up to the longest initial subset of items.\n     *\n     * @returns `true` if a subset match was found and populated.\n     */\n    _populateSubset() {\n        const { model } = this;\n        if (!model) {\n            return false;\n        }\n        const items = model.completionItems();\n        const subset = Private.commonSubset(items.map(item => item.insertText || item.label));\n        const { query } = model;\n        // If a common subset exists and it is not the current query, highlight it.\n        if (subset && subset !== query && subset.indexOf(query) === 0) {\n            model.query = subset;\n            return true;\n        }\n        return false;\n    }\n    /**\n     * Set the visible dimensions of the widget.\n     */\n    _setGeometry() {\n        const { node } = this;\n        const model = this._model;\n        const editor = this._editor;\n        // This is an overly defensive test: `cursor` will always exist if\n        // `original` exists, except in contrived tests. But since it is possible\n        // to generate a runtime error, the check occurs here.\n        if (!editor || !model || !model.original || !model.cursor) {\n            return;\n        }\n        const start = model.cursor.start;\n        const position = editor.getPositionAt(start);\n        const anchor = editor.getCoordinateForPosition(position);\n        if (!anchor) {\n            return;\n        }\n        const style = window.getComputedStyle(node);\n        const borderLeft = parseInt(style.borderLeftWidth, 10) || 0;\n        const paddingLeft = parseInt(style.paddingLeft, 10) || 0;\n        // When the editor is attached to the main area, contain the completer hover box\n        // to the full area available (rather than to the editor itself); the available\n        // area excludes the toolbar, hence the first Widget child between MainAreaWidget\n        // and editor is preferred. The difference is negligible in File Editor, but\n        // substantial for Notebooks.\n        const host = editor.host.closest('.jp-MainAreaWidget > .lm-Widget') ||\n            editor.host;\n        const items = model.completionItems();\n        // Fast cache invalidation (only checks for length rather than length + width)\n        if (this._sizeCache && this._sizeCache.items.length !== items.length) {\n            this._sizeCache = undefined;\n        }\n        // Calculate the geometry of the completer.\n        HoverBox.setGeometry({\n            anchor,\n            host: host,\n            maxHeight: this._maxHeight,\n            minHeight: this._minHeight,\n            node: node,\n            size: this.sizeCache,\n            offset: { horizontal: borderLeft + paddingLeft },\n            privilege: 'below',\n            style: style,\n            outOfViewDisplay: {\n                top: 'stick-inside',\n                bottom: 'stick-inside',\n                left: 'stick-inside',\n                right: 'stick-outside'\n            }\n        });\n        const current = ++this._geometryCounter;\n        if (!this._sizeCache) {\n            // If size was not pre-calculated using heuristics, save the actual\n            // size into cache once rendered.\n            requestAnimationFrame(() => {\n                if (current != this._geometryCounter) {\n                    // Do not set size to cache if it may already be outdated.\n                    return;\n                }\n                let rect = node.getBoundingClientRect();\n                let panel = this._docPanel.getBoundingClientRect();\n                this._sizeCache = {\n                    width: rect.width - panel.width,\n                    height: rect.height,\n                    items: items,\n                    docPanelWidth: panel.width,\n                    docPanelHeight: panel.height\n                };\n            });\n        }\n    }\n    /**\n     * Update the display-state and contents of the documentation panel\n     */\n    _updateDocPanel(resolvedItem, activeNode) {\n        var _a, _b, _c;\n        let docPanel = this._docPanel;\n        if (!resolvedItem) {\n            this._toggleDocPanel(false);\n            return;\n        }\n        const loadingIndicator = (_c = (_b = (_a = this._renderer).createLoadingDocsIndicator) === null || _b === void 0 ? void 0 : _b.call(_a)) !== null && _c !== void 0 ? _c : this._defaultRenderer.createLoadingDocsIndicator();\n        activeNode.appendChild(loadingIndicator);\n        resolvedItem\n            .then(activeItem => {\n            var _a, _b, _c;\n            if (!activeItem) {\n                return;\n            }\n            if (!docPanel) {\n                return;\n            }\n            if (activeItem.documentation) {\n                const node = (_c = (_b = (_a = this._renderer).createDocumentationNode) === null || _b === void 0 ? void 0 : _b.call(_a, activeItem)) !== null && _c !== void 0 ? _c : this._defaultRenderer.createDocumentationNode(activeItem);\n                docPanel.textContent = '';\n                docPanel.appendChild(node);\n                this._toggleDocPanel(true);\n            }\n            else {\n                this._toggleDocPanel(false);\n            }\n        })\n            .catch(e => console.error(e))\n            .finally(() => {\n            activeNode.removeChild(loadingIndicator);\n        });\n    }\n    _toggleDocPanel(show) {\n        let docPanel = this._docPanel;\n        if (show) {\n            if (this._docPanelExpanded) {\n                return;\n            }\n            docPanel.style.display = '';\n            this._docPanelExpanded = true;\n        }\n        else {\n            if (!this._docPanelExpanded) {\n                return;\n            }\n            docPanel.style.display = 'none';\n            this._docPanelExpanded = false;\n        }\n        const sizeCache = this._sizeCache;\n        if (sizeCache) {\n            sizeCache.docPanelHeight = show ? this._maxHeight : 0;\n            sizeCache.docPanelWidth = show ? this._docPanelWidth : 0;\n            if (!this._geometryLock) {\n                this._setGeometry();\n            }\n        }\n    }\n}\n(function (Completer) {\n    /**\n     * The default implementation of an `IRenderer`.\n     */\n    class Renderer {\n        constructor(options) {\n            this.sanitizer = (options === null || options === void 0 ? void 0 : options.sanitizer) || new Sanitizer();\n        }\n        /**\n         * Create an item node from an ICompletionItem for a text completer menu.\n         */\n        createCompletionItemNode(item, orderedTypes) {\n            let wrapperNode = this._createWrapperNode(item.insertText || item.label);\n            if (item.deprecated) {\n                wrapperNode.classList.add('jp-Completer-deprecated');\n            }\n            return this._constructNode(wrapperNode, this._createLabelNode(item.label), !!item.type, item.type, orderedTypes, item.icon);\n        }\n        /**\n         * Create a documentation node for documentation panel.\n         */\n        createDocumentationNode(activeItem) {\n            const host = document.createElement('div');\n            host.classList.add('jp-RenderedText');\n            const sanitizer = this.sanitizer;\n            const source = activeItem.documentation || '';\n            renderText({ host, sanitizer, source }).catch(console.error);\n            return host;\n        }\n        /**\n         * Get a heuristic for the width of an item.\n         */\n        itemWidthHeuristic(item) {\n            var _a;\n            // Get the label text without HTML markup (`<mark>` is the only markup\n            // that is allowed in processed items, everything else gets escaped).\n            const labelText = item.label.replace(/<(\\/)?mark>/g, '');\n            return labelText.length + (((_a = item.type) === null || _a === void 0 ? void 0 : _a.length) || 0);\n        }\n        /**\n         * Create a loading bar for the documentation panel.\n         */\n        createLoadingDocsIndicator() {\n            const loadingContainer = document.createElement('div');\n            loadingContainer.classList.add('jp-Completer-loading-bar-container');\n            const loadingBar = document.createElement('div');\n            loadingBar.classList.add('jp-Completer-loading-bar');\n            loadingContainer.append(loadingBar);\n            return loadingContainer;\n        }\n        /**\n         * Create base node with the value to be inserted.\n         */\n        _createWrapperNode(value) {\n            const li = document.createElement('li');\n            li.className = ITEM_CLASS;\n            // Set the raw, un-marked up value as a data attribute.\n            li.setAttribute('data-value', value);\n            return li;\n        }\n        /**\n         * Create match node to highlight potential prefix match within result.\n         */\n        _createLabelNode(result) {\n            const matchNode = document.createElement('code');\n            matchNode.className = 'jp-Completer-match';\n            // Use innerHTML because search results include <mark> tags.\n            matchNode.innerHTML = result;\n            return matchNode;\n        }\n        /**\n         * Attaches type and match nodes to base node.\n         */\n        _constructNode(li, matchNode, typesExist, type, orderedTypes, icon) {\n            // Add the icon or type monogram\n            if (icon) {\n                const iconNode = icon.element({\n                    className: 'jp-Completer-type jp-Completer-icon'\n                });\n                li.appendChild(iconNode);\n            }\n            else if (typesExist) {\n                const typeNode = document.createElement('span');\n                typeNode.textContent = (type[0] || '').toLowerCase();\n                const colorIndex = (orderedTypes.indexOf(type) % N_COLORS) + 1;\n                typeNode.className = 'jp-Completer-type jp-Completer-monogram';\n                typeNode.setAttribute(`data-color-index`, colorIndex.toString());\n                li.appendChild(typeNode);\n            }\n            else {\n                // Create empty span to ensure consistent list styling.\n                // Otherwise, in a list of two items,\n                // if one item has an icon, but the other has type,\n                // the icon grows out of its bounds.\n                const dummyNode = document.createElement('span');\n                dummyNode.className = 'jp-Completer-monogram';\n                li.appendChild(dummyNode);\n            }\n            li.appendChild(matchNode);\n            // If there is a type, add the type extension and title\n            if (typesExist) {\n                li.title = type;\n                const typeExtendedNode = document.createElement('code');\n                typeExtendedNode.className = 'jp-Completer-typeExtended';\n                typeExtendedNode.textContent = type.toLocaleLowerCase();\n                li.appendChild(typeExtendedNode);\n            }\n            else {\n                // If no type is present on the right,\n                // the highlighting of the completion item\n                // doesn't cover the entire row.\n                const dummyTypeExtendedNode = document.createElement('span');\n                dummyTypeExtendedNode.className = 'jp-Completer-typeExtended';\n                li.appendChild(dummyTypeExtendedNode);\n            }\n            return li;\n        }\n    }\n    Completer.Renderer = Renderer;\n    /**\n     * Default renderer\n     */\n    let _defaultRenderer;\n    /**\n     * The default `IRenderer` instance.\n     */\n    function getDefaultRenderer(sanitizer) {\n        if (!_defaultRenderer ||\n            (sanitizer && _defaultRenderer.sanitizer !== sanitizer)) {\n            _defaultRenderer = new Renderer({ sanitizer: sanitizer });\n        }\n        return _defaultRenderer;\n    }\n    Completer.getDefaultRenderer = getDefaultRenderer;\n})(Completer || (Completer = {}));\n/**\n * A namespace for completer widget private data.\n */\nvar Private;\n(function (Private) {\n    /**\n     * Mapping from keyCodes to scrollTypes.\n     */\n    Private.keyCodeMap = {\n        38: 'up',\n        40: 'down',\n        33: 'pageUp',\n        34: 'pageDown'\n    };\n    /**\n     * Returns the common subset string that a list of strings shares.\n     */\n    function commonSubset(values) {\n        const len = values.length;\n        let subset = '';\n        if (len < 2) {\n            return subset;\n        }\n        const strlen = values[0].length;\n        for (let i = 0; i < strlen; i++) {\n            const ch = values[0][i];\n            for (let j = 1; j < len; j++) {\n                if (values[j][i] !== ch) {\n                    return subset;\n                }\n            }\n            subset += ch;\n        }\n        return subset;\n    }\n    Private.commonSubset = commonSubset;\n    /**\n     * Returns true for any modified click event (i.e., not a left-click).\n     */\n    function nonstandardClick(event) {\n        return (event.button !== 0 ||\n            event.altKey ||\n            event.ctrlKey ||\n            event.shiftKey ||\n            event.metaKey);\n    }\n    Private.nonstandardClick = nonstandardClick;\n    /**\n     * Measure size of provided HTML element without painting it.\n     *\n     * #### Notes\n     * The provided element has to be detached (not connected to DOM),\n     * or a side-effect of detaching it will occur.\n     */\n    function measureSize(element, display) {\n        if (element.isConnected) {\n            console.warn('Measuring connected elements with `measureSize` has side-effects');\n        }\n        element.style.visibility = 'hidden';\n        element.style.display = display;\n        document.body.appendChild(element);\n        const size = element.getBoundingClientRect();\n        document.body.removeChild(element);\n        element.removeAttribute('style');\n        return size;\n    }\n    Private.measureSize = measureSize;\n})(Private || (Private = {}));\n//# sourceMappingURL=widget.js.map","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n/**\n * Determines whether the given MIME type is suitable for code completion.\n *\n * @param mimeType - The MIME type of the current editor context.\n * @returns `true` if the MIME type supports code completion; otherwise, `false`.\n */\nexport function isHintableMimeType(mimeType) {\n    const excludedMimeTypes = new Set([\n        'text/plain',\n        'text/markdown',\n        'text/x-ipythongfm',\n        'text/x-rst',\n        'text/latex',\n        'application/json',\n        'text/html',\n        'text/css'\n    ]);\n    return !excludedMimeTypes.has(mimeType);\n}\n//# sourceMappingURL=utils.js.map","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\nimport { CompletionHandler } from './handler';\nimport { InlineCompletionTriggerKind } from './tokens';\nimport { Signal } from '@lumino/signaling';\nimport { isHintableMimeType } from './utils';\n/**\n * The reconciliator which is used to fetch and merge responses from multiple completion providers.\n */\nexport class ProviderReconciliator {\n    /**\n     * Creates an instance of ProviderReconciliator.\n     */\n    constructor(options) {\n        var _a, _b;\n        this._resolveFactory = (provider, el) => provider.resolve\n            ? (patch) => provider.resolve(el, this._context, patch)\n            : undefined;\n        /**\n         * Counter to reject current provider response if a new fetch request is created.\n         */\n        this._fetching = 0;\n        /**\n         * Counter to reject current inline provider response if a new `inlineFetch` request is created.\n         */\n        this._inlineFetching = 0;\n        this._providers = options.providers;\n        this._inlineProviders = (_a = options.inlineProviders) !== null && _a !== void 0 ? _a : [];\n        this._inlineProvidersSettings = (_b = options.inlineProvidersSettings) !== null && _b !== void 0 ? _b : {};\n        this._context = options.context;\n        this._timeout = options.timeout;\n    }\n    /**\n     * Check for the providers which are applicable with the current context\n     *\n     * @return  List of applicable providers\n     */\n    async applicableProviders() {\n        const isApplicablePromises = this._providers.map(p => p.isApplicable(this._context));\n        const applicableProviders = await Promise.all(isApplicablePromises);\n        return this._providers.filter((_, idx) => applicableProviders[idx]);\n    }\n    fetchInline(request, trigger, isMiddleOfLine) {\n        let promises = [];\n        const current = ++this._inlineFetching;\n        for (const provider of this._inlineProviders) {\n            const settings = this._inlineProvidersSettings[provider.identifier];\n            if (trigger !== InlineCompletionTriggerKind.Invoke &&\n                isMiddleOfLine &&\n                !settings.autoFillInMiddle) {\n                // Skip if FIM is disabled\n                continue;\n            }\n            let delay = 0;\n            if (trigger === InlineCompletionTriggerKind.Automatic) {\n                delay = settings.debouncerDelay;\n            }\n            const fetch = () => {\n                const promise = provider\n                    .fetch(request, { ...this._context, triggerKind: trigger })\n                    .then(completionList => {\n                    return {\n                        ...completionList,\n                        items: completionList.items.map(item => {\n                            const newItem = item;\n                            newItem.stream = new Signal(newItem);\n                            newItem.provider = provider;\n                            void this._stream(newItem, provider);\n                            return newItem;\n                        })\n                    };\n                });\n                const timeoutPromise = new Promise(resolve => {\n                    return setTimeout(() => resolve(null), delay + settings.timeout);\n                });\n                return Promise.race([promise, timeoutPromise]);\n            };\n            const promise = delay === 0\n                ? fetch()\n                : new Promise((resolve, reject) => {\n                    return setTimeout(() => {\n                        if (current != this._inlineFetching) {\n                            // User pressed another key or explicitly requested completions since.\n                            return reject(null);\n                        }\n                        else {\n                            return resolve(fetch());\n                        }\n                    }, delay);\n                });\n            // Wrap promise and return error in case of failure.\n            promises.push(promise.catch(p => p));\n        }\n        return promises;\n    }\n    async _stream(item, provider) {\n        if (!item.isIncomplete || !provider.stream || !item.token) {\n            return;\n        }\n        const streamed = item.stream;\n        const token = item.token;\n        item.token = undefined;\n        // Notify that streaming started.\n        item.streaming = true;\n        streamed.emit(CompletionHandler.StraemEvent.opened);\n        for await (const reply of provider.stream(token)) {\n            const updated = reply.response;\n            const addition = updated.insertText.substring(item.insertText.length);\n            // Stream an update.\n            item.insertText = updated.insertText;\n            item.lastStreamed = addition;\n            item.error = reply.response.error;\n            streamed.emit(CompletionHandler.StraemEvent.update);\n        }\n        // Notify that streaming is no longer in progress.\n        item.isIncomplete = false;\n        item.lastStreamed = undefined;\n        item.streaming = false;\n        streamed.emit(CompletionHandler.StraemEvent.closed);\n    }\n    /**\n     * Fetch response from multiple providers, If a provider can not return\n     * the response for a completer request before timeout,\n     * the result of this provider will be ignored.\n     *\n     * @param {CompletionHandler.IRequest} request - The completion request.\n     */\n    async fetch(request, trigger) {\n        const current = ++this._fetching;\n        let promises = [];\n        const applicableProviders = await this.applicableProviders();\n        for (const provider of applicableProviders) {\n            let promise;\n            promise = provider.fetch(request, this._context, trigger).then(reply => {\n                if (current !== this._fetching) {\n                    return Promise.reject(void 0);\n                }\n                const items = reply.items.map(el => ({\n                    ...el,\n                    resolve: this._resolveFactory(provider, el)\n                }));\n                return { ...reply, items };\n            });\n            const timeoutPromise = new Promise(resolve => {\n                return setTimeout(() => resolve(null), this._timeout);\n            });\n            promise = Promise.race([promise, timeoutPromise]);\n            // Wrap promise and return error in case of failure.\n            promises.push(promise.catch(p => p));\n        }\n        // TODO: maybe use `Promise.allSettled` once library is at es2020 instead of adding a catch.\n        const combinedPromise = Promise.all(promises);\n        return this._mergeCompletions(combinedPromise);\n    }\n    /**\n     * Check if completer should make request to fetch completion responses\n     * on user typing. If the provider with highest rank does not have\n     * `shouldShowContinuousHint` method, a default one will be used.\n     *\n     * @param completerIsVisible - The visible status of completer widget.\n     * @param changed - CodeMirror changed argument.\n     */\n    async shouldShowContinuousHint(completerIsVisible, changed) {\n        const applicableProviders = await this.applicableProviders();\n        if (applicableProviders.length === 0) {\n            return false;\n        }\n        if (applicableProviders[0].shouldShowContinuousHint) {\n            return applicableProviders[0].shouldShowContinuousHint(completerIsVisible, changed, this._context);\n        }\n        return this._defaultShouldShowContinuousHint(completerIsVisible, changed);\n    }\n    _alignPrefixes(replies, minStart, maxStart) {\n        if (minStart != maxStart) {\n            const editor = this._context.editor;\n            if (!editor) {\n                return replies;\n            }\n            const cursor = editor.getCursorPosition();\n            const line = editor.getLine(cursor.line);\n            if (!line) {\n                return replies;\n            }\n            const lineOffset = editor.getOffsetAt({ line: cursor.line, column: 0 });\n            return replies.map(reply => {\n                const prefixStart = Math.max(reply.start - lineOffset, 0);\n                const prefixEnd = Math.max(maxStart - lineOffset, 0);\n                // No prefix to strip, return as-is.\n                if (prefixStart == prefixEnd) {\n                    return reply;\n                }\n                const prefix = line.substring(prefixStart, prefixEnd);\n                return {\n                    ...reply,\n                    items: reply.items.map(item => {\n                        let insertText = item.insertText || item.label;\n                        item.insertText = insertText.startsWith(prefix)\n                            ? insertText.slice(prefix.length)\n                            : insertText;\n                        return item;\n                    })\n                };\n            });\n        }\n        return replies;\n    }\n    async _mergeCompletions(promises) {\n        let replies = (await promises).filter(reply => {\n            // Ignore it errors out.\n            if (!reply || reply instanceof Error) {\n                return false;\n            }\n            // Ignore if no matches.\n            if (!reply.items.length) {\n                return false;\n            }\n            // Otherwise keep.\n            return true;\n        });\n        // Fast path for a single reply or no replies.\n        if (replies.length == 0) {\n            return null;\n        }\n        else if (replies.length == 1) {\n            return replies[0];\n        }\n        const minEnd = Math.min(...replies.map(reply => reply.end));\n        // If any of the replies uses a wider range, we need to align them\n        // so that all responses use the same range.\n        const starts = replies.map(reply => reply.start);\n        const minStart = Math.min(...starts);\n        const maxStart = Math.max(...starts);\n        replies = this._alignPrefixes(replies, minStart, maxStart);\n        const insertTextSet = new Set();\n        const mergedItems = new Array();\n        for (const reply of replies) {\n            reply.items.forEach(item => {\n                // IPython returns 'import' and 'import '; while the latter is more useful,\n                // user should not see two suggestions with identical labels and nearly-identical\n                // behaviour as they could not distinguish the two either way.\n                let text = (item.insertText || item.label).trim();\n                if (insertTextSet.has(text)) {\n                    return;\n                }\n                insertTextSet.add(text);\n                mergedItems.push(item);\n            });\n        }\n        return {\n            start: maxStart,\n            end: minEnd,\n            items: mergedItems\n        };\n    }\n    _defaultShouldShowContinuousHint(completerIsVisible, changed) {\n        var _a, _b, _c;\n        const mimeType = (_c = (_b = (_a = this._context) === null || _a === void 0 ? void 0 : _a.editor) === null || _b === void 0 ? void 0 : _b.model.mimeType) !== null && _c !== void 0 ? _c : '';\n        if (!isHintableMimeType(mimeType)) {\n            return false;\n        }\n        return (!completerIsVisible &&\n            (changed.sourceChange == null ||\n                changed.sourceChange.some(delta => delta.insert != null && delta.insert.length > 0)));\n    }\n}\n//# sourceMappingURL=reconciliator.js.map","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\nimport { Text } from '@jupyterlab/coreutils';\nimport { isHintableMimeType } from '../utils';\nexport const KERNEL_PROVIDER_ID = 'CompletionProvider:kernel';\n/**\n * A kernel connector for completion handlers.\n */\nexport class KernelCompleterProvider {\n    constructor() {\n        this.identifier = KERNEL_PROVIDER_ID;\n        this.rank = 550;\n        this.renderer = null;\n    }\n    /**\n     * The kernel completion provider is applicable only if the kernel is available.\n     * @param context - additional information about context of completion request\n     */\n    async isApplicable(context) {\n        var _a;\n        const hasKernel = (_a = context.session) === null || _a === void 0 ? void 0 : _a.kernel;\n        if (!hasKernel) {\n            return false;\n        }\n        return true;\n    }\n    /**\n     * Fetch completion requests.\n     *\n     * @param request - The completion request text and details.\n     */\n    async fetch(request, context) {\n        var _a;\n        const kernel = (_a = context.session) === null || _a === void 0 ? void 0 : _a.kernel;\n        if (!kernel) {\n            throw new Error('No kernel for completion request.');\n        }\n        const contents = {\n            code: request.text,\n            cursor_pos: request.offset\n        };\n        const msg = await kernel.requestComplete(contents);\n        const response = msg.content;\n        if (response.status !== 'ok') {\n            throw new Error('Completion fetch failed to return successfully.');\n        }\n        const items = new Array();\n        const metadata = response.metadata._jupyter_types_experimental;\n        response.matches.forEach((label, index) => {\n            if (metadata && metadata[index]) {\n                items.push({\n                    label,\n                    type: metadata[index].type,\n                    insertText: metadata[index].text\n                });\n            }\n            else {\n                items.push({ label });\n            }\n        });\n        return {\n            start: response.cursor_start,\n            end: response.cursor_end,\n            items\n        };\n    }\n    /**\n     * Kernel provider will use the inspect request to lazy-load the content\n     * for document panel.\n     */\n    async resolve(item, context, patch) {\n        const { editor, session } = context;\n        if (session && editor) {\n            let code = editor.model.sharedModel.getSource();\n            const position = editor.getCursorPosition();\n            let offset = Text.jsIndexToCharIndex(editor.getOffsetAt(position), code);\n            const kernel = session.kernel;\n            if (!code || !kernel) {\n                return Promise.resolve(item);\n            }\n            if (patch) {\n                const { start, value } = patch;\n                code = code.substring(0, start) + value;\n                offset = offset + value.length;\n            }\n            const contents = {\n                code,\n                cursor_pos: offset,\n                detail_level: 0\n            };\n            const msg = await kernel.requestInspect(contents);\n            const value = msg.content;\n            if (value.status !== 'ok' || !value.found) {\n                return item;\n            }\n            item.documentation = value.data['text/plain'];\n            return item;\n        }\n        return item;\n    }\n    /**\n     * Kernel provider will activate the completer in continuous mode after\n     * the `.` character.\n     */\n    shouldShowContinuousHint(visible, changed, context) {\n        var _a, _b;\n        const mimeType = (_b = (_a = context === null || context === void 0 ? void 0 : context.editor) === null || _a === void 0 ? void 0 : _a.model.mimeType) !== null && _b !== void 0 ? _b : '';\n        if (!isHintableMimeType(mimeType)) {\n            return false;\n        }\n        const sourceChange = changed.sourceChange;\n        if (sourceChange == null) {\n            return true;\n        }\n        if (sourceChange.some(delta => delta.delete != null)) {\n            return false;\n        }\n        return sourceChange.some(delta => delta.insert != null &&\n            (delta.insert === '.' || (!visible && delta.insert.trim().length > 0)));\n    }\n}\n//# sourceMappingURL=kernelprovider.js.map"],"names":["HOVERBOX_CLASS","OUTOFVIEW_Z_INDEX","HoverBox","CompletionTriggerKind","InlineCompletionTriggerKind","CompletionHandler","StraemEvent","Private","setGeometry","options","anchor","host","node","privilege","outOfViewDisplay","hostRect","getBoundingClientRect","classList","contains","add","style","visibility","zIndex","maxHeight","marginTop","window","getComputedStyle","spaceAbove","top","spaceBelow","bottom","parseInt","marginLeft","minHeight","renderBelow","Math","min","size","width","height","contain","initialHeight","offsetAbove","offset","vertical","above","offsetBelow","below","floor","offsetHorizontal","horizontal","left","ceil","rect","right","innerWidth","includesLeftTop","document","elementFromPoint","includesRightTop","includesRightBottom","includesLeftBottom","topEdgeInside","bottomEdgeInside","leftEdgeInside","rightEdgeInside","overTheTop","belowTheBottom","beforeTheLeft","afterTheRight","hide","leftChanged","topChanged","constructor","this","_fetchingInline","_editor","_enabled","_isDisposed","_autoCompletion","_continuousInline","_tabCompleterActive","completer","inlineCompleter","selected","connect","onCompletionSelected","visibilityChanged","onVisibilityChanged","_reconciliator","reconciliator","editor","newValue","isDisposed","model","remove","COMPLETER_ENABLED_CLASS","COMPLETER_ACTIVE_CLASS","selections","changed","disconnect","onSelectionsChanged","sharedModel","_onSharedModelChanged","reset","autoCompletion","value","dispose","Signal","clearData","invokeInline","_makeInlineRequest","getCursorPosition","Invoke","catch","reason","console","warn","invoke","MessageLoop","sendMessage","Msg","InvokeRequest","processMessage","msg","type","onInvokeRequest","getState","position","text","getSource","line","column","val","patch","createPatch","start","end","cursorBeforeChange","getOffsetAt","transactions","changes","from","to","insert","selection","length","dispatch","original","_makeRequest","Invoked","_a","inlineModel","handleSelectionChange","getSelection","subsetMatch","getLine","slice","match","COMPLETER_LINE_BEGINNING_CLASS","handleCursorChange","onTextChanged","str","shouldShowContinuousHint","isVisible","TriggerCharacter","handleTextChange","Automatic","isHidden","focus","sourceChange","trigger","Promise","reject","Error","request","_composeRequest","state","fetch","then","reply","_updateModel","suppressIfInlineCompleterActive","isActive","setCompletionItems","items","p","isMiddleOfLine","cursor","current","promises","fetchInline","cancelled","completed","Set","promise","result","suppressIfTabCompleterActive","setCompletions","appendCompletions","e","finally","remaining","notifyProgress","pendingProviders","totalProviders","mimeType","Text","jsIndexToCharIndex","charIndexToJsIndex","escapeHTML","createElement","textContent","innerHTML","Message","CompleterModel","processedItemsCache","_current","_cursor","_completionItems","_original","_query","_subsetMatch","_typeMap","_orderedTypes","_stateChanged","_queryChanged","_processedToOriginalItem","_resolvingItem","stateChanged","queryChanged","JSONExt","deepEqual","_reset","emit","originalLine","split","currentLine","query","substring","ending","lastIndexOf","origin","completionItems","markedItems","_markup","map","it","processedItem","WeakMap","originalItem","item","_escapeItemLabel","findOrderedCompletionItemTypes","typeMap","orderedTypes","change","cursorDelta","inputDelta","last","hard","results","index","label","indexOf","StringExt","matchSumOfSquares","marked","highlight","indices","mark","highlightedItem","Object","assign","join","insertText","push","score","sort","scoreCmp","resolveItem","indexOrValue","get","_resolveItemByValue","completionItem","resolvedItem","resolve","activeItem","keys","forEach","key","error","inplace","escapedLabel","newItem","hadQuery","KNOWN_TYPES","KNOWN_MAP","reduce","acc","a","b","_b","_c","delta","localeCompare","newTypeSet","includes","has","newTypes","Array","concat","findOrderedTypes","filtered","filter","ITEM_CLASS","ACTIVE_CLASS","LIST_CLASS","USE_CAPTURE","Completer","Widget","_d","super","_activeIndex","_model","_selected","_visibilityChanged","_indexChanged","_lastSubsetMatch","_geometryLock","_geometryCounter","_docPanelExpanded","_renderCounter","sanitizer","Sanitizer","_defaultRenderer","getDefaultRenderer","_renderer","renderer","_docPanel","_createDocPanelNode","addClass","_updateConstraints","tempNode","overflowY","body","appendChild","computedStyle","_maxHeight","_minHeight","_scrollbarWidth","offsetWidth","clientWidth","removeChild","tempDocPanel","_docPanelWidth","measureSize","activeIndex","indexChanged","onModelStateChanged","onModelQueryChanged","showDocsPanel","showDoc","_showDoc","_sizeCache","handleEvent","event","_evtKeydown","_evtPointerdown","_evtScroll","display","scrollTop","selectActive","active","querySelector","getAttribute","onAfterAttach","addEventListener","onBeforeDetach","removeEventListener","isAttached","update","queryChange","newItems","oldItems","oldWidest","_findWidestItemIndex","newWidest","heuristic","_getPreferredItemWidthHeuristic","onUpdateRequest","_populateSubset","_createCompleterNode","querySelectorAll","innerText","_updateDocPanel","show","_setGeometry","sizeCache","docPanelWidth","max","docPanelHeight","docPanel","className","ul","first","createCompletionItemNode","renderedItems","firstItemSize","pageSize","toRenderImmediately","performance","now","i","li","widestItemIndex","widestItem","widestItemSize","cloneNode","timePerItem","chunkSize","alreadyRendered","previousChunkFinal","renderChunk","predictedMissingHeight","marginBottom","requestAnimationFrame","limit","widthHeuristic","widthHeuristics","itemWidthHeuristic","bind","_cycle","direction","container","page","sign","completionList","ElementExt","scrollIntoViewIfNeeded","visibleCompletionItems","activeCompletionItem","target","keyCode","preventDefault","stopPropagation","stopImmediatePropagation","populated","shiftKey","cycle","keyCodeMap","nonstandardClick","documentElement","parentElement","subset","commonSubset","getPositionAt","getCoordinateForPosition","borderLeft","borderLeftWidth","paddingLeft","closest","panel","activeNode","_toggleDocPanel","loadingIndicator","createLoadingDocsIndicator","call","documentation","createDocumentationNode","isHintableMimeType","Renderer","wrapperNode","_createWrapperNode","deprecated","_constructNode","_createLabelNode","icon","source","renderText","replace","loadingContainer","loadingBar","append","setAttribute","matchNode","typesExist","iconNode","element","typeNode","toLowerCase","colorIndex","toString","dummyNode","title","typeExtendedNode","toLocaleLowerCase","dummyTypeExtendedNode","values","len","strlen","ch","j","button","altKey","ctrlKey","metaKey","isConnected","removeAttribute","ProviderReconciliator","_resolveFactory","provider","el","_context","_fetching","_inlineFetching","_providers","providers","_inlineProviders","inlineProviders","_inlineProvidersSettings","inlineProvidersSettings","context","_timeout","timeout","applicableProviders","isApplicablePromises","isApplicable","all","_","idx","settings","identifier","autoFillInMiddle","delay","debouncerDelay","triggerKind","stream","_stream","timeoutPromise","setTimeout","race","isIncomplete","token","streamed","streaming","opened","updated","response","addition","lastStreamed","closed","combinedPromise","_mergeCompletions","completerIsVisible","_defaultShouldShowContinuousHint","_alignPrefixes","replies","minStart","maxStart","lineOffset","prefixStart","prefixEnd","prefix","startsWith","minEnd","starts","insertTextSet","mergedItems","trim","some","KernelCompleterProvider","rank","session","kernel","contents","code","cursor_pos","requestComplete","content","status","metadata","_jupyter_types_experimental","matches","cursor_start","cursor_end","detail_level","requestInspect","found","data","visible","delete"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7]}