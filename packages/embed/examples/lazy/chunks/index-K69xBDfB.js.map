{"version":3,"file":"index-K69xBDfB.js","sources":["../../../react/lib/jupyter/lite/pyodide-kernel-extension/index.js","../../../react/style/icons/pyodide/pyodide.svg"],"sourcesContent":["/*\n * Copyright (c) 2021-2023 Datalayer, Inc.\n *\n * MIT License\n */\n// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\nimport { PageConfig, URLExt } from '@jupyterlab/coreutils';\nimport { IServiceWorkerManager, } from '../server';\nimport { IKernelSpecs } from '../kernel';\nimport { IBroadcastChannelWrapper } from '../contents';\n// @ts-expect-error - JSON import is not typed\nexport * as KERNEL_SETTINGS_SCHEMA from '../../../../schema/kernel.v0.schema.json';\nimport KERNEL_ICON_SVG_STR from '../../../../style/icons/pyodide/pyodide.svg';\nconst KERNEL_ICON_URL = `data:image/svg+xml;base64,${btoa(KERNEL_ICON_SVG_STR)}`;\n/**\n * The default CDN fallback for Pyodide\n */\nconst PYODIDE_CDN_URL = 'https://cdn.jsdelivr.net/pyodide/v0.27.1/full/pyodide.js';\n/**\n * The id for the extension, and key in the litePlugins.\n */\nconst PLUGIN_ID = '@datalayer/jupyter-react/pyodide-kernel-extension:kernel';\n/**\n * A plugin to register the Pyodide kernel.\n */\nconst kernel = {\n    id: PLUGIN_ID,\n    autoStart: true,\n    requires: [IKernelSpecs],\n    optional: [IServiceWorkerManager, IBroadcastChannelWrapper],\n    activate: (app, kernelspecs, serviceWorker, broadcastChannel) => {\n        const contentsManager = app.serviceManager.contents;\n        const config = JSON.parse(PageConfig.getOption('litePluginSettings') || '{}')[PLUGIN_ID] || {};\n        const baseUrl = PageConfig.getBaseUrl();\n        const url = config.pyodideUrl || PYODIDE_CDN_URL;\n        const pyodideUrl = URLExt.parse(url).href;\n        const pipliteWheelUrl = config.pipliteWheelUrl\n            ? URLExt.parse(config.pipliteWheelUrl).href\n            : undefined;\n        const rawPipUrls = config.pipliteUrls || [];\n        const pipliteUrls = rawPipUrls.map((pipUrl) => URLExt.parse(pipUrl).href);\n        const disablePyPIFallback = !!config.disablePyPIFallback;\n        const loadPyodideOptions = config.loadPyodideOptions || {};\n        for (const [key, value] of Object.entries(loadPyodideOptions)) {\n            if (key.endsWith('URL') && typeof value === 'string') {\n                loadPyodideOptions[key] = new URL(value, baseUrl).href;\n            }\n        }\n        kernelspecs.register({\n            spec: {\n                name: 'python',\n                display_name: 'Python (Pyodide)',\n                language: 'python',\n                argv: [],\n                resources: {\n                    'logo-32x32': KERNEL_ICON_URL,\n                    'logo-64x64': KERNEL_ICON_URL,\n                },\n            },\n            create: async (options) => {\n                const { PyodideKernel } = await import('../pyodide-kernel/index');\n                /*\n                TODO Restore this...\n                const mountDrive = !!(\n                  (serviceWorker?.enabled && broadcastChannel?.enabled) ||\n                  crossOriginIsolated\n                );\n                */\n                const mountDrive = false;\n                if (mountDrive) {\n                    console.info('Pyodide contents will be synced with Jupyter Contents');\n                }\n                else {\n                    console.warn('Pyodide contents will NOT be synced with Jupyter Contents');\n                }\n                return new PyodideKernel({\n                    ...options,\n                    pyodideUrl,\n                    pipliteWheelUrl,\n                    pipliteUrls,\n                    disablePyPIFallback,\n                    mountDrive,\n                    loadPyodideOptions,\n                    contentsManager,\n                });\n            },\n        });\n    },\n};\nconst plugins = [kernel];\nexport default plugins;\n//# sourceMappingURL=index.js.map","export default \"data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20width='182'%20height='182'%20data-name='Layer%201'%20version='1.1'%20viewBox='0%200%20182%20182'%20xmlns='http://www.w3.org/2000/svg'%3e%3cdefs%3e%3cstyle%3e.cls-1%20{%20fill:%20%23fff;%20}%20.cls-2%20{%20fill:%20%23654ff0;%20}%3c/style%3e%3c/defs%3e%3crect%20width='182'%20height='182'%20fill='%23fff'%20stop-color='%23000000'%20style='paint-order:stroke%20fill%20markers'/%3e%3crect%20class='cls-1'%20x='107'%20y='125'%20width='50'%20height='32'/%3e%3cpath%20class='cls-2'%20d='m135.18%2097c0-0.13-0.01-7.24-0.02-7.37h27.51v71.33h-71.34v-71.33h27.51c0%200.13-0.02%207.24-0.02%207.37m32.59%2056.33h4.9l-7.43-25.25h-7.45l-6.12%2025.25h4.75l1.24-5.62h8.49l1.61%205.62zm-26.03%200h4.69l6.02-25.25h-4.63l-3.69%2017.4h-0.06l-3.5-17.4h-4.42l-3.9%2017.19h-0.06l-3.23-17.19h-4.72l5.44%2025.25h4.78l3.75-17.19h0.06zm18.89-19.03h1.99l2.37%209.27h-6.42z'/%3e%3cpath%20d='m89%2049.66c0%2010.6-8.8%2020-20%2020h-40v20h-10v-70h50c10.7%200%2019.7%208.9%2020%2020zm-10-10c0-5.5-4.5-10-10-10h-40v30h40c5.5%200%2010-4.5%2010-10z'/%3e%3cpath%20d='m132%2067.66v22h-10v-22l-30-33v-15h10v10.9l25%2027.5%2025-27.5v-10.9h10v15z'/%3e%3c/svg%3e\""],"names":["KERNEL_ICON_URL","btoa","PLUGIN_ID","plugins","id","autoStart","requires","IKernelSpecs","optional","IServiceWorkerManager","IBroadcastChannelWrapper","activate","app","kernelspecs","serviceWorker","broadcastChannel","contentsManager","serviceManager","contents","config","JSON","parse","PageConfig","getOption","baseUrl","getBaseUrl","url","pyodideUrl","URLExt","href","pipliteWheelUrl","pipliteUrls","map","pipUrl","disablePyPIFallback","loadPyodideOptions","key","value","Object","entries","endsWith","URL","register","spec","name","display_name","language","argv","resources","create","async","options","PyodideKernel","import","console","warn","mountDrive"],"mappings":"s6CAcMA,EAAkB,6BAA6BC,KCdtC,+qCDsBTC,EAAY,2DAoEZC,EAAU,CAhED,CACXC,GAAIF,EACJG,WAAW,EACXC,SAAU,CAACC,GACXC,SAAU,CAACC,EAAuBC,GAClCC,SAAU,CAACC,EAAKC,EAAaC,EAAeC,KACxC,MAAMC,EAAkBJ,EAAIK,eAAeC,SACrCC,EAASC,KAAKC,MAAMC,aAAWC,UAAU,uBAAyB,MAAMrB,IAAc,CAAA,EACtFsB,EAAUF,EAAAA,WAAWG,aACrBC,EAAMP,EAAOQ,YAjBH,2DAkBVA,EAAaC,EAAAA,OAAOP,MAAMK,GAAKG,KAC/BC,EAAkBX,EAAOW,gBACzBF,EAAAA,OAAOP,MAAMF,EAAOW,iBAAiBD,UACrC,EAEAE,GADaZ,EAAOY,aAAe,IACVC,IAAKC,GAAWL,EAAAA,OAAOP,MAAMY,GAAQJ,MAC9DK,IAAwBf,EAAOe,oBAC/BC,EAAqBhB,EAAOgB,oBAAsB,CAAA,EACxD,IAAA,MAAYC,EAAKC,KAAUC,OAAOC,QAAQJ,GAClCC,EAAII,SAAS,QAA2B,iBAAVH,IAC9BF,EAAmBC,GAAO,IAAIK,IAAIJ,EAAOb,GAASK,MAG1DhB,EAAY6B,SAAS,CACjBC,KAAM,CACFC,KAAM,SACNC,aAAc,mBACdC,SAAU,SACVC,KAAM,GACNC,UAAW,CACP,aAAchD,EACd,aAAcA,IAGtBiD,OAAQC,MAAOC,IACX,MAAMC,cAAEA,SAAwBC,OAAO,uBAevC,OAFIC,QAAQC,KAAK,6DAEV,IAAIH,EAAc,IAClBD,EACHxB,aACAG,kBACAC,cACAG,sBACAsB,YAbe,EAcfrB,qBACAnB"}