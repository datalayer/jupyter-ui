import{O as e,o as t,s,p as i,W as r,P as o}from"./JupyterReactTheme-CX3WbnDJ.js";import{D as n,a,J as l,$ as d,M as u,W as c,b as g,c as m,E as h,d as p,e as _,f as w,s as y,g as f,r as C,S as v,h as j,i as W}from"./index-V6IoXEpD.js";import{R as M}from"./Lumino-D6-gHQxh.js";const b="1.0.0";let O=class extends n{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:"OutputModel",_view_name:"OutputView",_model_module:"@jupyter-widgets/output",_view_module:"@jupyter-widgets/output",_model_module_version:b,_view_module_version:b})}},x=class extends a{};const E=/* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({__proto__:null,OutputModel:class extends O{defaults(){return Object.assign(Object.assign({},super.defaults()),{msg_id:"",outputs:[]})}initialize(t,s){super.initialize(t,s),this._outputs=new e({trusted:!0}),this.listenTo(this,"change:outputs",this.setOutputs),this.setOutputs()}get outputs(){return this._outputs}clear_output(e=!1){this._outputs.clear(e)}setOutputs(e,t,s){s&&s.newMessage||(this.clear_output(),this._outputs.fromJSON(JSON.parse(JSON.stringify(this.get("outputs")))))}},OutputView:class extends x{_createElement(e){return this.luminoWidget=new l({view:this}),this.luminoWidget.node}_setElement(e){if(this.el||e!==this.luminoWidget.node)throw new Error("Cannot reset the DOM element.");this.el=this.luminoWidget.node,this.$el=d(this.luminoWidget.node)}render(){super.render(),this._outputView=new t({rendermime:this.model.widget_manager.renderMime,model:this.model.outputs}),this.luminoWidget.insertWidget(0,this._outputView),this.luminoWidget.addClass("jupyter-widgets"),this.luminoWidget.addClass("widget-output"),this.update()}remove(){return this._outputView.dispose(),super.remove()}}},Symbol.toStringTag,{value:"Module"}));class R extends u{_viewList;constructor(e){super(),this.loader=e?.loader,this.renderMime=new M({initialFactories:s}),this.renderMime.addFactory({safe:!1,mimeTypes:[g],createRenderer:e=>new c(e,this)},0),this._viewList=/* @__PURE__ */new Set,window.addEventListener("resize",()=>{this._viewList.forEach(e=>{i.postMessage(e.luminoWidget,r.ResizeMessage.UnknownSize)})})}async display_view(e,t){let s;try{s=await e}catch(i){const t=`Could not create a view for ${e}`;console.error(t);const r=new(m(i,t));s=new h({model:r}),s.render()}r.attach(s.luminoWidget,t),this._viewList.add(s),s.once("remove",()=>{this._viewList.delete(s)})}filterExistingModelState(e){return super.filterExistingModelState(e)}_get_comm_info(){return Promise.resolve({})}_create_comm(e,t,s,i,r){return Promise.resolve({on_close:()=>{},on_msg:()=>{},close:()=>{}})}loadClass(e,t,s){return new Promise((e,i)=>{"@jupyter-widgets/base"===t?e(p):"@jupyter-widgets/controls"===t?e(_):"@jupyter-widgets/output"===t?e(E):void 0!==this.loader?e(this.loader(t,s)):i(`Could not load module ${t}@${s}`)}).then(i=>i[e]?i[e]:Promise.reject(`Class ${e} not found in module ${t}@${s}`))}renderMime;loader}class S extends R{_kernelConnection;_commRegistration;_onError;_registry;_ready=new o;constructor(e){super(e),this.comm_target_name="jupyter.widget";const t=()=>{console.warn("ClassicWidgetManager: Initializing widget manager"),window.define("@jupyter-widgets/base",p),window.define("@jupyter-widgets/controls",_),this._registry=new v,this.register=this.register.bind(this),this.registerWithKernel=this.registerWithKernel.bind(this),this._getRegistry=this._getRegistry.bind(this),this._handleCommOpen=this._handleCommOpen.bind(this),this.register({name:"@jupyter-widgets/base",version:j,exports:()=>import("./index-V6IoXEpD.js").then(e=>e.d)}),this.register({name:"@jupyter-widgets/controls",version:W,exports:()=>import("./index-V6IoXEpD.js").then(e=>e.e)}),console.warn("ClassicWidgetManager: Widget manager initialized, resolving ready promise"),this._ready.resolve(!0)};if(window.require&&window.define)console.warn("ClassicWidgetManager: RequireJS already available, initializing immediately"),t();else{console.warn("ClassicWidgetManager: Loading RequireJS");const e=document.createElement("script"),s=document.createElement("script");s.setAttribute("data-jupyter-widgets-cdn-only","true"),document.body.appendChild(s),e.src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js",document.body.appendChild(e),e.onload=()=>{console.warn("ClassicWidgetManager: RequireJS loaded, initializing"),t()},e.onerror=e=>{console.error("ClassicWidgetManager: Failed to load RequireJS",e),t()}}}get ready(){return this._ready}async _loadFromNotebook(e){const t=e.getMetadata("widgets");if(t&&t[w]){let e=t[w];e=this.filterExistingModelState(e),await this.set_state(e)}}registerWithKernel(e){if(this._kernelConnection=e,this.kernel=e,this._commRegistration&&this._commRegistration.dispose(),e){if(!this._registry)return void console.error("ClassicWidgetManager: Registry not initialized when registering with kernel.");console.log(`ClassicWidgetManager: Registering comm target with kernel for ${this.comm_target_name}`),this._commRegistration=e.registerCommTarget(this.comm_target_name,this._handleCommOpen),console.log("ClassicWidgetManager: Successfully registered comm target.")}else this.kernel=null}async _handleCommOpen(e,t){try{console.log("ClassicWidgetManager: Handling comm open for",t.content.target_name,"with comm_id",t.content.comm_id);const s=new y.services.Comm(e);console.log("ClassicWidgetManager: Created classic comm wrapper"),await this.handle_comm_open(s,t),console.log("ClassicWidgetManager: Successfully handled comm open")}catch(s){throw console.error("ClassicWidgetManager: Error in _handleCommOpen:",s),s}}_getRegistry(){return this._registry}get onError(){return this._onError}display_view(e,t){return Promise.resolve(e).then(e=>{r.attach(e.luminoWidget,t),e.on("remove",()=>{console.log("The IPyWidgets view is removed",e)})})}async loadClass(e,t,s){"@jupyter-widgets/base"!==t&&"@jupyter-widgets/controls"!==t||!f.valid(s)||(s=`^${s}`);let i=this._getRegistry().getAllVersions(t);const r=2===s.split(".").length?s+".0":s;if(!i){const e=await C(t,r),s={name:t,version:r.replaceAll("^",""),exports:{...e}};if(this.register(s),i=this._getRegistry().getAllVersions(t),!i)throw new Error(`No version of module ${t} is registered`)}const o=this._getRegistry().get(t,r);if(!o){const e=Object.keys(i);throw new Error(`Module ${t}, version ${r} is not registered, however,         ${e.join(",")} ${e.length>1?"are":"is"}`)}let n;n="function"==typeof o?await o():await o;const a=n[e];if(!a)throw new Error(`Class ${e} not found in module ${t}`);return a}callbacks(e){const t=super.callbacks(e);return Object.assign({},t,{iopub:{output:e=>this._onError.emit(e)}})}_create_comm(e,t,s,i,r){const o=this._kernelConnection?.createComm(e,t);return(s||i)&&o?.open(s,i),Promise.resolve(new y.services.Comm(o))}_get_comm_info(){return this._kernelConnection.requestCommInfo({target_name:this.comm_target_name}).then(e=>e.content.comms)}register(e){this._getRegistry().set(e.name,e.version,e.exports)}}async function $(e,t,s,i,r,o=!1,n){let a=!0;r&&Array.isArray(r.tags)&&-1!==r.tags.indexOf("raises-exception")&&(a=!1);const l=i.execute(t,{model:s.model,stopOnError:a,suppressCodeExecutionErrors:o,onExecutionPhaseChanged:n}).future;return s._onIOPub=l.onIOPub,s._onExecuteReply=l.onReply,s.future=l,l?.done}export{S as C,$ as e};
//# sourceMappingURL=OutputExecutor-acninrYJ.js.map
