import ModalImage from "react-modal-image";

# ðŸš§ VS Code

<ModalImage
  small="https://jupyter-examples.datalayer.tech/jupyter-react-vscode.png"
  large="https://jupyter-examples.datalayer.tech/jupyter-react-vscode.png"
  alt="Jupyter UI VSCode"
/>

## Working Features

- Loading a notebook
- Display a notebook
- Connect to a Jupyter Server by providing its URL with auth token; transfer http request and websocket messages
- Running code

## Not Implemented

- Saving the document
- Notifying of updates to have a UI feedback the document is in dirty state
- ipywidgets support

## Known Limitations

- Styling:
  - No connection between dark/light vs code theme and notebook theme
  - No resizing with the panel
  - Button to select the runtime is not displayed in a toolbar that stays visible
- Websocket binary support: for now we forbid the usage of the newer protocol v1.kernel.websocket.jupyter.org. When using it, the message data are failing to be serialized to be transferred from the webview to the extension. And when receiving it, the deserialization fails. The deserialization error may be related to an incorrect binaryType that is not handle in the current code; but in JupyterLab it is forced to 'arraybuffer' for kernel websocket.

## Architecture

The editor is displayed in a webview - aka a iframe. That iframe has Content Security Policies that have been fully relaxed for styling :disappointed: but not for scripts. Not allowing any script will likely induce issue especially with advanced output renderer like plotly or ipywidgets. That policy may be relaxed (but this is going against VS Code recommendation).

The webview being in a separate world, connecting to the server is done through the extension. This requires to proxy http-request and websocket messages to and from the webviews. This is tricky as it requires serialization handled by vscode. And despite using a so called `postMessage` method, the behavior is not matching the Web API `postMessage` especially when transferring complex objects.

The interface point is inspired by JupyterLite approach; aka we define a custom `fetch` method and `WebSocket` class in the server settings used by the service manager.
